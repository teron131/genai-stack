{
    "items": [
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 16342673,
                        "reputation": 117,
                        "user_id": 11803228,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/d09735ea42185e8b0712bf96aa36ada9?s=256&d=identicon&r=PG",
                        "display_name": "FlagT",
                        "link": "https://stackoverflow.com/users/11803228/flagt"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1702190081,
                    "answer_id": 77633889,
                    "question_id": 77633753,
                    "body_markdown": "In the topmost MATCH statement, I didn&#39;t define a name for the Relationships, such as r1, so the returned data did not include these relationships. Oddly enough, the browser managed to return data using the unnamed Cypher, which might involve some behind-the-scenes processing. By modifying the Cypher query, I have resolved this issue.",
                    "title": "The same Cypher query yields inconsistent results between the SDK and the browser, with several Relationships missing"
                }
            ],
            "owner": {
                "account_id": 16342673,
                "reputation": 117,
                "user_id": 11803228,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/d09735ea42185e8b0712bf96aa36ada9?s=256&d=identicon&r=PG",
                "display_name": "FlagT",
                "link": "https://stackoverflow.com/users/11803228/flagt"
            },
            "is_answered": false,
            "view_count": 21,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1702185335,
            "question_id": 77633753,
            "body_markdown": "I suspect that I have encountered a bug. When querying with the Go SDK, the data results obtained are inconsistent with those in the Neo4j browser, with several Relationships missing.\r\n\r\n  Neo4j Version: Neo4j Kernel 5.12.0 community\r\n\r\n  Neo4j Mode: Single instance\r\n\r\n  Driver version: Go driver v5.12.0\r\n\r\n  Operating System: centos\r\n\r\nMy Cypher is\r\n\r\n```\r\nMATCH (n1:AAA_IngressOfSecurityGroup {AssetsAccountId:&quot;aaaa&quot;})-[:IngressOfSecurityGroup]-&gt;(n2:AAA_SecurityGroup {AssetsAccountId:&quot;aaaa&quot;})-[:SecurityGroupOfNetworkInterface]-&gt;(n3:AAA_NetworkInterface {AssetsAccountId:&quot;aaaa&quot;})-[:NetworkInterfaceOfCvm]-&gt;(n4:AAA_CvmInstance {AssetsAccountId:&quot;aaaa&quot;,AssetUniqueId:&quot;aaaa-165d2740e7fa&quot;,AssetsVersion:&quot;1702108924&quot;}) WHERE n4.InstanceState = &#39;RUNNING&#39; AND n4.RestrictState = &#39;NORMAL&#39; AND n1.Action = &#39;ACCEPT&#39; AND (n1.Ipv6CidrBlock = &quot;::/0&quot; OR n1.CidrBlock = &quot;0.0.0.0/0&quot;) AND toLower(n1.Port) = &#39;all&#39; AND (toLower(n1.Protocol) = &#39;tcp&#39; or toLower(n1.Protocol) = &#39;udp&#39; or toLower(n1.Protocol)= &#39;all&#39; )   WITH n1, n2, n3, n4 WHERE ALL (groupId IN n3.GroupSet WHERE   NOT EXISTS {     MATCH (n2_other:AAA_SecurityGroup {AssetsAccountId:&quot;aaaa&quot;, SecurityGroupId: groupId})-[:IngressOfSecurityGroup]-&gt;(n1_other:AAA_IngressOfSecurityGroup)     WHERE n1_other.Action = &#39;DROP&#39; AND ((n1_other.CidrBlock = &quot;0.0.0.0/0&quot; OR n1_other.Ipv6CidrBlock = &quot;::/0&quot;) AND toLower(n1_other.Port) = &#39;all&#39;) AND NOT EXISTS {       MATCH (n1_smaller:AAA_IngressOfSecurityGroup)-[:IngressOfSecurityGroup]-&gt;(n2_other)       WHERE toInteger(n1_smaller.PolicyIndex) &lt; toInteger(n1_other.PolicyIndex)     }   } )  OPTIONAL MATCH p2 = (n7:AAA_PublicIp {AssetsAccountId:&quot;aaaa&quot;})-[:PublicIpToVpc]-&gt;(n6:AAA_Vpc {AssetsAccountId:&quot;aaaa&quot;})-[:SubnetsInVPC]-&gt;(n5:AAA_Subnet {AssetsAccountId:&quot;aaaa&quot;})-[:NetworkInterfaceInSubnet]-&gt;(n3) WHERE p2 IS NOT NULL  OPTIONAL MATCH p3 = (n8:AAA_Eip {AssetsAccountId:&quot;aaaa&quot;})-[:EipOToVpc]-&gt;(n6)-[:SubnetsInVPC]-&gt;(n5)-[:NetworkInterfaceInSubnet]-&gt;(n3) WHERE p3 IS NOT NULL      WITH DISTINCT n4, n1, n2, n3, n6, n7, p2, p3  RETURN n1, n2, n3,n4, n6, n7, p2, p3\r\n```\r\n\r\nThe code I use to process the data returned from Neo4j is as follows.\r\n\r\n```\r\nresult, session, err := global.Neo4j.RunCypherQuery(body.Cypher, nil)\r\n\tif err != nil {\r\n\t\tlogger.Log.Error(&quot;RunCypherQuery error: &quot; + err.Error())\r\n\t\tresponse := responses.NewErrorResponse(responses.StatusCodeUnknownErr, err.Error())\r\n\t\tc.JSON(http.StatusOK, response)\r\n\t\treturn\r\n\t}\r\n\r\n\tvar nodes []neo4j.Node\r\n\tvar relationships []neo4j.Relationship\r\n\r\n\tseenNodes := make(map[int64]bool)\r\n\tseenRelationships := make(map[int64]bool)\r\n\tfor result.Next() {\r\n\t\trecord := result.Record()\r\n\t\tfor _, value := range record.Values {\r\n\t\t\tif value == nil {\r\n\t\t\t\tcontinue\r\n\t\t\t}\r\n\t\t\tswitch v := value.(type) {\r\n\t\t\tcase neo4j.Node:\r\n\t\t\t\tif _, found := seenNodes[v.Id]; !found {\r\n\t\t\t\t\tseenNodes[v.GetId()] = true\r\n\t\t\t\t\tnodes = append(nodes, v)\r\n\t\t\t\t}\r\n\t\t\tcase neo4j.Relationship:\r\n\t\t\t\tif _, found := seenRelationships[v.Id]; !found {\r\n\t\t\t\t\tseenRelationships[v.GetId()] = true\r\n\t\t\t\t\trelationships = append(relationships, v)\r\n\t\t\t\t}\r\n\t\t\tcase neo4j.Path:\r\n\t\t\t\tfor _, node := range v.Nodes {\r\n\t\t\t\t\tif _, found := seenNodes[node.Id]; !found {\r\n\t\t\t\t\t\tseenNodes[node.GetId()] = true\r\n\t\t\t\t\t\tnodes = append(nodes, node)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tfor _, rel := range v.Relationships {\r\n\t\t\t\t\tif _, found := seenRelationships[rel.Id]; !found {\r\n\t\t\t\t\t\tseenRelationships[rel.GetId()] = true\r\n\t\t\t\t\t\trelationships = append(relationships, rel)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\tcase []interface{}:\r\n\t\t\t\tfor _, item := range v {\r\n\t\t\t\t\tswitch elem := item.(type) {\r\n\t\t\t\t\tcase neo4j.Node:\r\n\t\t\t\t\t\tif _, found := seenNodes[elem.GetId()]; !found {\r\n\t\t\t\t\t\t\tseenNodes[elem.GetId()] = true\r\n\t\t\t\t\t\t\tnodes = append(nodes, elem)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tcase neo4j.Relationship:\r\n\t\t\t\t\t\tif _, found := seenRelationships[elem.GetId()]; !found {\r\n\t\t\t\t\t\t\tseenRelationships[elem.GetId()] = true\r\n\t\t\t\t\t\t\trelationships = append(relationships, elem)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tlogger.Log.Error(&quot;Unexpected type in []interface{}: %T&quot;, item)\r\n\t\t\t\t\t\tresponse := responses.NewErrorResponse(responses.StatusCodeUnknownErr, errors.New(fmt.Sprintf(&quot;Unexpected type in []interface{}: %T&quot;, item)).Error())\r\n\t\t\t\t\t\tc.JSON(http.StatusOK, response)\r\n\t\t\t\t\t\treturn\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\tdefault:\r\n\t\t\t\tlogger.Log.Error(&quot;Unexpected type: %T&quot;, v)\r\n\t\t\t\tresponse := responses.NewErrorResponse(responses.StatusCodeUnknownErr, errors.New(fmt.Sprintf(&quot;Unexpected type: %T&quot;, v)).Error())\r\n\t\t\t\tc.JSON(http.StatusOK, response)\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n```\r\n\r\n```\r\nfunc (c *Client) RunCypherQuery(query string, params map[string]interface{}) (neo4j.Result, neo4j.Session, error) {\r\n\tsession := c.driver.NewSession(neo4j.SessionConfig{})\r\n\tfmt.Println(query)\r\n\tresult, err := session.Run(query, params)\r\n\tif err != nil {\r\n\t\treturn nil, session, err\r\n\t}\r\n\treturn result, session, nil\r\n}\r\n```\r\n\r\nin neo4j desktop search result is\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\nin my code search result is\r\n\r\n[![enter image description here][2]][2]\r\n\r\nThe position marked with a red &quot;X&quot; indicates that no results were found.\r\n\r\nIn the RunCypherQuery method, the data for these three Relationships were not found in the returned result.\r\n\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/LBl50.png\r\n  [2]: https://i.stack.imgur.com/rAFEJ.png",
            "link": "https://stackoverflow.com/questions/77633753/the-same-cypher-query-yields-inconsistent-results-between-the-sdk-and-the-browse",
            "title": "The same Cypher query yields inconsistent results between the SDK and the browser, with several Relationships missing"
        },
        {
            "tags": [
                "neo4j",
                "neo4j-browser"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1575719,
                        "reputation": 19504,
                        "user_id": 2662355,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/6ea0a9d988f145b0e666dfdd96374736?s=256&d=identicon&r=PG",
                        "display_name": "Christophe Willemsen",
                        "link": "https://stackoverflow.com/users/2662355/christophe-willemsen"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1702120797,
                    "answer_id": 77631068,
                    "question_id": 77630912,
                    "body_markdown": "In the neo4j browser, the `connect result nodes` option is enabled by default. \r\n\r\n[![enter image description here][1]][1]\r\n\r\nWhen you return nodes from queries, the browser will make in the background an additional query for finding relationships between the nodes and automatically display them.\r\n\r\nFor example, if I would return only two nodes with Cypher\r\n\r\n```\r\nMATCH (n:Person {name: &quot;Christophe&quot;})\r\nMATCH (s:Song {title: &quot;Numb&quot;})\r\nRETURN n, s\r\n```\r\n\r\nIt will find there is an existing relationship between them in the background and will fetch it from the database and display it\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/f1cL7.png\r\n  [2]: https://i.stack.imgur.com/TcVZr.png",
                    "title": "Neo4j Web Browser : Display phantom data (data does not exists on server)"
                }
            ],
            "owner": {
                "account_id": 30104260,
                "reputation": 1,
                "user_id": 23070531,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/276537b5cf8e3551b79763bb76d1b391?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Nizar",
                "link": "https://stackoverflow.com/users/23070531/nizar"
            },
            "is_answered": false,
            "view_count": 22,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1702117013,
            "question_id": 77630912,
            "body_markdown": "We observe unexplainable behaviour with Neo4j Web Browser.\r\n\r\n- Cypher query return only 3 relationships but the web browser display 5.\r\n\r\n- As you can see, on the right side we have this text : Displaying 4 Nodes, 3 rel\r\n  But the graph shows 5 rel.\r\n\r\n- The table Tab in the Web Browser shows 3 records and the cypher results return 3 rel\r\n\r\n- We observe this behaviors with other queries, it&#39;s not only for the query shared here.\r\n\r\n- When we refresh the Neo4j WebBrowser (reload/refresh the chrome browser tab), sometimes we have the display with the right data, sometimes not\r\n\r\n[a snapshot to help to inderstand](https://i.stack.imgur.com/qVgc9.png)\r\n\r\nPS : we run 5.14.0 community version and Neo4j Web Browser 5.12.0\r\n\r\nRegards,\r\nNizar",
            "link": "https://stackoverflow.com/questions/77630912/neo4j-web-browser-display-phantom-data-data-does-not-exists-on-server",
            "title": "Neo4j Web Browser : Display phantom data (data does not exists on server)"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "graph-databases",
                "graph-data-science"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 5007043,
                        "reputation": 672,
                        "user_id": 4024409,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/-4JS5nVp4cYs/AAAAAAAAAAI/AAAAAAAAAAA/9dswBlPXPdw/photo.jpg?sz=256",
                        "display_name": "Vincent Rupp",
                        "link": "https://stackoverflow.com/users/4024409/vincent-rupp"
                    },
                    "is_accepted": true,
                    "score": 2,
                    "creation_date": 1701970942,
                    "answer_id": 77622086,
                    "question_id": 77621751,
                    "body_markdown": "The frequency of graph changes will determine if you should batch or not.\r\n\r\nTo your main question, FastRP depends on a node and its neighbors, the neighbors of those, the neighbors of those, etc.\r\n\r\nThere&#39;s a configuration parameter IterationWeights which does two things:\r\n1. Determines the number of neighbor-neighbor-neighbors to look at.\r\n2. Determines how relevant each degree of separation is.\r\n\r\nIf you set IterationWeights to [1.0], FastRP will only look at immediate neighbors.\r\n\r\nIf you use [0.0, 1.0] then first and second-degree neighbors will be used, weighted equally.\r\n\r\nTo update your embeddings when changes occur, let&#39;s say you&#39;re using second-degree neighbors and your node A changes. Create a projection with just A, its neighbors and neighbor-neighbors, and run FastRP in write mode.\r\n\r\nSame idea for batch updates, just select the nodes that have changed and everything up to 2 hops out from those.",
                    "title": "Updating Neo4j Embeddings on Graph Change"
                }
            ],
            "owner": {
                "account_id": 27718658,
                "reputation": 25,
                "user_id": 21159756,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AEdFTp7ViXMCr1RVFcrYuGXAB5pQU9wN_yd6j-8qcuOQ=k-s256",
                "display_name": "Chetra Abeid",
                "link": "https://stackoverflow.com/users/21159756/chetra-abeid"
            },
            "is_answered": true,
            "view_count": 39,
            "favorite_count": 0,
            "accepted_answer_id": 77622086,
            "answer_count": 1,
            "score": 2,
            "creation_date": 1701967766,
            "question_id": 77621751,
            "body_markdown": "I am using the Neo4j Graph Data Science (GDS) library with Fast Random Projection (FastRP) for graph embeddings. I&#39;m facing challenges in updating these embeddings efficiently in response to frequent graph changes (additions/removals of nodes and edges). I&#39;m particularly interested in understanding the best practices for updating these embeddings - should I opt for incremental updates after each change, or batch processing at regular intervals?\r\n\r\nAdditionally, I&#39;m curious if it&#39;s feasible to update embeddings for only the affected sub-graph while maintaining the integrity and consistency of embeddings as if they were done on the global graph projection.",
            "link": "https://stackoverflow.com/questions/77621751/updating-neo4j-embeddings-on-graph-change",
            "title": "Updating Neo4j Embeddings on Graph Change"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701883396,
                    "answer_id": 77615121,
                    "question_id": 77614613,
                    "body_markdown": "Assuming `id` and `type` are properties, this works:\r\n```sql\r\nMATCH (n0 {id: &quot;A&quot;})--(n1 {type:2})--(n2)\r\nWHERE n2.id IN [&quot;D&quot;, &quot;E&quot;]\r\nWITH collect(DISTINCT [n0, n1]) AS r1, collect(DISTINCT [n1, n2]) AS r2\r\nWITH \r\n    COLLECT {\r\n        WITH r1\r\n        UNWIND r1 AS r\r\n        WITH r[0].id AS lhs, &#39;type&#39; + r[1].type AS rhs, count(*) AS num\r\n        RETURN {lhs: lhs, rhs: rhs, num: num }\r\n    } AS first, \r\n    COLLECT {\r\n        WITH r2\r\n        UNWIND r2 AS r\r\n        WITH &#39;type&#39; + r[0].type AS lhs, r[1].id AS rhs, count(*) AS num\r\n        RETURN {lhs: lhs, rhs: rhs, num: num }\r\n    } AS second\r\nUNWIND first + second AS cn\r\nRETURN \r\n    cn.lhs + &#39; to &#39; + cn.rhs + &#39;: &#39; + cn.num + \r\n    CASE \r\n      WHEN cn.num = 1 THEN &#39; connection&#39; \r\n      ELSE &#39; connections&#39; \r\n    END AS result\r\n```\r\nIt&#39;s not pretty ...",
                    "title": "Count distinct node pairings in a multihop match"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701900782,
                    "answer_id": 77616605,
                    "question_id": 77614613,
                    "body_markdown": "This query might suffice (it repeats the same `A_to_type2` count in each result row):\r\n\r\n    MATCH ({id: &quot;A&quot;})-[r1]-({type:2})-[r2]-(n2)\r\n    WHERE n2.id IN [&quot;D&quot;, &quot;E&quot;]\r\n    WITH COUNT(DISTINCT r1) AS A_to_type2, COLLECT({n2Id: n2.id, r2: r2}) AS data\r\n    UNWIND data AS d\r\n    RETURN A_to_type2, d.n2Id AS n2Id, COUNT(DISTINCT d.r2) AS type2_to_n2Id\r\n\r\nOutput for your sample data:\r\n\r\n    ╒══════════╤════╤═════════════╕\r\n    │A_to_type2│n2Id│type2_to_n2Id│\r\n    ╞══════════╪════╪═════════════╡\r\n    │2         │&quot;D&quot; │2            │\r\n    ├──────────┼────┼─────────────┤\r\n    │2         │&quot;E&quot; │1            │\r\n    └──────────┴────┴─────────────┘\r\n\r\nOr, to return a single row with a collection of the type2_to_n2Id counts:\r\n\r\n    MATCH ({id: &quot;A&quot;})-[r1]-({type:2})-[r2]-(n2)\r\n    WHERE n2.id IN [&quot;D&quot;, &quot;E&quot;]\r\n    WITH COUNT(DISTINCT r1) AS A_to_type2, COLLECT({n2Id: n2.id, r2: r2}) AS data\r\n    UNWIND data AS d\r\n    WITH A_to_type2, d.n2Id AS n2Id, COUNT(DISTINCT d.r2) AS cnt\r\n    RETURN A_to_type2, COLLECT({n2Id: n2Id, count: cnt}) AS type2_to_n2Id\r\n\r\nSample result:\r\n\r\n    ╒══════════╤══════════════════════════════════════════════╕\r\n    │A_to_type2│type2_to_n2Id                                 │\r\n    ╞══════════╪══════════════════════════════════════════════╡\r\n    │2         │[{count: 2, n2Id: &quot;D&quot;}, {count: 1, n2Id: &quot;E&quot;}]│\r\n    └──────────┴──────────────────────────────────────────────┘",
                    "title": "Count distinct node pairings in a multihop match"
                }
            ],
            "owner": {
                "account_id": 7753371,
                "reputation": 31,
                "user_id": 5868625,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/a26d526794bcf8b9755d4cfde3514e42?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "erikejan",
                "link": "https://stackoverflow.com/users/5868625/erikejan"
            },
            "is_answered": false,
            "view_count": 28,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1701878441,
            "question_id": 77614613,
            "body_markdown": "I&#39;m looking to count the number of distinct pairings in query of neighbor&#39;s neighbors. Let say I have a small graph consisting of the following nodes and edges,\r\n\r\n    (id:A, type:1)-&gt;(id:B, type:2)\r\n    (id:A, type:1)-&gt;(id:C, type:2)\r\n    (id:B, type:2)-&gt;(id:D, type:3)\r\n    (id:C, type:2)-&gt;(id:D, type:3)\r\n    (id:C, type:2)-&gt;(id:E, type:3)\r\n\r\nand a pattern to match like,\r\n\r\n    MATCH (n0 {id: A})--(n1:2)--(n2)\r\n    WHERE n2.id IN [&quot;D&quot;, &quot;E&quot;]\r\n\r\nI am looking for a query that will count the distinct pairings along this 2-hop pattern. In other words, the expected answer would give the counts,\r\n\r\n    A to type2   : 2 connections\r\n    type2 to D   : 2 connections\r\n    type2 to E   : 1 connection",
            "link": "https://stackoverflow.com/questions/77614613/count-distinct-node-pairings-in-a-multihop-match",
            "title": "Count distinct node pairings in a multihop match"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "graph-databases",
                "shortest-path",
                "neo4j-apoc"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701812532,
                    "answer_id": 77609396,
                    "question_id": 77608911,
                    "body_markdown": "If you want to only find paths where the relationships are in one direction e.g. outbound, you can either prepend `&lt;` to the relationship type for inbound, or append `&gt;` for outbound. \r\n\r\nTo only follow outbound `ROAD_SEGMENT` relationships, your query would become:\r\n```sql\r\nMATCH (a:Address)-[:NEAREST_INTERSECTION]-&gt;(source:Intersection)\r\nWHERE a.full_address CONTAINS &quot;410 E 5TH AVE SAN MATEO, CA&quot;\r\nMATCH (poi:Address)-[:NEAREST_INTERSECTION]-&gt;(dest:Intersection) \r\nWHERE poi.full_address CONTAINS &quot;39 GRAND BLVD SAN MATEO, CA&quot;\r\nCALL apoc.algo.aStarConfig(source, dest, &quot;ROAD_SEGMENT&gt;&quot;, \r\n  {pointPropName: &quot;location&quot;, weight: &quot;length&quot;}) \r\nYIELD weight, path\r\nRETURN *\r\n``` ",
                    "title": "Shortest path of weighted and directed graph in Neo4j"
                }
            ],
            "owner": {
                "account_id": 30074975,
                "reputation": 1,
                "user_id": 23048059,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/07bf9a2ad417d0989b6e131f6125237e?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "strzelaczbramek9",
                "link": "https://stackoverflow.com/users/23048059/strzelaczbramek9"
            },
            "is_answered": false,
            "view_count": 17,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1701805911,
            "question_id": 77608911,
            "body_markdown": "I created a map of city in Neo4j using OpenStreetMap and OpenAddresses data. I want to find the shortest path from one address to another. The problem is that, when I&#39;m using function apoc.algo.aStarConfig,I&#39;m getting a path without consideration about direction of a relationship.\r\n\r\n\r\n```\r\nMATCH (a:Address)-[:NEAREST_INTERSECTION]-&gt;(source:Intersection)\r\nWHERE a.full_address CONTAINS &quot;410 E 5TH AVE SAN MATEO, CA&quot;\r\nMATCH (poi:Address)-[:NEAREST_INTERSECTION]-&gt;(dest:Intersection) \r\nWHERE poi.full_address CONTAINS &quot;39 GRAND BLVD SAN MATEO, CA&quot;\r\nCALL apoc.algo.aStarConfig(source, dest, &quot;ROAD_SEGMENT&quot;, \r\n  {pointPropName: &quot;location&quot;, weight: &quot;length&quot;}) \r\nYIELD weight, path\r\nRETURN *\r\n```\r\n[Result of the query](https://i.stack.imgur.com/nTytn.png)\r\n\r\n\r\n**So my question is if there is a possibility to find the shortest path from one path to another not consider upstream relathionships?**",
            "link": "https://stackoverflow.com/questions/77608911/shortest-path-of-weighted-and-directed-graph-in-neo4j",
            "title": "Shortest path of weighted and directed graph in Neo4j"
        },
        {
            "tags": [
                "graph",
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701806107,
                    "answer_id": 77608932,
                    "question_id": 77608338,
                    "body_markdown": "With the first query, you are probably getting an error telling you that `classId` is not defined. In which case, no nodes are being created.\r\n\r\nIf you are just looking to test the properties of the first created node, you can modify your existing query to declare a variable e.g. `n` in the node pattern. You can then access node properties with the dot notation in the `RETURN` clause:\r\n```sql\r\nLOAD CSV WITH HEADERS FROM &#39;file:///Badges.csv&#39; AS row\r\nCREATE (n:Badges {\r\n  classid: toInteger(row.Class),\r\n  name: row.Name,\r\n  badgeId: toInteger(row.Id)\r\n})\r\nRETURN n.classid, n.name, n.badgeId \r\nLIMIT 1;\r\n```",
                    "title": "I can not import from csv files into Neo4j"
                }
            ],
            "owner": {
                "account_id": 14106680,
                "reputation": 1,
                "user_id": 10190562,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/-4Hb169t4leM/AAAAAAAAAAI/AAAAAAAAAAs/VJRzPqTBMiA/photo.jpg?sz=256",
                "display_name": "mahsa tajik",
                "link": "https://stackoverflow.com/users/10190562/mahsa-tajik"
            },
            "is_answered": false,
            "view_count": 41,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1701799094,
            "question_id": 77608338,
            "body_markdown": "```sql\r\n// BadgesNode\r\nLOAD CSV WITH HEADERS FROM &#39;file:///Badges.csv&#39; AS row\r\nCREATE (:Badges {\r\n  classid: toInteger(row.Class),\r\n  name: row.Name,\r\n  badgeId: toInteger(row.Id)\r\n})\r\nWITH *\r\nLIMIT 1\r\nRETURN classid, name, badgeId;\r\n```\r\n\r\nwhen I run it, there is no value in the properties. But when I run this cypher \r\n\r\n```sql\r\nLOAD CSV WITH HEADERS FROM &#39;file:///Badges.csv&#39; AS row\r\nRETURN row\r\n```\r\n\r\nand this is the result that it returns:\r\n```json\r\n{\r\n  &quot;Name&quot;: &quot;Informed&quot;,\r\n  &quot;Date&quot;: &quot;2014-05-13 23:06&quot;,\r\n  &quot;Class&quot;: &quot;3&quot;,\r\n  &quot;Id&quot;: &quot;1&quot;,\r\n  &quot;UserId&quot;: &quot;1&quot;,\r\n  &quot;TagBased&quot;: &quot;FALSE&quot;\r\n}\r\n```\r\n\r\n\r\nI can not understand why the first cypher does not return values into the properties. Can somebody help me. I stuck in this part for two days. \r\n\r\nI need to fill the properties by the values in the csv file.\r\nAnd this is a subset of my csv file.\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/834Hw.png",
            "link": "https://stackoverflow.com/questions/77608338/i-can-not-import-from-csv-files-into-neo4j",
            "title": "I can not import from csv files into Neo4j"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 8355167,
                        "reputation": 1,
                        "user_id": 6275738,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/-FxqHo1AG_G0/AAAAAAAAAAI/AAAAAAAAAIw/pSFQVbBMydg/photo.jpg?sz=256",
                        "display_name": "Shakthi Ramalingam",
                        "link": "https://stackoverflow.com/users/6275738/shakthi-ramalingam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701327176,
                    "answer_id": 77576432,
                    "question_id": 77576343,
                    "body_markdown": "```sql\r\nMATCH (n:Commercial) \r\nWITH count(n) AS grosssales \r\nMATCH (c:Commercial) \r\nWITH grosssales,count(c) AS distinctcustomer, c.customer_id AS customer, tofloat(grosssales/count(c)) AS salesreach \r\nRETURN imp AS grosssales, distinctcustomer, customer, salesreach\r\n```\r\n",
                    "title": "Cypher Nested Query"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701916218,
                    "answer_id": 77617346,
                    "question_id": 77576343,
                    "body_markdown": "You can simplify the query by using the new [COUNT subquery](https://neo4j.com/docs/cypher-manual/current/subqueries/count/) (in neo4j 5.0+) to count the total number of `Commercial` nodes. Although `COUNT()` is an aggregating function, a COUNT subquery is not -- so it is not affected by the `customer` grouping key.\r\n\r\n    MATCH (c:Commercial) \r\n    WITH COUNT{ (:Commercial) } AS grosssales, COUNT(c) AS distinctcustomer, c.customer_id AS customer\r\n    RETURN grosssales, distinctcustomer, customer, TOFLOAT(grosssales/distinctcustomer) AS salesreach\r\n\r\n",
                    "title": "Cypher Nested Query"
                }
            ],
            "owner": {
                "account_id": 8355167,
                "reputation": 1,
                "user_id": 6275738,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/-FxqHo1AG_G0/AAAAAAAAAAI/AAAAAAAAAIw/pSFQVbBMydg/photo.jpg?sz=256",
                "display_name": "Shakthi Ramalingam",
                "link": "https://stackoverflow.com/users/6275738/shakthi-ramalingam"
            },
            "is_answered": false,
            "view_count": 36,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1701325970,
            "question_id": 77576343,
            "body_markdown": "Trying to build nested query in cypher sql to find the grosssale, sales by distinctcustomer and salesreach and not able to pass column 1 value as input to another column - any help would be appreciated.\r\n\r\nSyntax here\r\n\r\n```sql\r\nMATCH (n:Commercial)\r\nWITH (n) AS grosssales, count(n) AS distinctcustomer, \r\n  n.customer_id AS customer, ### grouping by customer_id ###\r\n  grosssale / distinctcustomer AS salesreach\r\nRETURN grossale, distinctcustomer, salesreach, customer_id\r\n```\r\n\r\nTried WITH clause however no joy, would appreciate any help in correcting the cypher syntax.",
            "link": "https://stackoverflow.com/questions/77576343/cypher-nested-query",
            "title": "Cypher Nested Query"
        },
        {
            "tags": [
                "spring",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 26739540,
                        "reputation": 91,
                        "user_id": 20340543,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/391fa27c030df060dd7293769457b56c?s=256&d=identicon&r=PG",
                        "display_name": "Podbrushkin",
                        "link": "https://stackoverflow.com/users/20340543/podbrushkin"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1701288939,
                    "answer_id": 77574246,
                    "question_id": 77571107,
                    "body_markdown": "If you are asking about how to use embedded neo4j in Spring Data Neo4j application, - indeed it is possible, even though officially is [not supported](https://gist.github.com/michael-simons/d3137f64ac0b13713fae8e7e1a69367e?permalink_comment_id=4756611#gistcomment-4756611) (I wonder where it is officially proclaimed). \r\n\r\nThis is how it can be done:\r\n1. Add neo4j to dependencies:\r\n```xml\r\n&lt;dependency&gt;\r\n\t\t&lt;groupId&gt;org.neo4j&lt;/groupId&gt;\r\n\t\t&lt;artifactId&gt;neo4j&lt;/artifactId&gt;\r\n\t\t&lt;version&gt;5.13.0&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n2. Add these beans to your Spring Boot configuration class:\r\n```java\r\n@Bean\r\n\tpublic Configuration cypherDslConfiguration() {\r\n\t\treturn Configuration.newConfig().withDialect(Dialect.NEO4J_5).build();\r\n\t}\r\n\r\n//https://neo4j.com/docs/java-reference/current/java-embedded/setup/\r\n@Bean\r\npublic DatabaseManagementService databaseManagementService() {\r\n\tDatabaseManagementService managementService = new \r\n\t\tDatabaseManagementServiceBuilder(new File(&quot;target/mydb&quot;).toPath())\r\n\t\t\t.setConfig(GraphDatabaseSettings.transaction_timeout, Duration.ofSeconds( 60 ) )\r\n\t\t\t.setConfig( BoltConnector.enabled, true )\r\n\t\t\t.setConfig(BoltConnector.encryption_level, BoltConnector.EncryptionLevel.DISABLED)\r\n\t\t\t.build();\r\n\t\r\n\tregisterShutdownHook(managementService);\r\n\treturn managementService;\r\n}\r\n\r\n@Bean\r\npublic GraphDatabaseService graphDatabaseService(DatabaseManagementService managementService) {\r\n\tGraphDatabaseService graphDb =\r\n\t\tmanagementService.database(GraphDatabaseSettings.DEFAULT_DATABASE_NAME);\r\n\tlog.info(&quot;Neo4j database Embedded instance is available: {}&quot;, graphDb.isAvailable());\r\n\treturn graphDb;\r\n}\r\nprivate static void registerShutdownHook(final DatabaseManagementService managementService) {\r\n\tRuntime.getRuntime().addShutdownHook(new Thread() {\r\n\t\t@Override\r\n\t\tpublic void run() {\r\n\t\t\tmanagementService.shutdown();\r\n\t\t}\r\n\t});\r\n}\r\n```\r\n3. Annotate your Spring Boot `@SpringBootApplication` with `@EnableNeo4jRepositories`.\r\n4. SDN repositories now will work. \r\n\r\nFully working example can be found [in this Gist](https://gist.github.com/Podbrushkin/54518ad6c4835706fd3344f01ea6acc9),  place those files in correct subdirectories and execute `mvn clean spring-boot:run`, you will see repositories are working. Application will break only if you will enable HttpConnector.\r\n\r\nI hope this is what you&#39;ve asked for.\r\n\r\nduplicate: https://stackoverflow.com/questions/76901420/how-to-connect-spring-data-neo4j-to-embedded-neo4j-server",
                    "title": "Spring Boot embedded neo4j for demo purposes"
                }
            ],
            "owner": {
                "account_id": 20541842,
                "reputation": 173,
                "user_id": 20036372,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/a60111308ed533786c6b22b8d82d3db6?s=256&d=identicon&r=PG",
                "display_name": "asfarasiknow",
                "link": "https://stackoverflow.com/users/20036372/asfarasiknow"
            },
            "is_answered": true,
            "view_count": 35,
            "favorite_count": 0,
            "accepted_answer_id": 77574246,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1701260419,
            "question_id": 77571107,
            "body_markdown": "I want to use the built-in neo4j for demonstration purposes, so the application must be deployed somewhere. It cannot be any test instance such as `TestContainers`. I know that neo4j has a built-in neo4j driver for java, but it is not supported by `spring data neo4j` - I would have to rewrite all the application logic, which now uses spring data neo4j. I use docker for local development, but the goal is to have neo4j `in-memory` fully supported by `spring data neo4j`. \r\n ",
            "link": "https://stackoverflow.com/questions/77571107/spring-boot-embedded-neo4j-for-demo-purposes",
            "title": "Spring Boot embedded neo4j for demo purposes"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1701192069,
                    "answer_id": 77565897,
                    "question_id": 77565696,
                    "body_markdown": "To follow all paths composed of relationships with either type `Sync` and direction outbound, or type `Async` and direction inbound, the following [quantified path pattern][1] will work:\r\n```sql\r\nMATCH (s {type: &#39;service&#39;}) \r\n        ((n)-[r]-() WHERE (n = startNode(r) AND r:Sync) \r\n          OR (n = endNode(r) AND r:Async))+ (dependent)\r\nRETURN s, collect(DISTINCT dependent) AS allDependentNodes\r\n```\r\n\r\n\r\n  [1]: https://neo4j.com/docs/cypher-manual/current/patterns/concepts/#quantified-path-patterns",
                    "title": "How to match nodes in Cypher query based on different directions per relationship type"
                }
            ],
            "owner": {
                "account_id": 964672,
                "reputation": 2010,
                "user_id": 988324,
                "user_type": "registered",
                "accept_rate": 65,
                "profile_image": "https://www.gravatar.com/avatar/e9a50cfb6dd20efd1198fdafc0b1c11a?s=256&d=identicon&r=PG",
                "display_name": "Richard Deurwaarder",
                "link": "https://stackoverflow.com/users/988324/richard-deurwaarder"
            },
            "is_answered": true,
            "view_count": 56,
            "favorite_count": 0,
            "accepted_answer_id": 77565897,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1701190063,
            "question_id": 77565696,
            "body_markdown": "I&#39;ve got a graph with two types of relationships: `Sync` and `Async`.\r\n\r\nI want a query to give me a subgraph, meaning all the nodes that can be reached directly or indirectly.\r\n\r\nThis query works for this:\r\n\r\n    MATCH (s {type: &#39;service&#39;)\r\n    OPTIONAL MATCH (s)-[:Async|Sync*]-&gt;(dependent)\r\n    WITH s, COLLECT(DISTINCT dependent) AS allDependentNodes\r\n\r\nThis gives me every node that can be reached via an Sync or Async relationship.\r\n\r\n\r\nBut now I&#39;d like to use a different direction based on the type of relation. I want nodes that can be reached via outgoing Sync `a -&gt; b` OR reached via incoming Async `a &lt;- b`.  \r\n\r\nSo it&#39;s like an OR&#39;d match condition. I&#39;ve tried a few things without much success:\r\n\r\n    MATCH (s {type: &#39;service&#39;)\r\n    OPTIONAL MATCH (s)-[:Sync*]-&gt;(dependent), (s)&lt;-[:Async*]-(d)\r\n    WITH s, totalNodes, COLLECT(DISTINCT dependent) AS allDependentNodes\r\n\r\n\r\nHow can I OR&#39;d together relationship matches or how can I match different types of relationships with different directions?",
            "link": "https://stackoverflow.com/questions/77565696/how-to-match-nodes-in-cypher-query-based-on-different-directions-per-relationshi",
            "title": "How to match nodes in Cypher query based on different directions per relationship type"
        },
        {
            "tags": [
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 33099,
                        "reputation": 29846,
                        "user_id": 92359,
                        "user_type": "registered",
                        "accept_rate": 94,
                        "profile_image": "https://www.gravatar.com/avatar/664d3d4c50c731d90a32db5f9e01b4b9?s=256&d=identicon&r=PG",
                        "display_name": "InverseFalcon",
                        "link": "https://stackoverflow.com/users/92359/inversefalcon"
                    },
                    "is_accepted": true,
                    "score": 2,
                    "creation_date": 1701129988,
                    "answer_id": 77560648,
                    "question_id": 77560500,
                    "body_markdown": "Assuming you want to continuously follow a pattern of sent emails, you could use quantified path patterns to do so:\r\n\r\n```\r\nMATCH (p1:Person where p1.name=&#39;Jeff&#39;) (()-[:EMAIL_FROM]-&gt;(:Email)-[:EMAIL_TO]-&gt;(:Person))+ (p2)\r\nRETURN DISTINCT p2\r\n```\r\n\r\nThis will repeat the last part of the pattern with a lower bound of 1 and no upper bound. For any non-trivial graph this may not finish, and you may have heap issues. We would recommend setting an upper bound if possible.\r\n\r\nAnother approach would be to use APOC Procedures, the path explorer procedures, as those might be more efficient in finding distinct reachable nodes.\r\n\r\n```\r\nMATCH (p1:Person where p1.name=&#39;Jeff&#39;) \r\nCALL apoc.path.subgraphNodes(p1, {relationshipFilter:&#39;EMAIL_FROM&gt;, EMAIL_TO&gt;&#39;, labelFilter:&#39;&gt;Person&#39;}) YIELD node\r\nRETURN node\r\n```\r\n\r\nThis will repeat outgoing :EMAIL_FROM and :EMAIL_TO relationships, returning only :Person nodes, and the uniqueness used by this procedure should only return distinct end nodes.",
                    "title": "Neo4j: Variable-length-relationship with intermediary node"
                }
            ],
            "owner": {
                "account_id": 24101638,
                "reputation": 47,
                "user_id": 18073394,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AATXAJyEN-n5TpGIABhidOfpIdq3rVAPCr2oRvfpTjsN=k-s256",
                "display_name": "NoraTheFlora",
                "link": "https://stackoverflow.com/users/18073394/noratheflora"
            },
            "is_answered": true,
            "view_count": 34,
            "favorite_count": 0,
            "accepted_answer_id": 77560648,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1701127131,
            "question_id": 77560500,
            "body_markdown": "I have a neo4j database with two types of node labels: person and email.\r\nOne email node always connects two person nodes through the relationships &#39;EMAIL_FROM&#39; and &#39;EMAIL_TO&#39;\r\nsuch that the relationship can be queried like such:\r\n\r\n    match (p1:Person)-[:EMAIL_FROM]-&gt;(:Email)-[:EMAIL_TO]-&gt;(p2:Person) return p1, p2\r\nI&#39;m trying to write a variable-length-relationship query which begins at a certain person node and finds all other person nodes that can be reached through the intermediary email nodes. This is what I tried:\r\n\r\n    match (p1:Person where p1.name=&#39;Jeff&#39;)-[:EMAIL_FROM*]-&gt;(:Email)-[:EMAIL_TO*]-&gt;(p2:Person) return p1, p2\r\nThis sadly does not work as I thought it would and returns only directly reachable from the &#39;Jeff&#39; node by iterating through the pattern once but then it stops although I know the nodes reached in the first iteration have outgoing &#39;EMAIL_FROM&#39; relationships themselves. Thanks in advance.",
            "link": "https://stackoverflow.com/questions/77560500/neo4j-variable-length-relationship-with-intermediary-node",
            "title": "Neo4j: Variable-length-relationship with intermediary node"
        },
        {
            "tags": [
                "python",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 29000777,
                        "reputation": 1,
                        "user_id": 22214354,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/96faa0d16e180bc41836018844e66c62?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "Jonathan Giffard",
                        "link": "https://stackoverflow.com/users/22214354/jonathan-giffard"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701078800,
                    "answer_id": 77555954,
                    "question_id": 77555016,
                    "body_markdown": "Looking at the output from print(dir(connector)) , the message is correct - there is no attribute named &#39;run&#39;\r\n\r\n&gt; [&#39;__class__&#39;, &#39;__delattr__&#39;, &#39;__dict__&#39;, &#39;__dir__&#39;, &#39;__doc__&#39;,\r\n&gt; &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;, &#39;__getattribute__&#39;, &#39;__getstate__&#39;,\r\n&gt; &#39;__gt__&#39;, &#39;__hash__&#39;, &#39;__init__&#39;, &#39;__init_subclass__&#39;, &#39;__le__&#39;,\r\n&gt; &#39;__lt__&#39;, &#39;__module__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;,\r\n&gt; &#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__setattr__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;,\r\n&gt; &#39;__subclasshook__&#39;, &#39;__weakref__&#39;, &#39;_driver&#39;, &#39;close&#39;, &#39;driver&#39;]\r\n\r\n\r\nI&#39;d look at connector.driver.execute_query as that will likely achieve what you are looking to do. \r\n\r\n",
                    "title": "How to fix &quot;Type &#39;Neo4jConnector&#39; doesn&#39;t have expected attribute &#39;run&#39; &quot; in python file"
                },
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1701079458,
                    "answer_id": 77556024,
                    "question_id": 77555016,
                    "body_markdown": "Some of your functions e.g. `edit_inbound_rule` call a method  `run` that the class `Neo4jConnector` does not have. One fix is to work with the GraphDatabase.driver, as is done in `create_inbound_rule`. \r\n\r\nFor example, rewrite `edit_inbound_rule` like so:\r\n```python\r\ndef edit_inbound_rule(connector, new_profile_id, new_message, new_processingflag1):\r\n    s_id = dict[&quot;s_id&quot;]\r\n    return_name = &#39;Rule Edit Successfully&#39;\r\n    query = (\r\n        &quot;MATCH (r:Rule) WHERE r.id_name = $s_id &quot;\r\n        &quot;SET r.profileid = $new_profile_id, &quot;\r\n        &quot;    r.message = $new_message, &quot;\r\n        &quot;    r.processingflag1 = $new_processingflag1 &quot;\r\n    )\r\n\r\n    with connector._driver.session() as session:\r\n        session.write_transaction(lambda tx: tx.run(query, new_profile_id=new_profile_id,\r\n                  new_message=new_message, new_processingflag1=new_processingflag1, s_id=s_id))\r\n\r\n    return return_name\r\n```",
                    "title": "How to fix &quot;Type &#39;Neo4jConnector&#39; doesn&#39;t have expected attribute &#39;run&#39; &quot; in python file"
                }
            ],
            "owner": {
                "account_id": 25680619,
                "reputation": 13,
                "user_id": 19443460,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AATXAJww51pxUl9Y4zOSRkBlvASDGz9bXc4RF8ZJ-5VnCA=k-s256",
                "display_name": "Kevin Paul Babu",
                "link": "https://stackoverflow.com/users/19443460/kevin-paul-babu"
            },
            "is_answered": true,
            "view_count": 44,
            "favorite_count": 0,
            "accepted_answer_id": 77556024,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1701068434,
            "question_id": 77555016,
            "body_markdown": "This is the code below for connecting and running `neo4j` and python . I have seen a `neo4j` warning from the code . Is that a severe warning or is it mandatory to fix it? How to fix this issue? The warning is `&quot; Type &#39;Neo4jConnector&#39; doesn&#39;t have expected attribute &#39;run&#39; &quot;`\r\n```\r\nfrom neo4j import GraphDatabase\r\n\r\n\r\nclass Neo4jConnector:\r\n    def __init__(self, uri, user, password):\r\n        self._driver = GraphDatabase.driver(uri, auth=(user, password))\r\n\r\n    def close(self):\r\n        self._driver.close()\r\n\r\n    @property\r\n    def driver(self):\r\n        return self._driver\r\n\r\n\r\ndef get_nodes_by_id_name(tx, id_name):\r\n    query = (\r\n        &quot;MATCH (r:Rule) &quot;\r\n        &quot;WHERE r.id_name = $id_name &quot;\r\n        &quot;RETURN r&quot;\r\n    )\r\n    result = []\r\n    for record in tx.run(query, id_name=id_name):\r\n        result.append(record[&quot;node&quot;])\r\n    return result\r\n\r\n\r\ndef create_inbound_rule(connector, profileid, sender, receiver, message, processingflag1, ruletype):\r\n    id_name = receiver + &#39;_inBOUND_&#39; + sender\r\n    name1_inbound = receiver + &#39;_inBOUND_&#39; + sender + &#39;_SFTP_STEP1&#39;\r\n    return_name = name1_inbound + &#39;&amp; SFTP_STEP2 created successfully&#39;\r\n\r\n    query = (\r\n        &quot;CREATE (r:Rule {sender: $sender, receiver: $receiver, &quot;\r\n        &quot;message: $message, profileid: $profileid, ruletype: $ruletype, &quot;\r\n        &quot;processingflag1: $processingflag1,id_name:$id_name})&quot;\r\n    )\r\n\r\n    with connector._driver.session() as session:\r\n        session.write_transaction(lambda tx: tx.run(query, sender=sender, receiver=receiver,\r\n                                                    message=message, profileid=profileid,\r\n                                                    ruletype=ruletype, processingflag1=processingflag1,\r\n                                                    id_name=id_name))\r\n        return return_name\r\n\r\n\r\ndef create_outbound_rule(connector, profileid_outbound, sender_outbound, receiver_outbound,\r\n                         message_outbound, processingflag1_outbound, filename_output):\r\n    id_name = receiver_outbound + &#39;_outbound_&#39; + sender_outbound\r\n    name1_outbound = receiver_outbound + &#39;_Outbound_&#39; \\\r\n                     + sender_outbound + &#39;_SFTP_STEP1&#39;\r\n    return_name = name1_outbound + &#39;&amp; SFTP_STEP2 created successfully&#39;\r\n    query = (\r\n        &quot;CREATE (r:Rule {sender_outbound: $sender_outbound, receiver_outbound: $receiver_outbound, &quot;\r\n        &quot;message_outbound: $message_outbound, profileid_outbound: $profileid_outbound, &quot;\r\n        &quot;filename_output: $filename_output, &quot;\r\n        &quot;processingflag1_outbound: $processingflag1_outbound,id_name:$id_name})&quot;\r\n    )\r\n\r\n    with connector._driver.session() as session:\r\n        session.write_transaction(\r\n            lambda tx: tx.run(query, sender_outbound=sender_outbound, receiver_outbound=receiver_outbound,\r\n                              message_outbound=message_outbound, profileid_outbound=profileid_outbound,\r\n                              filename_output=filename_output, processingflag1_outbound=processingflag1_outbound,\r\n                              id_name=id_name))\r\n        return return_name\r\n\r\n\r\ndef create_both_rule(connector, inbound_profileid, outbound_profileid, sender, receiver, message, processingflag1,\r\n                     filename, return_name, id_name):\r\n    query = (\r\n        &quot;CREATE (r:Rule {sender: $sender, receiver: $receiver, &quot;\r\n        &quot;message: $message, inbound_profileid: $inbound_profileid, outbound_profileid: $outbound_profileid, &quot;\r\n        &quot;processingflag1: $processingflag1, filename: $filename,id_name:$id_name})&quot;\r\n    )\r\n\r\n    with connector._driver.session() as session:\r\n        session.write_transaction(lambda tx: tx.run(query, sender=sender, receiver=receiver,\r\n                                                    message=message, inbound_profileid=inbound_profileid,\r\n                                                    outbound_profileid=outbound_profileid,\r\n                                                    processingflag1=processingflag1,\r\n                                                    filename=filename, id_name=id_name))\r\n        return return_name\r\n\r\n\r\ndef create_inbound_basictx_rule(connector, tradingpartner_basictx, profileid_basictx, processingflag1_basictx, id_name):\r\n    name1_basictx = &quot;1.0.0_ELUX_INBOUND_RECEIVE_FROM_&quot; + tradingpartner_basictx + &quot;_SFTP_TO_BASICTX&quot;\r\n    name2_basictx = &quot;1.0.2_ELUX_GENERIC_IN_FLAT_FILE_&quot; + processingflag1_basictx + &quot;_BASICTX_TO_CC_FINISH&quot;\r\n    return_name = name1_basictx + name2_basictx + &quot;created successfully&quot;\r\n    query = (\r\n        &quot;CREATE (r:Rule {TradingPartner: $tradingpartner_basictx, profileid: $profileid_basictx, &quot;\r\n        &quot;processingflag1_basictx: $processingflag1_basictx,id_name:$id_name})&quot;\r\n    )\r\n\r\n    with connector._driver.session() as session:\r\n        session.write_transaction(lambda tx: tx.run(query, tradingpartner_basictx=tradingpartner_basictx,\r\n                                                    profileid_basictx=profileid_basictx,\r\n                                                    processingflag1_basictx=processingflag1_basictx, id_name=id_name))\r\n    return return_name\r\n\r\n\r\ndef create_outbound_basictx_rule(connector, tradingpartner_basictx, profileid_basictx, processingflag1_basictx,\r\n                                 id_name):\r\n    name1_basictx = &quot;1.0.0_ELUX_OUTBOUND_RECEIVE_FROM_&quot; + tradingpartner_basictx + &quot;_SFTP_TO_BASICTX&quot;\r\n    name2_basictx = &quot;1.0.2_ELUX_GENERIC_IN_FLAT_FILE_&quot; + processingflag1_basictx + &quot;_BASICTX_TO_CC_FINISH&quot;\r\n    return_name = name1_basictx + name2_basictx + &quot;created successfully&quot;\r\n    query = (\r\n        &quot;CREATE (r:Rule {TradingPartner: $tradingpartner_basictx, profileid: $profileid_basictx, &quot;\r\n        &quot;processingflag1: $processingflag1_basictx,id_name:$id_name})&quot;\r\n    )\r\n    with connector._driver.session() as session:\r\n        session.write_transaction(lambda tx: tx.run(query, tradingpartner_basictx=tradingpartner_basictx,\r\n                                                    profileid_basictx=profileid_basictx,\r\n                                                    processingflag1_basictx=processingflag1_basictx, id_name=id_name))\r\n        return return_name\r\n\r\n\r\ndef edit_inbound_rule(connector, new_profile_id, new_message, new_processingflag1):\r\n    s_id = dict[&quot;s_id&quot;]\r\n    return_name = &#39;Rule Edit Successfully&#39;\r\n    query = (\r\n        &quot;MATCH (r:Rule) WHERE r.id_name = $s_id &quot;\r\n        &quot;SET r.profileid = $new_profile_id, &quot;\r\n        &quot;    r.message = $new_message, &quot;\r\n        &quot;    r.processingflag1 = $new_processingflag1 &quot;\r\n    )\r\n    connector.run(query, new_profile_id=new_profile_id,\r\n                  new_message=new_message, new_processingflag1=new_processingflag1, s_id=s_id)\r\n\r\n    return return_name\r\n\r\n\r\ndef edit_outbound_rule(connector, new_profile_id, new_message, new_processing_flag, new_filename):\r\n    s_id = dict[&quot;s_id&quot;]\r\n    return_name = &#39;Rule Edit Successfully&#39;\r\n    query = (\r\n        &quot;MATCH (r:Rule) WHERE r.id_name = $id_name &quot;\r\n        &quot;SET r.profileid_outbound = $new_profile_id, &quot;\r\n        &quot;    r.message_outbound = $new_message, &quot;\r\n        &quot;    r.processingflag1_outbound = $new_processing_flag, &quot;\r\n        &quot;    r.filename_output = $new_filename&quot;\r\n    )\r\n    connector.run(query, return_name=return_name, new_profile_id=new_profile_id,\r\n                  new_message=new_message, new_processing_flag=new_processing_flag,\r\n                  new_filename=new_filename, s_id_name=s_id)\r\n\r\n\r\ndef edit_both_rule(connector, new_inbound_profile_id, new_outbound_profile_id, new_message,\r\n                   new_processing_flag,\r\n                   new_filename):\r\n    s_id = dict[&quot;s_id&quot;]\r\n    return_name = &#39;Rule Edit Successfully&#39;\r\n    query = (\r\n        &quot;MATCH (r:Rule) WHERE r.id_name = $s_id &quot;\r\n        &quot;SET r.inbound_profileid_both = $new_inbound_profile_id, &quot;\r\n        &quot;    r.outbound_profileid_both = $new_outbound_profile_id, &quot;\r\n        &quot;    r.message_both = $new_message, &quot;\r\n        &quot;    r.processingflag1_both= $new_processing_flag, &quot;\r\n        &quot;    r.filename_both = $new_filename&quot;\r\n    )\r\n    connector.run(query, new_inbound_profile_id=new_inbound_profile_id,\r\n                  new_outbound_profile_id=new_outbound_profile_id, new_message=new_message,\r\n                  new_processing_flag=new_processing_flag, new_filename=new_filename, s_id_=s_id)\r\n\r\n    return return_name\r\n\r\n\r\ndef edit_inbound_basictx_rule(connector, new_tradingpartner, new_profile_id, new_processing_flag):\r\n    s_id = dict[&quot;s_id&quot;]\r\n    return_name = &#39;Rule Edit Successfully&#39;\r\n    query = (\r\n        &quot;MATCH (r:Rule) WHERE r.id_name = $s_id &quot;\r\n        &quot;SET r.tradingpartner = $new_tradingpartner, &quot;\r\n        &quot;    r.profile_id = $new_profile_id, &quot;\r\n        &quot;    r.processing_flag = $new_processing_flag&quot;\r\n    )\r\n    connector.run(query, new_tradingpartner=new_tradingpartner,\r\n                  new_profile_id=new_profile_id, new_processing_flag=new_processing_flag, s_id=s_id)\r\n\r\n    return return_name\r\n\r\n\r\ndef edit_outbound_basictx_rule(connector, new_tradingpartner, new_profile_id, new_processing_flag):\r\n    s_id = dict[&quot;s_id&quot;]\r\n    return_name = &#39;Rule Edit Successfully&#39;\r\n    query = (\r\n        &quot;MATCH (r:Rule) WHERE r.id_name = $s_id &quot;\r\n        &quot;SET r.tradingpartner_basictx = $new_tradingpartner, &quot;\r\n        &quot;    r.profileid_basictx = $new_profile_id, &quot;\r\n        &quot;    r.processingflag1_basictx = $new_processing_flag&quot;\r\n    )\r\n\r\n    connector.run(query, return_name=return_name, new_tradingpartner=new_tradingpartner,\r\n                  new_profile_id=new_profile_id, new_processing_flag=new_processing_flag, s_id=s_id)\r\n\r\n    return return_name\r\n\r\n\r\ndef main(dict):\r\n    uri = &quot;bolt://localhost:7687&quot;\r\n    user = &quot;admin&quot;\r\n    password = &quot;password&quot;\r\n    connector = Neo4jConnector(uri, user, password)\r\n    ruletype = dict[&#39;ruletype&#39;]\r\n    # Initialize a dictionary to store the result\r\n\r\n    if ruletype == &#39;Inbound&#39;:\r\n        profileid = dict[&#39;profile_id&#39;]\r\n        sender = dict[&#39;sender&#39;]\r\n        receiver = dict[&#39;receiver&#39;]\r\n        message = dict[&#39;message&#39;]\r\n        processingflag1 = dict[&#39;processingflag1&#39;]\r\n        create_inbound_rule(connector, profileid, sender, receiver, message, processingflag1, )\r\n\r\n    elif ruletype == &#39;Outbound&#39;:\r\n        profileid_outbound = dict[&#39;profileid_outbound&#39;]\r\n        sender_outbound = dict[&#39;sender_outbound&#39;]\r\n        receiver_outbound = dict[&#39;receiver_outbound&#39;]\r\n        message_outbound = dict[&#39;message_outbound&#39;]\r\n        processingflag1_outbound = dict[&#39;processingflag1_outbound&#39;]\r\n        filename_output = dict[&#39;filename_output&#39;]\r\n\r\n        create_outbound_rule(connector, profileid_outbound, sender_outbound, receiver_outbound,\r\n                             message_outbound, processingflag1_outbound, filename_output)\r\n    elif ruletype == &#39;Both&#39;:\r\n        inbound_profileid_both = dict[&#39;inbound_profileid_both&#39;]\r\n        outbound_profileid_both = dict[&#39;outbound_profile_id_both&#39;]\r\n        sender_both = dict[&#39;sender_both&#39;]\r\n        receiver_both = dict[&#39;receiver_both&#39;]\r\n        message_both = dict[&#39;message_both&#39;]\r\n        processingflag1_both = dict[&#39;processingflag1_both&#39;]\r\n\r\n        filename_both = dict[&#39;filename_both&#39;]\r\n        id_name = receiver_both + &#39;_Both_&#39; + sender_both\r\n        return_name = receiver_both + &#39;both&#39; + sender_both + &#39;SFTP_STEP1,SFTP_STEP2 created successfully&#39;\r\n        create_both_rule(connector, inbound_profileid_both, outbound_profileid_both, sender_both,\r\n                         receiver_both, message_both, processingflag1_both, filename_both, return_name)\r\n\r\n    elif ruletype == &#39;Inbound BasicTx&#39;:\r\n        tradingpartner_basictx = dict[&quot;tradingpartner_Basictx&quot;]\r\n        profileid_basictx = dict[&quot;profileid_Basictx&quot;]\r\n        processingflag1_basictx = dict[&quot;ProcessingFlag1_Basictx&quot;]\r\n        id_name = &quot;ELUX_INBOUND_RECEIVE_FROM_&quot; + tradingpartner_basictx\r\n        create_inbound_basictx_rule(connector, tradingpartner_basictx, profileid_basictx,\r\n                                    processingflag1_basictx, id_name)\r\n    elif ruletype == &#39;Outbound BasicTx&#39;:\r\n        tradingpartner_basictx = dict[&quot;tradingpartner_basictx&quot;]\r\n        profileid_basictx = dict[&quot;profile_id_basictx&quot;]\r\n        processingflag1_basictx = dict[&quot;processingflag1_basictx&quot;]\r\n        id_name = &quot;ELUX_INBOUND_RECEIVE_FROM_&quot; + tradingpartner_basictx\r\n        create_outbound_basictx_rule(connector, tradingpartner_basictx, profileid_basictx,\r\n                                     processingflag1_basictx, id_name)\r\n    elif ruletype == &#39;Edit Inbound Rule&#39;:\r\n\r\n        new_message = dict[&quot;new_message&quot;]\r\n        new_profile_id = dict[&quot;new_profile_id&quot;]\r\n        new_processing_flag = dict[&quot;new_processing_flag&quot;]\r\n\r\n        edit_inbound_rule(connector, new_profile_id, new_message, new_processing_flag)\r\n\r\n    elif ruletype == &#39;Edit Outbound Rule&#39;:\r\n\r\n        new_profile_id = dict[&quot;new_profile_id&quot;]\r\n        new_message = dict[&quot;new_message&quot;]\r\n        new_processing_flag = dict[&quot;new_processing_flag&quot;]\r\n        new_filename = dict[&quot;new_filename&quot;]\r\n        edit_outbound_rule(connector, new_profile_id, new_message, new_processing_flag, new_filename)\r\n\r\n    elif ruletype == &#39;Edit Both Rule&#39;:\r\n\r\n        new_inbound_profile_id = dict[&quot;new_inbound_profile_id&quot;]\r\n        new_outbound_profile_id = dict[&quot;new_outbound_profile_id&quot;]\r\n        new_filename = dict[&#39;new_filename&#39;]\r\n        new_message = dict[&quot;Message_edit_Both&quot;]\r\n        new_processing_flag = dict[&quot;new_processing_flag&quot;]\r\n        edit_both_rule(connector, new_inbound_profile_id, new_outbound_profile_id, new_message,\r\n                       new_processing_flag, new_filename)\r\n    elif ruletype == &#39;Edit Inbound BasicTx&#39;:\r\n        id_name = dict[&#39;id_name&#39;]\r\n        new_tradingpartner = dict[&quot;new_tradingpartner&quot;]\r\n        new_profile_id = dict[&quot;new_profile_id&quot;]\r\n        new_processing_flag = dict[&quot;new_processing_flag&quot;]\r\n        edit_inbound_basictx_rule(connector, new_tradingpartner, new_profile_id, new_processing_flag)\r\n\r\n    elif ruletype == &#39;Edit Outbound BasicTx&#39;:\r\n        new_tradingpartner = dict[&quot;new_tradingpartner&quot;]\r\n        new_profile_id = dict[&quot;new_profile_id&quot;]\r\n        new_processing_flag = dict[&quot;new_processing_flag&quot;]\r\n        edit_outbound_basictx_rule(connector, new_tradingpartner, new_profile_id, new_processing_flag)\r\n\r\n    elif ruletype == &#39;Rule Search&#39;:\r\n        # Call the get_nodes_by_id_name function to retrieve nodes by id_name\r\n        id_name = dict[&#39;id_name&#39;]\r\n        return_name = &#39;Rule Search Successfully&#39;\r\n\r\n    else:\r\n        print(f&quot;Unsupported ruletype: {ruletype}&quot;)\r\n    connector.close()\r\n\r\n```\r\n\r\n\r\nI tried to solve this error to fix these warnings and it did not fix the issue\r\n",
            "link": "https://stackoverflow.com/questions/77555016/how-to-fix-type-neo4jconnector-doesnt-have-expected-attribute-run-in-pyt",
            "title": "How to fix &quot;Type &#39;Neo4jConnector&#39; doesn&#39;t have expected attribute &#39;run&#39; &quot; in python file"
        },
        {
            "tags": [
                "java",
                "spring",
                "spring-boot",
                "neo4j",
                "spring-data-neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1700999067,
                    "answer_id": 77551513,
                    "question_id": 77546470,
                    "body_markdown": "If you want the count of nodes to which the `SET` was applied, return the count of rows:\r\n\r\n```sql\r\nMATCH (n:Student) WHERE n.id IN $idList \r\nSET n.isRegistered = true\r\nRETURN count(*) AS numAffected\r\n```\r\n\r\nIf you want the count of nodes whose value of `isRegistered` was changed, remove nodes that already have `isRegistered = true` with the `WHERE` clause:\r\n\r\n```sql\r\nMATCH (n:Student) \r\nWHERE n.id IN $idList AND NOT coalesce(n.isRegistered, false) \r\nSET n.isRegistered = true\r\nRETURN count(*) AS numAffected\r\n```\r\n\r\n(I&#39;ve just formatted as stand-alone Cypher to make it easier read.)",
                    "title": "Spring Data Neo4j return count of affected nodes after update operation"
                }
            ],
            "owner": {
                "account_id": 18625023,
                "reputation": 27,
                "user_id": 13574344,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhGuIzJ2-1xF-utmOJhucA_rPsejZT_BlTMM9K7=k-s256",
                "display_name": "stackoverflow_user",
                "link": "https://stackoverflow.com/users/13574344/stackoverflow-user"
            },
            "is_answered": false,
            "view_count": 31,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700880286,
            "question_id": 77546470,
            "body_markdown": "Is there any way to return the count of affected nodes after doing the update operation with Spring Data Neo4j repository?\r\n\r\ne.g\r\n```\r\n@Query(&quot;MATCH (n:Student) WHERE n.id IN $idList SET n.isRegistered = true&quot;)\r\nInteger updateRegisterInfo(@Param(&quot;idList&quot;) List&lt;String&gt; idList);\r\n```\r\n\r\nBut sdn can only return void/null value for such operation.\r\n\r\nThanks",
            "link": "https://stackoverflow.com/questions/77546470/spring-data-neo4j-return-count-of-affected-nodes-after-update-operation",
            "title": "Spring Data Neo4j return count of affected nodes after update operation"
        },
        {
            "tags": [
                "csv",
                "vector",
                "neo4j",
                "cypher",
                "neo4j-admin"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 159676,
                        "reputation": 88163,
                        "user_id": 379235,
                        "user_type": "registered",
                        "accept_rate": 62,
                        "profile_image": "https://i.stack.imgur.com/qSUBs.png?s=256&g=1",
                        "display_name": "daydreamer",
                        "link": "https://stackoverflow.com/users/379235/daydreamer"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1700601817,
                    "answer_id": 77526008,
                    "question_id": 77525633,
                    "body_markdown": "I was able to solve this in 2 steps\r\n\r\n## Step 1: Fix the header file\r\n```\r\nid:ID,:LABEL,amount:double,measureUnit:string,gramWeight:double,embedding:float[]\r\n```\r\nNote the `float[]` as the type\r\n\r\n## Step 2: Importing array\r\nThis involved 2 steps\r\n### Step 2.1: Create a valid delimiter for array\r\n\r\n```\r\nconst embedding = await createEmbedding(embeddingInput);\r\nconst embeddingString = embedding.join(ARRAY_DELIMITER);\r\n```\r\nWhere `ARRAY_DELIMITER` is `|`\r\n\r\n### Step 2.2 Update import command to tell about delimiter\r\n```\r\nneo4j-admin database import full --array-delimiter=&#39;|&#39; // and so on...\r\n```\r\nNote `--array-delimiter=&#39;|&#39;` here.\r\n\r\nThis helped me fix the issue.",
                    "title": "Importing Vector Embedding in Neo4J via neo4j-admin import is failing with unknown property type &#39;LIST&lt;FLOAT&gt;&#39;"
                }
            ],
            "owner": {
                "account_id": 159676,
                "reputation": 88163,
                "user_id": 379235,
                "user_type": "registered",
                "accept_rate": 62,
                "profile_image": "https://i.stack.imgur.com/qSUBs.png?s=256&g=1",
                "display_name": "daydreamer",
                "link": "https://stackoverflow.com/users/379235/daydreamer"
            },
            "is_answered": false,
            "view_count": 11,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700596915,
            "question_id": 77525633,
            "body_markdown": "I have a CSV header and data file that I want to import in Neo4J using `neo4j-admin database` along with other files.\r\n\r\nHere are my files\r\n\r\n`HEADER`\r\n```\r\nid:ID,:LABEL,amount:double,measureUnit:string,gramWeight:double,embedding:LIST&lt;FLOAT&gt;\r\n```\r\n\r\n`DATA`\r\n```\r\nFFP_0_321358,FoodPortion_3_0_0,2,&quot;tablespoon&quot;,33.9,[0.1671835333108902,-0.7092851996421814,0.14913123846054077,0.7785872220993042,-0.312934011220932,0.08211034536361694,-0.028107712045311928,-0.25594303011894226,0.5699977278709412,0.6135631799697876,0.19823063910007477,0.09847097098827362,-0.6676387190818787,0.004426721017807722,-0.5394071340560913,0.9914360046386719,0.37802284955978394,0.2705143392086029,-0.06354071199893951,-0.3283253610134125,-0.12500542402267456,0.5226773023605347,-0.5599125623703003,-0.17582887411117554,0.33407628536224365,0.8492608666419983,1.6623034477233887,1.037268877029419,0.22571976482868195,0.5713614821434021,0.004049248062074184,-0.3291890323162079,-0.2762421667575836,0.2313031107187271,-0.1946457028388977,-0.17294952273368835,-0.08332429081201553,0.3433372676372528,0.5293984413146973,1.145921230316162,-0.6517155170440674,0.8047919273376465,0.012163370847702026,0.3513254225254059,-0.04551488906145096,0.2955775856971741,-0.023389466106891632,0.06517010182142258,-0.1647074818611145,-0.0821857675909996,0.23624971508979797,-0.7499469518661499,0.3026871979236603,-0.996300995349884,0.4166252911090851,0.338083416223526,1.4630589485168457,0.3421212434768677,-0.740848183631897,0.10450270026922226,-0.5746254920959473,0.9487141370773315,-0.6349362134933472,0.6473907232284546,0.737545907497406,0.631997287273407,-0.585864782333374,-1.2288835048675537,-0.4180561304092407,-0.2542168200016022,0.2972530126571655,0.14671950042247772,-0.22330710291862488,-0.602167546749115,0.29623106122016907,0.7523813247680664,-0.7711286544799805,-0.46698877215385437,-0.6049727201461792,0.5525864362716675,0.3214971125125885,-0.0008972518844529986,0.024934018030762672,0.09121513366699219,-0.99419105052948,0.01268870010972023,-0.25948208570480347,0.0844053328037262,-0.198614239692688,-0.03724987059831619,-0.6223516464233398,0.616694450378418,-0.7710570693016052,0.1813107579946518,0.2166164517402649,-0.2937754690647125,0.03168824687600136,-0.09738413244485855,-0.9887257814407349,-0.2576909363269806,-0.003925889730453491,0.039951808750629425,-0.1942584365606308,0.01654890924692154,0.027941200882196426,0.060958266258239746,0.31667277216911316,-0.5193405747413635,-0.5178394317626953,0.2285129725933075,-0.3170968294143677,-0.2246341109275818,0.2833319902420044,-0.5099343657493591,-0.49715498089790344,-0.3493226170539856,0.3292626142501831,0.24636048078536987,0.7207037210464478,0.16913318634033203,-0.6909018754959106,0.06924944370985031,0.4800015687942505,-0.2168654501438141,0.5917078852653503,0.23160593211650848,0.537395715713501,0.7937036752700806,0.17396502196788788,-0.3983372151851654,0.8670725226402283,-0.21596691012382507,0.7286391854286194,0.338647723197937,-0.541279137134552,-0.24414321780204773,0.7341932058334351,0.4927745461463928,-0.7745022177696228,0.8004167079925537,-0.6826944947242737,0.13118436932563782,-0.19548332691192627,0.07437360286712646,-0.5719180703163147,0.24923273921012878,-0.5927393436431885,0.8679149150848389,0.5983684062957764,-0.027823010459542274,0.7718298435211182,-0.4654153287410736,-1.3462893962860107,0.7995166182518005,-0.011185641400516033,-0.4824565351009369,0.5111072063446045,-0.44001948833465576,-0.3706497848033905,-0.5190173983573914,0.32828569412231445,-0.08511803299188614,-0.2909694015979767,0.6947621703147888,-0.48054996132850647,0.9403616786003113,0.9104567766189575,-0.3861950635910034,0.12150025367736816,-1.0906805992126465,-0.4025906026363373,0.9348596930503845,-1.0202574729919434,0.20373153686523438,-0.523996114730835,0.053802911192178726,0.24222053587436676,0.3762281537055969,-0.5176705121994019,-0.20220249891281128,0.03934430330991745,0.09392368793487549,0.7321622967720032,-0.14787785708904266,0.09097499400377274,-1.0559947490692139,0.48921504616737366,0.05759872868657112,0.8594281077384949,0.7001445293426514,-0.5685751438140869,-1.088683009147644,-0.6474522948265076,0.7292926907539368,0.09484611451625824,-0.13430261611938477,0.5815054774284363,-0.12725986540317535,-0.2390153408050537,-0.5564658641815186,0.03633316978812218,-0.13943913578987122,0.8008201122283936,-0.03932861611247063,-0.592444121837616,-0.28947505354881287,-1.3887320756912231,-0.2919691503047943,0.10906774550676346,-0.16127485036849976,0.4028816521167755,0.18391253054141998,-0.4581294655799866,0.7862441539764404,-0.8642418384552002,-0.8036615252494812,-0.20525407791137695,0.0392296127974987,0.9526417255401611,0.42765557765960693,0.33285951614379883,-0.5506075620651245,-0.6694586873054504,0.07510815560817719,-0.038032107055187225,-0.03092881664633751,-0.04241414740681648,0.1725407838821411,-0.5417670607566833,-0.5349268317222595,-0.5855259299278259,0.5592337250709534,0.4357283115386963,-0.47289806604385376,0.4332028329372406,-0.8731499910354614,0.6391263604164124,-0.5809072256088257,0.13061028718948364,0.1224871352314949,-0.35391929745674133,0.005123510956764221,-0.035462722182273865,-0.3733997642993927,-0.28362974524497986,-0.5538771152496338,0.3602936565876007,-0.6868255138397217,-0.03687463328242302,-0.02161470241844654,-0.01347095426172018,0.33665063977241516,0.17859768867492676,-0.11408817768096924,0.9829856157302856,0.2166203111410141,-0.8720398545265198,0.5416585206985474,0.4413844347000122,-0.45122820138931274,0.6702153086662292,-0.8764693140983582,-0.2828983664512634,-0.3100939989089966,-0.12255239486694336,-1.0492029190063477,-0.8187520503997803,0.24328432977199554,-0.6477587223052979,-0.5662667155265808,0.5299931168556213,-0.16486720740795135,-0.5515258312225342,-0.4993116557598114,0.20804063975811005,0.5959509611129761,-0.5303364992141724,0.33830690383911133,0.6449111104011536,0.15322712063789368,-0.5701629519462585,-0.8095422387123108,0.299686998128891,-0.15813173353672028,-0.42938998341560364,0.01225562859326601,0.2296690195798874,-0.003090759040787816,-0.4748457670211792,-0.6214565634727478,-0.34394094347953796,0.25212395191192627,0.6680505275726318,-0.4346116781234741,0.05700011923909187,-0.5419701337814331,-0.06856900453567505,0.22415021061897278,0.39412787556648254,0.15209266543388367,-0.12497655302286148,-0.14452865719795227,0.10466565191745758,-0.885491669178009,0.16965919733047485,0.3295234143733978,0.5647721886634827,0.6704097390174866,0.3424019515514374,-0.03930060938000679,-0.09012854844331741,-0.4867702126502991,-0.19723494350910187,-0.3999251127243042,-0.12402091920375824,-0.3148922622203827,-0.03522349148988724,0.08981114625930786,-0.5273032784461975,-0.2906345725059509,-0.008796274662017822,0.10828336328268051,-0.5253278017044067,0.32934826612472534,0.1370808184146881,0.40024134516716003,0.15117497742176056,-0.39427340030670166,0.28206363320350647,0.03590822592377663,-0.5984677076339722,-0.7090610861778259,-0.9651968479156494,0.2385367751121521,-0.6296990513801575,0.4865530729293823,-0.3372344374656677,-0.4074413478374481,0.40377700328826904,0.2570020258426666,0.4174588918685913,0.8144797086715698,0.36606156826019287,0.3249886631965637,-0.3144724667072296,-0.13040763139724731,0.11302396655082703,-0.5673134326934814,-0.302737295627594,0.07992523908615112,0.8787054419517517,1.172546148300171,0.4492942988872528,-0.030851297080516815,0.2505459785461426,0.41262075304985046,-0.49564653635025024,0.8719723224639893,0.07523376494646072,-1.1572521924972534,-0.01636483334004879,-0.26380544900894165,-1.4837547540664673,0.5048713088035583,-0.08823634684085846,0.07521479576826096,-0.49488142132759094,0.26249536871910095,-0.6110193729400635,-0.2207442820072174,-0.6484773755073547,1.0147236585617065,-0.44640663266181946,-0.5317413806915283,-0.14681464433670044,-1.1751823425292969,0.23739926517009735,0.7769442796707153,0.5977027416229248,-0.09468377381563187,-0.1947668194770813,0.8031347990036011,-0.27485743165016174,0.3829503059387207,0.008609862998127937,-0.12533974647521973,-0.14479875564575195,0.09938973188400269,0.32281163334846497,0.9557879567146301,0.44236403703689575,-0.3139778673648834,-0.6251403093338013,-0.9560933709144592,-0.026251723989844322,1.0045522451400757,-0.37324783205986023,-1.1330887079238892,-0.7285730242729187,-0.8578240871429443,0.283489465713501,0.3208872675895691,-0.19238921999931335,0.018476346507668495,-0.5433160066604614,0.7849560379981995,0.6621338725090027,-0.04260914772748947,0.5969443321228027,0.44642236828804016,-0.26311758160591125,-0.9876590371131897,0.3932715058326721,-0.15448811650276184,0.13365773856639862,-0.0799962505698204,0.7488629817962646,-0.6475675106048584,-0.009853999130427837,-0.7468257546424866,0.47061026096343994,-0.3518182933330536,-0.18345221877098083,-0.5140756368637085,0.1674567610025406,-0.9340670704841614,-0.025641120970249176,-0.34011444449424744,-0.8153799176216125,-0.26087984442710876,0.3495074212551117,-0.07597187161445618,0.6782748699188232,-0.12641578912734985,1.2685917615890503,-0.8028026819229126,0.5285968780517578,0.5295302271842957,0.3867567479610443,-0.1515539586544037,-1.0572096109390259,-0.49948495626449585,-0.39823028445243835,-0.8323652744293213,-0.9415347576141357,0.6449390053749084,-0.14691118896007538,0.04789162799715996,1.2827277183532715,-0.09551580995321274,0.603675901889801,0.09274474531412125,1.0837756395339966,0.4858129918575287,-0.9330762028694153,0.09257236123085022,-0.6846525073051453,0.6818339824676514,0.4644860029220581,0.8943250179290771,-0.5759118795394897,-0.05204038321971893,-1.039456844329834,-0.7968854308128357,0.25239646434783936,0.4111694395542145,0.0011898776283487678,0.04329173266887665,-0.7683977484703064,0.09674887359142303,0.5332443118095398,-0.8648918271064758,-0.4710420072078705,0.2660006582736969,0.22469790279865265,0.5526612401008606,-0.2161717712879181,-0.48416608572006226,-0.924457848072052,0.5668873190879822,0.4644615948200226,0.016160206869244576,-0.16353924572467804,-0.13962322473526,-0.3175646960735321,0.4352322518825531,0.6779831051826477,0.9168933033943176,-0.7922529578208923,0.5794135332107544,-0.05354280769824982,-0.3465318977832794,0.06871140003204346,-0.2459251582622528,-0.05720151960849762,0.32953858375549316,-0.44721513986587524,0.050602808594703674,0.8087331056594849,-0.5344159603118896,0.305500328540802,-0.18340158462524414,-0.19031253457069397,-0.309244304895401,-0.2884880304336548,0.11887530237436295,0.18470722436904907,0.199752539396286,-0.06084237992763519,0.24666717648506165,-0.26213422417640686,0.49224817752838135,0.48226016759872437,-0.5415734052658081,-0.3253564238548279,1.3615599870681763,0.5222530364990234,-0.32182902097702026,0.46122345328330994,0.24173259735107422,-0.0673547014594078,0.5831491351127625,1.2432188987731934,0.49218353629112244,-0.5042010545730591,0.7092238664627075,0.06750074774026871,-0.09383261948823929,-0.0081543093547225,0.44860950112342834,-0.1970268189907074,-0.28806084394454956,0.6269216537475586,-0.803895890712738,-0.22598743438720703,0.5601255893707275,-0.3778359591960907,0.2135166972875595,-0.7522717118263245,-0.779211163520813,0.1779584139585495,-0.11637934297323227,-0.5567536354064941,0.4780929386615753,0.07993963360786438,1.180921196937561,-1.0012739896774292,1.0854748487472534,1.2030161619186401,-0.39551323652267456,-0.3470480144023895,-0.5964025259017944,-0.003305548569187522,-0.5828757882118225,0.6706764698028564,-0.07850617915391922,0.16851960122585297,-0.20571738481521606,-0.268282413482666,-0.7996156215667725,0.33568376302719116,-0.12711429595947266,-0.25941455364227295,-0.015434486791491508,0.42356789112091064,-0.13292774558067322,0.0037969565019011497,-0.18581432104110718,0.9464324116706848,0.8409354090690613,0.4372020363807678,-0.6313837170600891,-0.055603086948394775,0.09673861414194107,0.3239489793777466,-0.06169762834906578,-0.7502389550209045,0.7076743245124817,-0.45781442523002625,-0.16617447137832642,0.38411039113998413,1.180161476135254,0.21009182929992676,0.11365732550621033,0.5472085475921631,1.1442530155181885,0.2281898409128189,0.2820669710636139,0.9721088409423828,0.5765435099601746,0.4725164771080017,0.8732017874717712,-0.15962526202201843,-0.06697147339582443,0.9765822291374207,-0.6608487963676453,0.43563368916511536,0.46180063486099243,0.11050009727478027,0.5212056636810303,0.6355578899383545,-0.280332088470459,0.11997316777706146,-0.800595760345459,-0.287690669298172,0.43648675084114075,0.026447953656315804,-0.4591667354106903,-0.9742065072059631,-0.11056825518608093,0.07913459837436676,0.3082919120788574,0.22297149896621704,0.4662155508995056,0.24451857805252075,-0.3344615399837494,0.6512241363525391,0.04811880365014076,-0.011844181455671787,-0.10874098539352417,-0.20612436532974243,-0.27597931027412415,0.6450008749961853,0.038915444165468216,-0.8701965808868408,0.19781824946403503,-0.5256267189979553,-0.1740768998861313,-0.16985800862312317,0.12679293751716614,-0.4636904299259186,-0.16456031799316406,-0.21601201593875885,0.27244970202445984,0.41580191254615784,0.47157996892929077,-1.0791044235229492,0.27602824568748474,-0.12321404367685318,-0.1431848406791687,-0.016102466732263565,-0.11164054274559021,0.3355039954185486,0.7526078820228577,0.3873237371444702,0.43889203667640686,0.020581483840942383,0.0665377601981163,0.7098839282989502,-1.2233948707580566,-0.8678389191627502,-0.30513134598731995,0.3215208649635315,-0.3935432434082031,-0.5412213206291199,1.115997314453125,0.9920573830604553,0.914484977722168,-0.9107837677001953,0.017293615266680717,-0.2077222615480423,0.2669888138771057,0.22706453502178192,0.649146318435669,-0.4583829343318939,-0.22682905197143555,0.2800329625606537,-1.0090821981430054,-0.362485408782959,0.4176114797592163,0.1970158964395523,-0.38053134083747864,0.5054555535316467,0.6325038075447083,-0.4901634752750397,0.21487581729888916,0.31514257192611694,0.20230068266391754,-0.10582146048545837,0.22879809141159058,0.8290401101112366,-0.5272077918052673,-0.1003471314907074,-0.4193391501903534,-0.3952881693840027,-0.5583227872848511,-0.6888096332550049,-0.0452975295484066,-0.13799642026424408,-0.62837815284729,-0.4729372262954712,-0.14849378168582916,1.0821017026901245,0.9769520163536072,-1.0336458683013916,-0.852587878704071,0.9743750691413879,0.370536208152771,-0.6756088137626648,-0.23825114965438843,-0.1673172116279602,-0.07628379762172699,-0.5976764559745789,0.7753019332885742,0.6446144580841064,0.5124966502189636,0.31413015723228455,-0.00003639691567514092,-0.8735217452049255,0.5028191208839417,0.49051231145858765,0.2277340292930603,-0.6177209615707397,-0.30641138553619385,-0.605127215385437,-0.2127356231212616,0.28962069749832153,0.7604162096977234,-0.3130319118499756,-0.11445695906877518,0.4159240424633026,0.6234878301620483,0.2780379056930542,0.5945948958396912,0.37354910373687744,-1.0610800981521606,0.521527111530304,0.31822124123573303,0.33180931210517883,-0.10160930454730988,-0.513020396232605,0.570996105670929,0.47622430324554443,-0.8863240480422974,-0.44037914276123047,-0.3269352912902832,-1.8785266876220703,-0.6457673907279968,0.8876060247421265,-0.08890876173973083,-1.0130339860916138,-0.2681725323200226,-0.025494800880551338,0.30071747303009033,-0.7092866897583008,0.8538867831230164,-0.08444361388683319,0.1759151965379715,-0.0645117536187172,-0.6093289852142334,0.3150272071361542,0.6975864768028259,-0.7012813687324524,-0.22271794080734253,0.649813711643219,0.5986615419387817,-0.08681211620569229,0.04726758971810341,-0.36053359508514404,0.36199748516082764,-0.09300746023654938,-0.1462542563676834,-0.13827596604824066,-0.6411302089691162,0.06707187741994858,0.31476008892059326,0.3629421889781952,-1.0855286121368408]\r\n```\r\n\r\nMy command is \r\n```\r\nneo4j-admin database import full --nodes=datasets/bulk/t/ff_sr_fndds_food_portions_header.csv,datasets/bulk/t/ff_sr_fndds_food_portions.csv --relationships=datasets/bulk/t/ff_sr_fndds_food_portions_relations_header.csv,datasets/bulk/t/ff_sr_fndds_food_portions_relations.csv\r\n```\r\n\r\nIt fails with the following error\r\n```\r\norg.neo4j.internal.batchimport.input.HeaderException: Unable to parse header, unknown property type &#39;LIST&lt;FLOAT&gt;&#39;\r\n\tat org.neo4j.internal.batchimport.input.csv.DataFactories.parsePropertyType(DataFactories.java:483)\r\n\tat org.neo4j.internal.batchimport.input.csv.DataFactories$AbstractDefaultFileHeaderParser.propertyExtractor(DataFactories.java:280)\r\n\tat org.neo4j.internal.batchimport.input.csv.DataFactories$DefaultNodeFileHeaderParser.create(DataFactories.java:410)\r\n\tat org.neo4j.internal.batchimport.input.csv.DataFactories.parseHeaderEntries(DataFactories.java:196)\r\n\tat org.neo4j.internal.batchimport.input.csv.DataFactories$AbstractDefaultFileHeaderParser.create(DataFactories.java:221)\r\n\tat org.neo4j.internal.batchimport.input.csv.CsvInput.verifyHeaders(CsvInput.java:164)\r\n\tat org.neo4j.internal.batchimport.input.csv.CsvInput.&lt;init&gt;(CsvInput.java:145)\r\n\tat org.neo4j.internal.batchimport.input.csv.CsvInput.&lt;init&gt;(CsvInput.java:108)\r\n\tat org.neo4j.importer.CsvImporter.doImport(CsvImporter.java:175)\r\n\tat org.neo4j.importer.ImportCommand$Base.doExecute(ImportCommand.java:431)\r\n\tat org.neo4j.importer.ImportCommand$Full.execute(ImportCommand.java:590)\r\n\tat org.neo4j.cli.AbstractCommand.call(AbstractCommand.java:92)\r\n\tat org.neo4j.cli.AbstractCommand.call(AbstractCommand.java:37)\r\n\tat picocli.CommandLine.executeUserObject(CommandLine.java:2041)\r\n\tat picocli.CommandLine.access$1500(CommandLine.java:148)\r\n\tat picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2461)\r\n\tat picocli.CommandLine$RunLast.handle(CommandLine.java:2453)\r\n\tat picocli.CommandLine$RunLast.handle(CommandLine.java:2415)\r\n\tat picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:2273)\r\n\tat picocli.CommandLine$RunLast.execute(CommandLine.java:2417)\r\n\tat picocli.CommandLine.execute(CommandLine.java:2170)\r\n\tat org.neo4j.cli.AdminTool.execute(AdminTool.java:94)\r\n\tat org.neo4j.cli.AdminTool.main(AdminTool.java:82)\r\nCaused by: java.lang.IllegalArgumentException: &#39;LIST&lt;FLOAT&gt;&#39;\r\n\tat org.neo4j.csv.reader.Extractors.valueOf(Extractors.java:199)\r\n\tat org.neo4j.internal.batchimport.input.csv.DataFactories.parsePropertyType(DataFactories.java:481)\r\n\t... 22 more\r\nroot@51d13ae3cbf2:/var/lib/neo4j/import# \r\n```\r\n\r\nI am using neo4j in my docker with following version\r\n```\r\nroot@51d13ae3cbf2:/var/lib/neo4j/import# neo4j version\r\nneo4j 5.13.0\r\n```\r\n\r\nIt seems admin command only understand simple types like `STRING`, `INT`, etc. so, how can I fix this issue? ",
            "link": "https://stackoverflow.com/questions/77525633/importing-vector-embedding-in-neo4j-via-neo4j-admin-import-is-failing-with-unkno",
            "title": "Importing Vector Embedding in Neo4J via neo4j-admin import is failing with unknown property type &#39;LIST&lt;FLOAT&gt;&#39;"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 33099,
                        "reputation": 29846,
                        "user_id": 92359,
                        "user_type": "registered",
                        "accept_rate": 94,
                        "profile_image": "https://www.gravatar.com/avatar/664d3d4c50c731d90a32db5f9e01b4b9?s=256&d=identicon&r=PG",
                        "display_name": "InverseFalcon",
                        "link": "https://stackoverflow.com/users/92359/inversefalcon"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1700599333,
                    "answer_id": 77525820,
                    "question_id": 77524947,
                    "body_markdown": "You could try a query like this:\r\n\r\n```\r\nMATCH (n:Resource)\r\nWHERE EXISTS {\r\n    MATCH (n)-[*0..1]-&gt;(x)\r\n    WHERE (x:Resource OR x:Tag)\r\n    AND any(prop IN [&#39;name&#39;, &#39;description&#39;, &#39;legal_name&#39;, &#39;organization_type&#39;, &#39;tag&#39;] WHERE x[prop] CONTAINS &#39;school&#39;)\r\n}\r\n\r\nWITH n, [(n)-[]-&gt;(m) | m] as resources\r\nRETURN n, resources;\r\n```\r\n\r\nThis uses an EXISTS {} subquery to say that you&#39;re looking for a node (that could be the same node, or could be a connected node) that is a :Resource or :Tag node that has any of the given properties with the property value contains &#39;school&#39;.\r\n\r\nFor the resulting nodes that pass that filter, THEN you can match out to and collect the connected nodes (though in this case I&#39;m using a pattern comprehension to do so, which will be more efficient).\r\n\r\nEDIT: Fixed up the grouping of the AND and OR operators, that should ensure the any() list predicate must always be considered.",
                    "title": "[Neo4j][Cypher Query] Filter On Node or Relationship Node Properties and Then Return All Nodes and Their Relationship Nodes"
                },
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1700774191,
                    "answer_id": 77539656,
                    "question_id": 77524947,
                    "body_markdown": "The `Tags` look a lot like labels. Their one property, `tag`,  could just as easily be the label identifier. With the tags as labels, the predicates can be simplified like so:\r\n```sql\r\nWITH [&#39;name&#39;, &#39;description&#39;, &#39;legal&#39;, &#39;organization_type&#39;] AS props\r\nMATCH (n:Resource)--&gt;(m) \r\nWHERE n:School OR any(prop IN props WHERE m[prop] CONTAINS &#39;school&#39;)\r\nRETURN n, collect(m);\r\n```",
                    "title": "[Neo4j][Cypher Query] Filter On Node or Relationship Node Properties and Then Return All Nodes and Their Relationship Nodes"
                }
            ],
            "owner": {
                "account_id": 8667309,
                "reputation": 13,
                "user_id": 6487302,
                "user_type": "registered",
                "profile_image": "https://graph.facebook.com/10110994760169374/picture?type=large",
                "display_name": "Daniel Kohli",
                "link": "https://stackoverflow.com/users/6487302/daniel-kohli"
            },
            "is_answered": true,
            "view_count": 54,
            "favorite_count": 0,
            "accepted_answer_id": 77525820,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1700589233,
            "question_id": 77524947,
            "body_markdown": "I&#39;ve got a Neo4j DB that contains `Resource` nodes with several relationship nodes including `Tag`, `Address`, `PhoneNumber`, etc.\r\n\r\nThe schema for `Resource` is as follows:\r\n```\r\nResource: {\r\n  name: str,\r\n  description: str,\r\n  legal_name: str,\r\n  organization_type: str,\r\n}\r\n```\r\n\r\nThe schema for `Tag` is as follows:\r\n```\r\nTag: {\r\n  tag: str,\r\n}\r\n```\r\n\r\nI&#39;m building a query that returns all `Resource` nodes along with their relationship nodes where the `Resource` node has a property that contains a specific string AND/OR related `Tag` node(s) has(ve) a property that contains the same string.\r\n\r\nExample cases to return:\r\n1. A `Resource` node DOES have one or more property that contains the string &quot;school&quot; but all related `Tag` nodes DO NOT have a `tag` property containing the string &quot;school&quot;: the `Resource` node is returned along with all of its relationship nodes\r\n2. A `Resource` node DOES NOT have any properties that contain the string &quot;school&quot; but has at least one related `Tag` node that DOES have a `tag` property containing the string &quot;school&quot;: the `Resource` node is returned along with all of its relationship nodes\r\n3. A `Resource` node DOES have one or more property that contains the string &quot;school&quot; and has at least one related `Tag` node that DOES have a `tag` property containing the string &quot;school&quot;: the `Resource` node is returned along with all of its relationship nodes\r\n\r\n  I&#39;m currently using the below query and it works for the most part; however, for case 2 above no other relationship nodes of the originating `Resource` node are returned in the result set.  Ideally, we would ALWAYS get all relationship nodes of the `Resource` node matching the above criteria.  Any help would be greatly appreciated!\r\n\r\n```\r\nMATCH (n:Resource)-[]-&gt;(m) \r\nWHERE n.name CONTAINS &#39;school&#39;\r\n    OR n.description CONTAINS &#39;school&#39;\r\n    OR n.legal_name CONTAINS &#39;school&#39;\r\n    OR n.organization_type CONTAINS &#39;school&#39;\r\n    OR m.tag CONTAINS &#39;school&#39;\r\nRETURN n, collect(m);\r\n```",
            "link": "https://stackoverflow.com/questions/77524947/neo4jcypher-query-filter-on-node-or-relationship-node-properties-and-then-re",
            "title": "[Neo4j][Cypher Query] Filter On Node or Relationship Node Properties and Then Return All Nodes and Their Relationship Nodes"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 5007043,
                        "reputation": 672,
                        "user_id": 4024409,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/-4JS5nVp4cYs/AAAAAAAAAAI/AAAAAAAAAAA/9dswBlPXPdw/photo.jpg?sz=256",
                        "display_name": "Vincent Rupp",
                        "link": "https://stackoverflow.com/users/4024409/vincent-rupp"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1701792720,
                    "answer_id": 77607672,
                    "question_id": 77522450,
                    "body_markdown": "One thing I see is that you have a long pattern, and within that pattern you have a condition that uses a property of a node in that pattern.\r\n\r\nThat is, you match on t1 and require `{movOre: t1.nutel}`, and the same thing again when you use a REBIX relationship property to filter on `t2: Tel`\r\n\r\nThis means every t1 has to be found, and every value of `t1.nuTel` used in the pattern. If you have 1000 Tel nodes, you have 1000 nuTel properties. Basically, the possibilities for nuTel and movBene are exploding.\r\n\r\nYou might refactor to split this into multiple MATCH statements:\r\n\r\n```\r\nMATCH (t1:Tel {TB:true})\r\nWITH distinct t1.nuTel as t1nuTel\r\nMATCH (t1:Tel {TB:true, nulTel:t1nuTel})&lt;-[:TelBIZ]-(:ACC {TB:true})-[or:REBIZ {movOre: t1nuTel}]-&gt;(:ACC {TB:true})-&gt;(t2:Tel {TB:true, nuTel: or.movBene})\r\nWHERE t1.nuTel &lt;&gt; t2.nuTel\r\nRETURN t1, t2, count(or) as Ope, sum(or.imp) as Total, 10^3 as Precision, max(or.Txt) as mRB\r\n```\r\n\r\nThat may not be the best solution for your graph, and there&#39;s still the issue with `or.movBene` being used as a filter when it&#39;s part of a pattern, but hopefully I&#39;ve communicated the idea and you can refine from there.\r\n\r\nAlso, indexes on nuTel, movBene, and TB will be incredibly faster, if you don&#39;t haver them already.",
                    "title": "Optimization of a MATCH statement"
                }
            ],
            "owner": {
                "account_id": 29810119,
                "reputation": 11,
                "user_id": 22845737,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocKNKzG4ZG21RjKJZ87NmjljaKskSXrI6x6i6Z3c2cr241k=k-s256",
                "display_name": "Somnath Deb",
                "link": "https://stackoverflow.com/users/22845737/somnath-deb"
            },
            "is_answered": false,
            "view_count": 48,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700566122,
            "question_id": 77522450,
            "body_markdown": "```\r\nMATCH (t1:Tel {TB:true})&lt;-[:TelBIZ]-\r\n  (:ACC {TB:true})-[or:REBIZ {movOre:t1.nuTel}]-&gt;\r\n  (:ACC {TB:true})-[:TelBIZ]-&gt;(t2:Tel {TB:true,nuTel:or.movBene}) \r\nWHERE t1.nuTel&lt;&gt;t2.nuTel\r\nRETURN t1, t2, COUNT(or) AS Ope, SUM(or.imp) AS Total, \r\n  10^3 as Precision, max(or.Txt) AS mRB\r\n```\r\n\r\nI am trying to get this query to return few values, but I find the query is not optimised and returns a lot of data. Please suggest me how I can optimize it. I am using Neo4j v3.5.",
            "link": "https://stackoverflow.com/questions/77522450/optimization-of-a-match-statement",
            "title": "Optimization of a MATCH statement"
        },
        {
            "tags": [
                "java",
                "spring",
                "spring-boot",
                "neo4j",
                "spring-data-neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1261634,
                        "reputation": 24551,
                        "user_id": 1219755,
                        "user_type": "registered",
                        "accept_rate": 84,
                        "profile_image": "https://i.stack.imgur.com/UmjNt.jpg?s=256&g=1",
                        "display_name": "alexanoid",
                        "link": "https://stackoverflow.com/users/1219755/alexanoid"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1700955753,
                    "answer_id": 77549953,
                    "question_id": 77520005,
                    "body_markdown": "I&#39;m not sure if I&#39;m doing it right, but I&#39;ve encountered this problem myself and haven&#39;t found a better solution than simply creating a new object of the class I need and populating it with values that I extract from the `InternalNode`.\r\n\r\nFor example:\r\n\r\n    InternalNode internalNode = (InternalNode) weightedCriteriaArrayElement.get(&quot;criterion&quot;);\r\n    \r\n    Criterion criterion = new Criterion(); // my entity class\r\n    Map&lt;String, Object&gt; nodeProperties = new HashMap&lt;&gt;(internalNode.asMap());\r\n    BeanUtils.populate(criterion, nodeProperties);\r\n    criterion.setGraphId(internalNode.id());",
                    "title": "Spring data Neo4j can&#39;t convert InternalNode back to entity class when retrieving paths"
                }
            ],
            "owner": {
                "account_id": 18625023,
                "reputation": 27,
                "user_id": 13574344,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhGuIzJ2-1xF-utmOJhucA_rPsejZT_BlTMM9K7=k-s256",
                "display_name": "stackoverflow_user",
                "link": "https://stackoverflow.com/users/13574344/stackoverflow-user"
            },
            "is_answered": false,
            "view_count": 56,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1700534522,
            "question_id": 77520005,
            "body_markdown": "I&#39;m using Neo4jClient to do the following query for retrieving nodes and relationships by paths.\r\n```\r\n    public Collection&lt;Map&lt;String, Object&gt;&gt; findBookByUniqueIds(List&lt;String&gt; srcUniqueIds, String name) {\r\n\r\n        return neo4jClient.query(\r\n                        &quot;&quot;&quot;\r\n                                MATCH path = (src:Book)-[*1..2]-(target:Book)\r\n                                WHERE src.uniqueId IN $uniqueIds\r\n                                AND toUpper(target.name) = toUpper($name)\r\n                                RETURN nodes(path) AS nodes, relationships(path) AS relations\r\n                                &quot;&quot;&quot;)\r\n                .bind(srcUniqueIds).to(&quot;uniqueIds&quot;)\r\n                .bind(name).to(&quot;name&quot;)\r\n                .fetch().all();\r\n    }\r\n```\r\n\r\nAnd I extract the data like this:\r\n```\r\nCollection&lt;Map&lt;String, Object&gt;&gt; result = findBookByUniqueIds(ids, name);\r\nList&lt;Object&gt; nodes = (List&lt;Object&gt;) result.get(&quot;nodes&quot;);\r\nList&lt;Object&gt; relationships = (List&lt;Object&gt;) result.get(&quot;relations&quot;);\r\n```\r\n\r\nWhen I was trying to cask the node back to entity class:\r\n```\r\nif (nodes.size() == 2) {\r\n    Book book1 = (Book) nodes.get(0);\r\n    Book book2 = (Book) nodes.get(1);\r\n} else if (nodes.size() == 3) {\r\n    Book book1 = (Book) nodes.get(0);\r\n    Author author = (Author) nodes.get(1);\r\n    Book book2 = (Book) nodes.get(2);\r\n}\r\n```\r\nAnd I got the exception `java.lang.ClassCastException: class org.neo4j.driver.internal.InternalNode cannot be cast to class xxx`\r\n\r\nAny idea on how to convert the node back to entity class?\r\n\r\nThanks",
            "link": "https://stackoverflow.com/questions/77520005/spring-data-neo4j-cant-convert-internalnode-back-to-entity-class-when-retrievin",
            "title": "Spring data Neo4j can&#39;t convert InternalNode back to entity class when retrieving paths"
        },
        {
            "tags": [
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 5567614,
                        "reputation": 773,
                        "user_id": 4414246,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "profile_image": "https://i.stack.imgur.com/HDcLp.jpg?s=256&g=1",
                        "display_name": "David A Stumpf",
                        "link": "https://stackoverflow.com/users/4414246/david-a-stumpf"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1700586406,
                    "answer_id": 77524665,
                    "question_id": 77514862,
                    "body_markdown": "You could try this ...\r\n\r\n    MATCH (n:YourNodeLabel)\r\n    RETURN apoc.convert.toHex(n.yourByteArrayProperty) AS hexValue\r\n\r\nI&#39;ve created a  [hex-ORDPATH][1] in a Neo4j user defined function (UDF). That code might help if you want to write a custom UDF. \r\n\r\n\r\n  [1]: https://github.com/waigitdas/Neo4j-Genealogy-PlugIns/blob/main/java%20classes/graph/ordpath.java",
                    "title": "Display byte array as hex string in Neo4j Browser"
                }
            ],
            "owner": {
                "account_id": 1612911,
                "reputation": 3570,
                "user_id": 1491378,
                "user_type": "registered",
                "accept_rate": 88,
                "profile_image": "https://www.gravatar.com/avatar/ac8b182351a52912a793fcf193d0b02b?s=256&d=identicon&r=PG",
                "display_name": "Hett",
                "link": "https://stackoverflow.com/users/1491378/hett"
            },
            "is_answered": false,
            "view_count": 20,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700473840,
            "question_id": 77514862,
            "body_markdown": "Is it possible to show data in hex format if I stored data as byte array using Neo4j Browser?\r\nIt is 16 bytes of md5 sum.\r\n",
            "link": "https://stackoverflow.com/questions/77514862/display-byte-array-as-hex-string-in-neo4j-browser",
            "title": "Display byte array as hex string in Neo4j Browser"
        },
        {
            "tags": [
                "neo4j",
                "neo4j-parallel-runtime"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 2108938,
                        "reputation": 2372,
                        "user_id": 1874594,
                        "user_type": "registered",
                        "accept_rate": 69,
                        "profile_image": "https://i.stack.imgur.com/vS7Eu.jpg?s=256&g=1",
                        "display_name": "user1874594",
                        "link": "https://stackoverflow.com/users/1874594/user1874594"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1701329442,
                    "answer_id": 77576603,
                    "question_id": 77509091,
                    "body_markdown": " Due the the Parallel nature of `Neo4j` these situations stem  as reasons for what you experienced. \r\n\r\n - Results may not be deterministic, as different threads may finish at different times - use the `ORDER BY` clause \r\n - `PARALLEL runtime` does not support updating queries, such as those using the `CREATE, MERGE, SET, DELETE, or REMOVE` - updating the graph in parallel may cause conflicts or inconsistencies to use  the same to  read  ,use `:begin` and `:commit` commands in `Cypher Shell` to control the transactions or another runtime, such as `SLOTTED or PIPELINED`, for the write queries.\r\n - Also it does not support reading data that has been modified in the same transaction, as this may cause `concurrency` issues or `stale reads` aka you cannot use the `apoc.cypher.mapParallel2` procedure to read data that you have updated in the same transaction  - use another procedure, such as `apoc.cypher.doIt`, or split  transaction into two parts. \r\n\r\nFor situational restrictions  so mentioned , I doubt if they have plans to update. ",
                    "title": "Neo4j PARALLEL runtime query returns different result"
                }
            ],
            "owner": {
                "account_id": 1261634,
                "reputation": 24551,
                "user_id": 1219755,
                "user_type": "registered",
                "accept_rate": 84,
                "profile_image": "https://i.stack.imgur.com/UmjNt.jpg?s=256&g=1",
                "display_name": "alexanoid",
                "link": "https://stackoverflow.com/users/1219755/alexanoid"
            },
            "is_answered": true,
            "view_count": 126,
            "favorite_count": 0,
            "accepted_answer_id": 77576603,
            "answer_count": 1,
            "score": 2,
            "creation_date": 1700350923,
            "question_id": 77509091,
            "body_markdown": "I&#39;m testing the new Neo4j PARALLEL runtime and am unable to pass my tests because my queries return different results (different elements order) compared to SLOTTED or PIPELINED. Do I need to somehow refine these queries so that they work properly on PARALLEL runtime? Do you have any docs on this? Or, are these refinements unnecessary, and the queries should return exactly the same result as on SLOTTED or PIPELINED?\r\n\r\nAlso, there is a limitation `It is not possible to use the parallel runtime if a change has been made to the state of a transaction.` https://neo4j.com/docs/cypher-manual/current/planning-and-tuning/runtimes/reference/\r\n\r\nUnfortunately, I have many scenarios where I currently use `apoc.cypher.mapParallel2` to read data in the same transaction where I&#39;m updating it. I would like to transition to the PARALLEL runtime, but I am unable to do so due to this limitation. Are you planning to overcome this limitation in the future?",
            "link": "https://stackoverflow.com/questions/77509091/neo4j-parallel-runtime-query-returns-different-result",
            "title": "Neo4j PARALLEL runtime query returns different result"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1575719,
                        "reputation": 19504,
                        "user_id": 2662355,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/6ea0a9d988f145b0e666dfdd96374736?s=256&d=identicon&r=PG",
                        "display_name": "Christophe Willemsen",
                        "link": "https://stackoverflow.com/users/2662355/christophe-willemsen"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1700341881,
                    "answer_id": 77508731,
                    "question_id": 77508656,
                    "body_markdown": "You&#39;re looking for the `ANY` predicate\r\n\r\n```\r\nMATCH p =(mFirst:MoveNode)-[:NEXT_MOVE*${patternLength - 1}]-&gt;(:MoveNode)\r\nWHERE ANY(\r\n  x IN $patterns \r\n  WHERE ( mFirst.move = head(x) AND [m IN nodes(p) | m.move] = x )\r\n)\r\n```",
                    "title": "Practical Way of Doing Equality Against Multiple Possible Values in Cypher"
                }
            ],
            "owner": {
                "account_id": 3348911,
                "reputation": 6259,
                "user_id": 4756173,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0e50f7e8bb3963d1dc749e278c3d8d33?s=256&d=identicon&r=PG",
                "display_name": "Philippe Fanaro",
                "link": "https://stackoverflow.com/users/4756173/philippe-fanaro"
            },
            "is_answered": true,
            "view_count": 23,
            "favorite_count": 0,
            "accepted_answer_id": 77508731,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700340432,
            "question_id": 77508656,
            "body_markdown": "&gt; This question follows up on [@cybersam&#39;s answer to one of my previous questions](https://stackoverflow.com/a/77499034/4756173), however no previous knowledge about this problem is necessary.\r\n\r\nIn a pattern-search query, a simplified version of [@cybersam&#39;s query here](https://stackoverflow.com/a/77499034/4756173), I would like to, ideally, match paths not only to an input pattern but to all of its isomorphisms (board rotations and reflections) and permutations.\r\n\r\n&gt; A pattern in this case is a list of strings (A-Z) of length 2, e.g. `[&#39;pq&#39;, &#39;dd&#39;, &#39;pp&#39;]`.\r\n\r\nSo, in that query, I would have to create an `OR` statement for each pattern in a pattern list:\r\n\r\n```cypher\r\nMATCH p =   (mFirst:MoveNode)\r\n           -[:NEXT_MOVE*${patternLength - 1}]\r\n          -&gt;(:MoveNode)\r\n\r\nWHERE (\r\n            mFirst.move = HEAD($patterns[0]) \r\n        AND [m IN NODES(p) | m.move] = $patterns[0]\r\n      )\r\n   OR (\r\n            mFirst.move = HEAD($patterns[1]) \r\n        AND [m IN NODES(p) | m.move] = $patterns[1]\r\n      )\r\n   OR (...)\r\n   .\r\n   .\r\n   .\r\n```\r\n\r\nIs there a way of making this programmatic? Cause, this isn&#39;t scalable, since I don&#39;t know how many permutations I&#39;m gonna end up having. ",
            "link": "https://stackoverflow.com/questions/77508656/practical-way-of-doing-equality-against-multiple-possible-values-in-cypher",
            "title": "Practical Way of Doing Equality Against Multiple Possible Values in Cypher"
        },
        {
            "tags": [
                "neo4j",
                "parallel-processing",
                "gpu",
                "neo4j-parallel-runtime"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 28282947,
                        "reputation": 86,
                        "user_id": 21624328,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxZzl1uvGNT2Zj90oWIgnDozeOoiJzA7-rJgem4f=k-s256",
                        "display_name": "Christoffer Bergman",
                        "link": "https://stackoverflow.com/users/21624328/christoffer-bergman"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1700230936,
                    "answer_id": 77502358,
                    "question_id": 77501923,
                    "body_markdown": "The Parallel Runtime is a very powerful mechanism for certain queries to parallelise the processing of a single query (though parallel processing isn&#39;t new when you have multiple parallel queries).\r\n\r\nHowever, GPU&#39;s are not supported by the parallel runtime and it is not really foreseen either.",
                    "title": "Neo4j parallel runtime and GPU"
                }
            ],
            "owner": {
                "account_id": 1261634,
                "reputation": 24551,
                "user_id": 1219755,
                "user_type": "registered",
                "accept_rate": 84,
                "profile_image": "https://i.stack.imgur.com/UmjNt.jpg?s=256&g=1",
                "display_name": "alexanoid",
                "link": "https://stackoverflow.com/users/1219755/alexanoid"
            },
            "is_answered": true,
            "view_count": 62,
            "favorite_count": 0,
            "accepted_answer_id": 77502358,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700226655,
            "question_id": 77501923,
            "body_markdown": "Looks like Neo4j is naturally stepping into the world of parallel processing with the brand new parallel runtime in version 5.13.0.\r\n\r\nThus, I have a question: Is it possible with Neo4j to utilize GPU power for parallel processing instead of the CPU? If not, do you have plans to support it?",
            "link": "https://stackoverflow.com/questions/77501923/neo4j-parallel-runtime-and-gpu",
            "title": "Neo4j parallel runtime and GPU"
        },
        {
            "tags": [
                "recursion",
                "graph",
                "neo4j",
                "tree",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1700167612,
                    "answer_id": 77497956,
                    "question_id": 77497411,
                    "body_markdown": "To get the path `p` from the root `GameNode` up to and including the sequence of moves `[&#39;rm&#39;,&#39;ro&#39;]`, you can write the following in Neo4j 5.9+:\r\n```sql\r\nMATCH p = (g:GameNode)-[:NEXT_MOVE]-&gt;+(m1:MoveNode)-[:NEXT_MOVE]-&gt;(m2:MoveNode)\r\nWHERE m1.move = &#39;rm&#39; AND m2.move = &#39;ro&#39;\r\nRETURN p\r\n```\r\nTo get the whole path, up to the last move in the sequence, you need to add a check that there are no further moves:\r\n```sql\r\nMATCH p = (g:GameNode)-[:NEXT_MOVE]-&gt;+(m1:MoveNode)-[:NEXT_MOVE]-&gt;\r\n  (m2:MoveNode)-[:NEXT_MOVE]-&gt;*(lastMove:MoveNode)\r\nWHERE m1.move = &#39;rm&#39; AND m2.move = &#39;ro&#39;\r\n  AND NOT EXISTS { (lastMove)-[:NEXT_MOVE]-&gt;(:MoveNode) }\r\nRETURN p\r\n```\r\nIt would be surprising if there were performance issues: specific enough patterns over small graphs representing each game should not be slow. ",
                    "title": "How to (Efficiently) Find Subpaths in Recursive Trees through Cypher (Graph vs Regex)"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1700187843,
                    "answer_id": 77499034,
                    "question_id": 77497411,
                    "body_markdown": "The query below should be fairly performant in returning the moves in every game that contains the desired sequence of moves. It assumes you:\r\n- Have an [index](https://neo4j.com/docs/cypher-manual/current/indexes-for-search-performance/) on `MoveNode.move`,\r\n- Pass the list of desired moves in the `$moves` [parameter](),\r\n- Adjust the length of the variable-length relationship in the first `MATCH` to be 1 less than the length of `$moves`. For example, if `$moves` has 2 items, use `*1` instead of `*2`. *This is admittedly ugly, but Cypher does not support dynamic bounds.*\r\n\r\n#### Query\r\n\r\n    MATCH p1=(m1:MoveNode)-[:NEXT_MOVE*2]-&gt;(m2)\r\n    WHERE m1.move = HEAD($moves) AND [m IN TAIL(NODES(p1)) | m.move] = TAIL($moves)\r\n    MATCH p2 = (m2)-[:NEXT_MOVE*0..]-&gt;(end) WHERE NOT (end)-[:NEXT_MOVE]-&gt;()\r\n    MATCH p3 = (g:GameNode)-[:NEXT_MOVE*]-&gt;(m1)\r\n    RETURN [a IN NODES(p3)[1..-1] | a.move] + $moves + [b IN NODES(p2)[1..] | b.move]\r\n\r\nThe index is used to limit and anchor the search by quickly finding the `m1` nodes (the `MoveNode`s matching the first item in `$moves`), instead of wading through all paths from every `GameNode`. Then the query:\r\n- Filters `m1` by requiring that it is followed by a subpath satisfying the rest of the `$moves` list,\r\n- Finds the sequence of moves that follow each subpath,\r\n- Works backwards from the surviving `m1` nodes to find the corresponding `GameNode`s.\r\n- Constructs and returns the sequence of moves for each matching game.\r\n\r\nSo, this query starts off by using the index to find the first set of relevant nodes, and keeps adding relationships (and end nodes) to what was already found until it finally has the desired results. There is never a need to scan through irrelevant data.",
                    "title": "How to (Efficiently) Find Subpaths in Recursive Trees through Cypher (Graph vs Regex)"
                }
            ],
            "owner": {
                "account_id": 3348911,
                "reputation": 6259,
                "user_id": 4756173,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0e50f7e8bb3963d1dc749e278c3d8d33?s=256&d=identicon&r=PG",
                "display_name": "Philippe Fanaro",
                "link": "https://stackoverflow.com/users/4756173/philippe-fanaro"
            },
            "is_answered": true,
            "view_count": 77,
            "favorite_count": 0,
            "accepted_answer_id": 77499034,
            "answer_count": 2,
            "score": 1,
            "creation_date": 1700161233,
            "question_id": 77497411,
            "body_markdown": "I&#39;m trying to reproduce a Go SGF game tree in Neo4j through Cypher so I can pattern-search through, as a graph. This is the shape of a Go game tree &amp;mdash; based on [Sabaki&#39;s SGF Parser](https://github.com/SabakiHQ/sgf) &amp;mdash;:\r\n\r\n```typescript\r\ntype GameTree = {\r\n  id: number;\r\n  data: { [key: string]: string[] };\r\n  parentId: number | null;\r\n  children: GameTree[];\r\n};\r\n```\r\n\r\n&gt; You can find a reproducible sample of the problem [in this commit](https://github.com/psygo/go_pattern_search/tree/01a11ff85b85e226b2f222aa4743e87842649651).\r\n\r\nSo far, I&#39;ve successfully managed to model it just like it appears in a Go editor&#39;s game tree:\r\n\r\n[![Game Tree on Neo4j Desktop][1]][1]\r\n\r\n&gt; `B` and `W` mean Black and White moves. `AB` and `AW` are &quot;added black or white stones&quot;, for when editing the board position. For this question&#39;s purposes, only `move` matters actually, which has the same value as either `B` or `W`. Board coordinates are given in 2 letters, e.g. column `m` and row `r` gives out the string `&#39;rm&#39;`.\r\n\r\nNow, what I would like to do is return the full path (probably the root node would suffice actually) from the root if a specified subpath (no skipping) is found. So far, I have this, which does work:\r\n\r\n```cypher\r\nMATCH p=(g:GameNode)-[:NEXT_MOVE*]-&gt;()\r\n\r\nWITH g, p,\r\n     [m in TAIL(NODES(p)) | m.move] AS moves\r\n\r\nWITH g, p,\r\n     REDUCE(path = &#39;&#39;, move in moves | path + move) AS joined_moves\r\n\r\nWHERE joined_moves CONTAINS &quot;rmro&quot;\r\n\r\nRETURN g, p, joined_moves\r\n```\r\n\r\nFollowing @cybersam&#39;s answer, I think this could make it more explicit to Neo4j so it uses an index on `m.move` &amp;mdash; e.g. `CREATE INDEX move_node_move_idx FOR (m:MoveNode) ON (m.move)` &amp;mdash;:\r\n\r\n```cypher\r\nMATCH p=(g:GameNode)-[:NEXT_MOVE*]-&gt;(m1:MoveNode)-[:NEXT_MOVE*]-&gt;()\r\n\r\nWHERE m1.move = HEAD([&#39;rm&#39;, &#39;ro&#39;])\r\n\r\nWITH g, p,\r\n     [m in TAIL(NODES(p)) | m.move] AS moves\r\n\r\nWITH g, p,\r\n     REDUCE(path = &#39;&#39;, move in moves | path + move) AS joined_moves\r\n\r\nWHERE joined_moves CONTAINS &quot;rmro&quot;\r\n\r\nRETURN g, p, joined_moves\r\n```\r\n\r\nBut I really don&#39;t know if this type of pattern-search would be efficient enough through Neo4j or other graph databases. I think it could be since, even though most games have 200+ move branches, there aren&#39;t that many of them usually. And the analysis would be on unidirectional branches where order matters (no skipping), so it should probably limit the search space even more.\r\n\r\nAlternatively, I&#39;m considering placing a string with the full path to it in each move node. This way I could use Regexes (I know Regexes can also be modeled as graphs) instead of path searches. That said, if it works, then I think using a SQL database would be probably enough. However, I would probably stick to Neo4j still, cause modeling this as a graph could provide more useful features in the future.\r\n\r\n---\r\n\r\n## References\r\n\r\n- [Stack Overflow - *Neo4j how to match subpath*](https://stackoverflow.com/a/51872011/4756173)\r\n- [Stack Overlflow - *Efficient way of matching a subtree, using cypher in Neo4J?*](https://stackoverflow.com/a/31587455/4756173)\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/XMF1g.png",
            "link": "https://stackoverflow.com/questions/77497411/how-to-efficiently-find-subpaths-in-recursive-trees-through-cypher-graph-vs-r",
            "title": "How to (Efficiently) Find Subpaths in Recursive Trees through Cypher (Graph vs Regex)"
        },
        {
            "tags": [
                "recursion",
                "graph",
                "neo4j",
                "tree",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1700145204,
                    "answer_id": 77495682,
                    "question_id": 77495108,
                    "body_markdown": "If each query execution is for a single chain of moves that are in order of play, and the parent `GameNode` already exists, then you can use the following:\r\n```sql\r\nUNWIND $moveNodes AS move\r\nCALL {\r\n    WITH move\r\n    MATCH (parent:GameNode|MoveNode {game_id: $gameId, id: move.parentId})\r\n    CREATE (parent)-[:NEXT_MOVE]-&gt;(m:MoveNode {game_id: $gameId, id: move.id})\r\n}\r\n```",
                    "title": "How to Recursively Create a Tree with Cypher (Neo4j)"
                }
            ],
            "owner": {
                "account_id": 3348911,
                "reputation": 6259,
                "user_id": 4756173,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0e50f7e8bb3963d1dc749e278c3d8d33?s=256&d=identicon&r=PG",
                "display_name": "Philippe Fanaro",
                "link": "https://stackoverflow.com/users/4756173/philippe-fanaro"
            },
            "is_answered": true,
            "view_count": 49,
            "favorite_count": 0,
            "accepted_answer_id": 77495682,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1700140416,
            "question_id": 77495108,
            "body_markdown": "I&#39;m trying to replicate an SGF game tree on Neo4j with Cypher. The tree is of this shape:\r\n\r\n```typescript\r\ntype GameTree = {\r\n  id: number;\r\n  data: { [key: string]: string[] };\r\n  parentId: number | null;\r\n  children: GameTree[];\r\n};\r\n```\r\n\r\nThis is the creation query I&#39;m trying to work out:\r\n\r\n```cypher\r\nUNWIND $moves AS move\r\n\r\nMATCH (parent)\r\n\r\nWHERE ((parent:GameNode) OR (parent:MoveNode))\r\n  AND parent.game_id = $gameId\r\n  AND parent.id = move.parentId\r\n\r\nCREATE   (parent)\r\n        -[:NEXT_MOVE]\r\n       -&gt;(:MoveNode{\r\n           game_id: $gameId,\r\n           id:      move.id\r\n         })\r\n```\r\n\r\nInitially, the root of the tree is a `GameNode`, which I create separately, because it holds interesting metadata. Anyways, this won&#39;t work like this because, at the time of the `UNWIND` and `MATCH` clauses, there exists only one parent, the rest of them will/should be created recursively.\r\n\r\nIs there a way of doing this recursive creation in Cypher? Maybe there&#39;s some recursive keyword I can&#39;t seem to find (this seems like such a common kind of problem...)? Maybe there&#39;s a useful APOC procedure somewhere?\r\n\r\nAs a workaround, I&#39;m thinking about creating all the `MoveNode`s first, and then using the query above to string them back together. It would look like this:\r\n\r\n```cypher\r\n// 1. Create All The Move Nodes\r\n\r\nUNWIND $moveNodes AS move\r\n\r\nCREATE (:MoveNode{\r\n         game_id: move.game_id,\r\n         id:      move.id\r\n       })\r\n\r\n// 2. Tie them to their Parents\r\n\r\nWITH move\r\n\r\nMATCH (parent{\r\n        game_id: move.game_id,\r\n        id:      move.parentId\r\n      }),\r\n      (m:MoveNode{\r\n        game_id: move.game_id,\r\n        id:      move.id\r\n      })\r\n\r\nWHERE parent:GameNode\r\n   OR parent:MoveNode\r\n  \r\nCREATE (parent)-[:NEXT_MOVE]-&gt;(m)\r\n```",
            "link": "https://stackoverflow.com/questions/77495108/how-to-recursively-create-a-tree-with-cypher-neo4j",
            "title": "How to Recursively Create a Tree with Cypher (Neo4j)"
        },
        {
            "tags": [
                "apache-spark",
                "pyspark",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 2378509,
                        "reputation": 648,
                        "user_id": 2081152,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/bkxUP.jpg?s=256&g=1",
                        "display_name": "mamonu",
                        "link": "https://stackoverflow.com/users/2081152/mamonu"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1700121618,
                    "answer_id": 77493083,
                    "question_id": 77492233,
                    "body_markdown": "It is certainly possible.\r\nAre you aware of the [Neo4j Spark connector][1]?\r\n\r\n    df.write \\\r\n      .format(&quot;org.neo4j.spark.DataSource&quot;) \\\r\n      .mode(&quot;ErrorIfExists&quot;) \\\r\n      .option(&quot;url&quot;, &quot;bolt://localhost:7687&quot;) \\\r\n      .option(&quot;labels&quot;, &quot;:Person&quot;) \\\r\n      .save()\r\n\r\nAbove is an example on the command on how you can save from Spark to Neo4j. In this case it saves &quot;:Person&quot; nodes.\r\n\r\n\r\nOf course you will need to create your dataframe in such a format that it makes sense as graph data. \r\n\r\nProbably something like Source,Destination,Weight or something like that. \r\nOr as nodes like the code above.\r\n\r\nWithout knowing the schema of your data I cant help any more I am afraid.\r\n\r\n\r\n  [1]: https://neo4j.com/docs/spark/current/python/",
                    "title": "Connect APIs, Parse the result using pyspark and store it in neo4j"
                }
            ],
            "owner": {
                "account_id": 27756855,
                "reputation": 11,
                "user_id": 21190101,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AEdFTp6orUGtT7C_T_fu4tOKasCjkqum7ElZkcw5mezr=k-s256",
                "display_name": "Sathyamoorthy",
                "link": "https://stackoverflow.com/users/21190101/sathyamoorthy"
            },
            "is_answered": true,
            "view_count": 28,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700107404,
            "question_id": 77492233,
            "body_markdown": "My Requirement is straight forward. I have a API call which retrieves huge amount of data. I want to use PySpark to convert those as Dataframes and write into Neo4J. \r\n\r\nConvert the API result into Dataframes and store it in Neo4j, Could you please let me know if that&#39;s possible?",
            "link": "https://stackoverflow.com/questions/77492233/connect-apis-parse-the-result-using-pyspark-and-store-it-in-neo4j",
            "title": "Connect APIs, Parse the result using pyspark and store it in neo4j"
        },
        {
            "tags": [
                "python",
                "neo4j",
                "langchain"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1700120349,
                    "answer_id": 77492979,
                    "question_id": 77492026,
                    "body_markdown": "With respect to the `KeyError: &#39;input_variables&#39;` error: as [documented](https://python.langchain.com/docs/modules/model_io/prompts/prompt_templates/), the `PromptTemplate` parameter for input variables is named `input_variables`. So you need to change your `variables` parameter name to `input_variables`.\r\n\r\n*And, yes, the error message should be much better worded.*",
                    "title": "Query GPT4All local model with Langchain and many .txt files - KeyError: &#39;input_variables&#39;"
                }
            ],
            "owner": {
                "account_id": 13877281,
                "reputation": 1143,
                "user_id": 10018602,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/d3e1f50ec8a4db6643a06cbef195b494?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "wildcat89",
                "link": "https://stackoverflow.com/users/10018602/wildcat89"
            },
            "is_answered": true,
            "view_count": 250,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700103114,
            "question_id": 77492026,
            "body_markdown": "`python 3.8, Windows 10, neo4j==5.14.1, langchain==0.0.336`\r\n\r\nI&#39;m attempting to utilize a local Langchain model (GPT4All) to assist me in converting a corpus of loaded `.txt` files into a `neo4j` data structure through querying. I have provided a minimal reproducible example code below, along with the references to the article/repo that I&#39;m attempting to emulate. I have also provided a &quot;context&quot; that should be included in the query, along with all the `Document` objects. I&#39;m still learning how to use `Langchain` so I really don&#39;t know what I&#39;m doing yet, but the current traceback I&#39;m getting looks like this:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File &quot;.\\neo4jmain.py&quot;, line xx, in &lt;module&gt;\r\n    prompt_template = PromptTemplate(\r\n  File &quot;C:\\Users\\chalu\\AppData\\Local\\Programs\\Python\\Python38\\lib\\site-packages\\langchain\\load\\serializable.py&quot;, line 97, in __init__\r\n    super().__init__(**kwargs)\r\n  File &quot;pydantic\\main.py&quot;, line 339, in pydantic.main.BaseModel.__init__\r\n  File &quot;pydantic\\main.py&quot;, line 1102, in pydantic.main.validate_model\r\n  File &quot;C:\\Users\\chalu\\AppData\\Local\\Programs\\Python\\Python38\\lib\\site-packages\\langchain\\schema\\prompt_template.py&quot;, line 76, in validate_variable_names\r\n    if &quot;stop&quot; in values[&quot;input_variables&quot;]:\r\nKeyError: &#39;input_variables&#39;\r\n```\r\n\r\nAs you&#39;ll see, I&#39;m literally not defining `input_variables` anywhere, so I assume this is a default behaviour of Langchain, but again, not sure. I was also getting an error:\r\n\r\n```\r\nLLaMA ERROR: The prompt is 5161 tokens and the context window is 2048!\r\nERROR: The prompt size exceeds the context window size and cannot be processed.\r\n```\r\n\r\n...which is clearly a result of the query string itself being too big. I want to be able to query my documents for the answer, while providing the model with the Documents to reference. How can I do this? The Langchain documentation is not great for noobies in this space, it&#39;s all over the place and lacks MANY, SIMPLE use cases for noobies so I&#39;m asking it here.\r\n\r\n```\r\n# https://medium.com/neo4j/enhanced-qa-integrating-unstructured-and-graph-knowledge-using-neo4j-and-langchain-6abf6fc24c27\r\n# https://github.com/sauravjoshi23/ai/blob/main/retrieval%20augmented%20generation/integrated-qa-neo4j-langchain.ipynb\r\n\r\n# Script to convert a corpus of many text files into a neo4j graph\r\n\r\n# Imports\r\nimport os\r\nfrom langchain.document_loaders import TextLoader\r\nfrom langchain.text_splitter import RecursiveCharacterTextSplitter\r\nfrom langchain.llms.gpt4all import GPT4All\r\nfrom langchain.prompts import PromptTemplate\r\nfrom transformers import AutoTokenizer\r\n\r\n# Load tokenizer\r\ntokenizer = AutoTokenizer.from_pretrained(&quot;bert-base-uncased&quot;)\r\n\r\ndef bert_len(text):\r\n    &quot;&quot;&quot;Return the length of a text in BERT tokens.&quot;&quot;&quot;\r\n    tokens = tokenizer.encode(text)\r\n    return len(tokens)\r\n\r\ndef get_files(path: str) -&gt; list:\r\n    &quot;&quot;&quot;Return a list of all files in a directory, recursively.&quot;&quot;&quot;\r\n    files = []\r\n    for file in os.listdir(path):\r\n        file_path = os.path.join(path, file)\r\n        if os.path.isdir(file_path):\r\n            files.extend(get_files(file_path))\r\n        else:\r\n            files.append(file_path)\r\n    return files\r\n\r\n# Get the text files\r\nall_txt_files = get_files(&#39;data&#39;)\r\nraw_txt_files = []\r\nfor current_file in all_txt_files:\r\n    raw_txt_files.extend(TextLoader(current_file, encoding=&#39;utf-8&#39;).load())\r\n\r\n# Create a text splitter object that will help us split the text into chunks\r\ntext_splitter = RecursiveCharacterTextSplitter(\r\n    chunk_size = 1024, # 200,\r\n    chunk_overlap = 128, # 20\r\n    length_function = bert_len,\r\n    separators=[&#39;\\n\\n&#39;, &#39;\\n&#39;, &#39; &#39;, &#39;&#39;],\r\n)\r\n\r\n# Split the text into &quot;documents&quot;\r\ndocuments = text_splitter.create_documents([raw_txt_files[0].page_content])\r\n\r\n# Utilizing these Document objects, we want to query the GPT4All model to help us create\r\n# a JSON object that contains the ontology of terms mentioned in the given context,\r\n# while mitigating &quot;max_tokens&quot; error.\r\n# Create a PromptTemplate object that will help us create the prompt for GPT4All(?)\r\nprompt_template = PromptTemplate(\r\n    template = &quot;&quot;&quot;\r\n    You are a network graph maker who extracts terms and their relations from a given context.\r\n    You are provided with a context chunk (delimited by ```). Your task is to extract the ontology\r\n    of terms mentioned in the given context. These terms should represent the key concepts as per the context.\r\n    \r\n    Thought 1: While traversing through each sentence, Think about the key terms mentioned in it.\r\n        Terms may include object, entity, location, organization, person,\r\n        condition, acronym, documents, service, concept, etc.\r\n        Terms should be as atomistic as possible\r\n    \r\n    Thought 2: Think about how these terms can have one on one relation with other terms.\r\n        Terms that are mentioned in the same sentence or the same paragraph are typically related to each other.\r\n        Terms can be related to many other terms\r\n        \r\n    Thought 3: Find out the relation between each such related pair of terms.\r\n\r\n    Format your output as a list of json. Each element of the list contains\r\n    a pair of terms and the relation between them, like the following:\r\n    [Dict(&quot;node_1&quot;: &quot;A concept from extracted ontology&quot;,\r\n            &quot;node_2&quot;: &quot;A related concept from extracted ontology&quot;,\r\n            &quot;edge&quot;: &quot;relationship between the two concepts, node_1 and node_2 in one or two sentences&quot;,\r\n        ),\r\n    Dict(&quot;node_1&quot;: &quot;A concept from extracted ontology&quot;,\r\n        &quot;node_2&quot;: &quot;A related concept from extracted ontology&quot;,\r\n        &quot;edge&quot;: &quot;relationship between the two concepts, node_1 and node_2 in one or two sentences&quot;,\r\n    ),\r\n    Dict(...)]\r\n    Context Documents: {documents}\r\n    &quot;&quot;&quot;,\r\n    variables = {\r\n        &quot;documents&quot;: documents,\r\n    }\r\n)\r\n\r\n# Create a GPT4All object that will help us query the GPT4All model\r\nllm = GPT4All(\r\n    model=r&quot;C:\\Users\\chalu\\AppData\\Local\\nomic.ai\\GPT4All\\gpt4all-falcon-q4_0.gguf&quot;,\r\n    n_threads=3,\r\n    max_tokens=5162, # &lt;-- attempt to mitigate &quot;max_tokens&quot; error\r\n    verbose=True,\r\n)\r\n\r\n# Get the response from GPT-4-All\r\nresponse = llm(prompt_template)\r\nprint(response)\r\n```",
            "link": "https://stackoverflow.com/questions/77492026/query-gpt4all-local-model-with-langchain-and-many-txt-files-keyerror-input",
            "title": "Query GPT4All local model with Langchain and many .txt files - KeyError: &#39;input_variables&#39;"
        },
        {
            "tags": [
                "spring",
                "spring-boot",
                "neo4j",
                "spring-data",
                "spring-data-neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 3133300,
                        "reputation": 7957,
                        "user_id": 2650436,
                        "user_type": "registered",
                        "accept_rate": 80,
                        "profile_image": "https://www.gravatar.com/avatar/34ecacd077244d141a23c46ea094df5c?s=256&d=identicon&r=PG",
                        "display_name": "meistermeier",
                        "link": "https://stackoverflow.com/users/2650436/meistermeier"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1700225652,
                    "answer_id": 77501827,
                    "question_id": 77490723,
                    "body_markdown": "You could modify your mapping code to\r\n```\r\nMapValue nodePair = (MapValue) record.get(&quot;nodePair&quot;);\r\nvar src = mappingFunction.apply(typeSystem, nodePair.get(&quot;src&quot;));\r\nif (!nodePair.get(&quot;target&quot;).isNull()) {\r\n\tvar target = mappingFunction.apply(typeSystem, nodePair.get(&quot;target&quot;));\r\n\treturn new NodePair(src, target);\r\n}\r\nreturn new NodePair(src, null);\r\n```\r\nand check the `null` value that the driver returns in this case.\r\n\r\n(Also answered this at https://github.com/spring-projects/spring-data-neo4j/issues/2821 but wanted to be sure that the answer can be discovered also here by others having the same problem)",
                    "title": "Spring data neo4j client throws exception when there&#39;s no match in database"
                }
            ],
            "owner": {
                "account_id": 18625023,
                "reputation": 27,
                "user_id": 13574344,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GhGuIzJ2-1xF-utmOJhucA_rPsejZT_BlTMM9K7=k-s256",
                "display_name": "stackoverflow_user",
                "link": "https://stackoverflow.com/users/13574344/stackoverflow-user"
            },
            "is_answered": false,
            "view_count": 48,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1700080341,
            "question_id": 77490723,
            "body_markdown": "I&#39;m using Neo4jClient to do the query since my source and target node have the same label.\r\n\r\nFollowing is how I do the query\r\n\r\n```\r\n@Repository\r\npublic class Neo4jClientRepository {\r\n    @Autowired\r\n    private Neo4jMappingContext neo4jMappingContext;\r\n\r\n    @Autowired\r\n    private Neo4jClient neo4jClient;\r\n\r\n    public Collection&lt;NodePair&gt; findNodesByUniqueIds(List&lt;String&gt; srcUniqueIds, String nodeName) {\r\n        BiFunction&lt;TypeSystem, MapAccessor, Node&gt; mappingFunction = neo4jMappingContext.getRequiredMappingFunctionFor(Node.class);\r\n\r\n        return neo4jClient.query(\r\n                        &quot;&quot;&quot;\r\n                                MATCH (src:Node)\r\n                                WHERE src.uniqueId IN $uniqueIds\r\n                                OPTIONAL MATCH (src:Node)-[*1..2]-(target:Node)\r\n                                WHERE toUpper(target.name) = toUpper($name)\r\n                                RETURN {src: src, target: target} AS nodePair\r\n                                &quot;&quot;&quot;)\r\n                .bind(srcUniqueIds).to(&quot;uniqueIds&quot;)\r\n                .bind(nodeName).to(&quot;name&quot;)\r\n                .fetchAs(NodePair.class)\r\n                .mappedBy((typeSystem, record) -&gt; {\r\n                        MapValue nodePair = (MapValue) record.get(&quot;nodePair&quot;);\r\n                        var src = mappingFunction.apply(typeSystem, nodePair.get(&quot;src&quot;));\r\n                        var target = mappingFunction.apply(typeSystem, nodePair.get(&quot;target&quot;));\r\n                    return new NodePair(src, target);\r\n                })\r\n                .all();\r\n    }\r\n}\r\n```\r\nThe function works fine when there&#39;s a match in the database.\r\n\r\nHowever, for some business cases, the above query doesn&#39;t necessarily have a match, meaning it will return empty results based on different inputs. When there&#39;s no match, the following exception will be thrown\r\n```\r\norg.springframework.dao.InvalidDataAccessApiUsageException: NULL is not iterable; Error code &#39;N/A&#39;\r\n\tat org.springframework.data.neo4j.core.Neo4jPersistenceExceptionTranslator.translateImpl(Neo4jPersistenceExceptionTranslator.java:107)\r\n\tat org.springframework.data.neo4j.core.Neo4jPersistenceExceptionTranslator.translateExceptionIfPossible(Neo4jPersistenceExceptionTranslator.java:81)\r\n\tat org.springframework.data.neo4j.core.DefaultNeo4jClient.potentiallyConvertRuntimeException(DefaultNeo4jClient.java:230)\r\n\tat org.springframework.data.neo4j.core.DefaultNeo4jClient$DefaultRecordFetchSpec.all(DefaultNeo4jClient.java:488)\r\n```\r\n\r\nIs there a way to do a null check before the result being mapped to entity class? Or how could I avoid this kind of situation?\r\n\r\nThanks",
            "link": "https://stackoverflow.com/questions/77490723/spring-data-neo4j-client-throws-exception-when-theres-no-match-in-database",
            "title": "Spring data neo4j client throws exception when there&#39;s no match in database"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1575719,
                        "reputation": 19504,
                        "user_id": 2662355,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/6ea0a9d988f145b0e666dfdd96374736?s=256&d=identicon&r=PG",
                        "display_name": "Christophe Willemsen",
                        "link": "https://stackoverflow.com/users/2662355/christophe-willemsen"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1700079732,
                    "answer_id": 77490681,
                    "question_id": 77484411,
                    "body_markdown": "It is achievable with the following query ( added comments )\r\n\r\n```cypher\r\n// simulate your input\r\nWITH &quot;a.b.c.d&quot; AS pkg \r\n// split on the dot, producing an array \r\nWITH split(pkg, &quot;.&quot;) AS parts [&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;]\r\n// iterating of the array\r\nUNWIND parts AS part \r\n// MERGE (match or create) the module with the name as id ( up to you which property to use )\r\nMERGE (m:Module {id: part}) \r\n// break and introduce a variable being an array of the nodes created or matched\r\nWITH collect(m) AS modules \r\n// use APOC to link those nodes together with the NEXT relationship\r\nCALL apoc.nodes.link(modules,&#39;NEXT&#39;) \r\n```\r\n\r\nIt produces such graph\r\n\r\n[![enter image description here][1]][1]\r\n\r\nLater on, if you try to do the same with module paths that do already exist, it will do nothing, for eg after the above, the following query will not create anything\r\n\r\n```\r\nWITH &quot;a.b.c&quot; AS pkg\r\nWITH split(pkg, &quot;.&quot;) AS parts\r\nUNWIND parts AS part\r\nMERGE (m:Module {id: part})\r\nWITH collect(m) AS modules\r\nCALL apoc.nodes.link(modules,&#39;NEXT&#39;)\r\n```\r\n\r\n[![enter image description here][2]][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/gVSf0.png\r\n  [2]: https://i.stack.imgur.com/G7VIG.png",
                    "title": "Create all nonexistent nodes and edges if path doesn&#39;t exist"
                },
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1700092735,
                    "answer_id": 77491575,
                    "question_id": 77484411,
                    "body_markdown": "You can use a pure Cypher approach with the following:\r\n```\r\nFOREACH (i IN range(0, size($module_path) - 2) | \r\n           MERGE (l:Module {name: $module_path[i]})\r\n           MERGE (r:Module {name: $module_path[i+1]})          \r\n           MERGE (l)-[:contains]-&gt;(r) );\r\n```\r\nYou can test how this works with the data in your question:\r\n```\r\nUNWIND [[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;],[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;e&#39;],[&#39;a&#39;],[&#39;a&#39;,&#39;b&#39;,&#39;c&#39;],\r\n        [&#39;a&#39;,&#39;b&#39;]] AS modules\r\nFOREACH (i IN range(0, size(modules) - 2) | \r\n            MERGE (l:Module {name: modules[i]})\r\n            MERGE (r:Module {name: modules[i+1]})          \r\n            MERGE (l)-[:contains]-&gt;(r) )\r\n```\r\nHere is the result:\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/T7cEA.png",
                    "title": "Create all nonexistent nodes and edges if path doesn&#39;t exist"
                }
            ],
            "owner": {
                "account_id": 266740,
                "reputation": 1895,
                "user_id": 554481,
                "user_type": "registered",
                "accept_rate": 43,
                "profile_image": "https://i.stack.imgur.com/G0s1w.jpg?s=256&g=1",
                "display_name": "user554481",
                "link": "https://stackoverflow.com/users/554481/user554481"
            },
            "is_answered": true,
            "view_count": 49,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 1,
            "creation_date": 1700004397,
            "question_id": 77484411,
            "body_markdown": "I want to represent the modules of a Python package as nodes in a neo4j graph. I get inputs like the following and have to update the graph if the module hasn&#39;t already been included. Let&#39;s say my inputs look like this:\r\n\r\n```\r\na.b.c.d\r\na.b.c.e\r\na\r\na.b.c\r\na.b\r\n```\r\n\r\nIf `a.b.c` already exists, I don&#39;t want to recreate those nodes when I encounter `a.b.c.d`. I would only want to make a new node called `d` and connect it to `c`. Likewise if I get `a.b.c` and none of those nodes exist yet, then I want to create all of the nodes and connect them accordingly. My real inputs can have an arbitrary number of nodes per path, so I&#39;d like a Cypher query that can handle arbitrary path lengths.\r\n\r\nI&#39;m new to Cypher. Here was my first attempt.\r\n\r\n```cypher\r\nMERGE p=(module:Module {name: $module_name})\r\nWITH p, module\r\nMATCH (package:Module)-[:contains*]-&gt;(module)\r\nWHERE [x in nodes(p) | x.name] = $module_path\r\n```\r\n\r\nHowever, Cypher gives me the following error:\r\n\r\n&gt; Query cannot conclude with MATCH\r\n\r\nI also tried this:\r\n```\r\nMERGE p=(:Module)-[:contains*]-&gt;(:Module)\r\nWHERE [x in nodes(p) | x.name] = $module_path\r\n```\r\n\r\nBut then Cypher complains about the presence of `WHERE`.\r\n\r\nNote that I&#39;m using the neo4j Python library to run this query, and I pass in parameters like this: `{&quot;module_path&quot;:[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;], &quot;module_name&quot;:&quot;c&quot;}`. I&#39;m happy to parameterize my query differently if there is a better way, but I don&#39;t think that is the source of my errors.\r\n\r\nI&#39;m using neo4j `5.12`, community edition.",
            "link": "https://stackoverflow.com/questions/77484411/create-all-nonexistent-nodes-and-edges-if-path-doesnt-exist",
            "title": "Create all nonexistent nodes and edges if path doesn&#39;t exist"
        },
        {
            "tags": [
                "if-statement",
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1699979124,
                    "answer_id": 77482258,
                    "question_id": 77482002,
                    "body_markdown": "It looks like you are looking for `WHERE`:\r\n```\r\nMATCH (n:person)&lt;-[r:aetei]-(m:person)\r\nWHERE m.ai &gt;= 2 \r\nRETURN n, m, r\r\n```",
                    "title": "testing value in NEO4j"
                }
            ],
            "owner": {
                "account_id": 8509883,
                "reputation": 13,
                "user_id": 6380243,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/a87ef44332d0aafe624182b1861794ea?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Olivier Caignart",
                "link": "https://stackoverflow.com/users/6380243/olivier-caignart"
            },
            "is_answered": true,
            "view_count": 36,
            "favorite_count": 0,
            "accepted_answer_id": 77482258,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1699976941,
            "question_id": 77482002,
            "body_markdown": "I&#39;m trying to get around IF queries in NEO4J.\r\n\r\nSomething like (if I could use  IF):\r\n\r\n    MATCH (n:person)&lt;-[r:aetei]-(m:person)    \r\n    IF m.ai &gt;= 2\r\n    RETURN n, m, r\r\n\r\nwith `aetei` being a relationship between persons, and `ai` an attribute (obviously).\r\n\r\nI tried some queries with foreach, but without results as I don&#39;t understand what to put after the | and how to get into the return. \r\nI&#39;ve seen some examples with queries in the RETURN ... is that possible ?\r\ngreetings\r\n\r\nI tried several solutions like FOREACH or CASE, but nothing worked. I guess I&#39;m too fresh on NEO4J to really get what &#39;im doing. \r\nShould i install apoc ?",
            "link": "https://stackoverflow.com/questions/77482002/testing-value-in-neo4j",
            "title": "testing value in NEO4j"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "neo4j-apoc"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1699875448,
                    "answer_id": 77473606,
                    "question_id": 77473139,
                    "body_markdown": "If you are inferring the possible properties from the `Person` nodes in the `MATCH`, then you can get the count of non-empty properties with the following:\r\n```sql\r\nMATCH (p:Person)\r\nUNWIND keys(p) AS key\r\nWITH key, CASE WHEN p[key] &lt;&gt; &quot;&quot; THEN 1 ELSE 0 END AS isNonEmpty\r\nRETURN key, sum(isNonEmpty) AS cnt\r\nORDER BY key\r\n```\r\nNote that because Neo4j treats null properties as non-existent, then if none of the nodes returned by the `MATCH` statement has the property, those properties can&#39;t be inferred.\r\n\r\nThe `CASE` can easily be adapted to exclude other property values from the count. For example, to exclude empty lists, you can write:\r\n\r\n```sql\r\nMATCH (p:Person)\r\nUNWIND keys(p) AS key\r\nWITH key, \r\n     CASE p[key]\r\n       WHEN [] THEN 0 \r\n       WHEN &quot;&quot; THEN 0\r\n       WHEN 0 THEN 0\r\n       ELSE 1 \r\n     END AS isNonEmpty\r\nRETURN key, sum(isNonEmpty) AS cnt\r\nORDER BY key\r\n```\r\n\r\nIf you know the properties in advance because, for example, you know the schema, then you could provide them as a list or set of records. For example, if the properties were `&#39;a&#39;` through to `&#39;g&#39;`, you could use the following:\r\n```sql\r\nUNWIND [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;] AS key\r\nMATCH (p)\r\nWITH key, CASE WHEN p[key] &lt;&gt; &quot;&quot; THEN 1 ELSE 0 END AS isNonEmpty\r\nRETURN key, sum(isNonEmpty) AS cnt\r\nORDER BY key\r\n```",
                    "title": "Noe4j : how to get property names with count of non-null or non-empty value for a given node label"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1699899242,
                    "answer_id": 77475985,
                    "question_id": 77473139,
                    "body_markdown": "[UPDATED]\r\n\r\n[Aggregating functions](https://neo4j.com/docs/cypher-manual/current/functions/aggregating/) like `COUNT` already group by non-aggregating expressions like `key`, so `DISTINCT` is not needed. And comparisons to `NULL` are considered `false` by `WHERE`, so an explicit `NULL` test would be redundant.\r\n\r\nHere is a query that uses:\r\n- [ISEMPTY](https://neo4j.com/docs/cypher-manual/current/functions/predicate/#functions-isempty) to detect all &quot;empty&quot; properties (with `&quot;&quot;`, `[]`, or `{}` values).\r\n- [TOINTEGER](https://neo4j.com/docs/cypher-manual/current/functions/scalar/#functions-tointeger) to convert booleans to 1 (for `true`) or 0.\r\n\r\nIt will also return a `0` count for properties that are always empty.\r\n\r\n    MATCH (p:Person)\r\n    UNWIND KEYS(p) AS key\r\n    RETURN key, SUM(TOINTEGER(NOT ISEMPTY(p[key]))) AS cnt \r\n    ORDER BY key\r\n\r\nYou should [PROFILE](https://neo4j.com/docs/cypher-manual/current/planning-and-tuning/query-tuning/#how-do-i-profile-a-query) the queries in the proposed answers to your question see which one uses the fewest DB hits.\r\n\r\nAlso, if it makes sense, you should consider removing all properties that have an empty string value if they should be considered as non-existent. That would allow you to use evern simpler and faster queries.",
                    "title": "Noe4j : how to get property names with count of non-null or non-empty value for a given node label"
                }
            ],
            "owner": {
                "account_id": 19108259,
                "reputation": 13,
                "user_id": 13954862,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GgORuAo4l7z5I7r9heR88ZhXOiM1FSSf-RgTqlJ=k-s256",
                "display_name": "Tony Riddle",
                "link": "https://stackoverflow.com/users/13954862/tony-riddle"
            },
            "is_answered": true,
            "view_count": 72,
            "favorite_count": 0,
            "accepted_answer_id": 77473606,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1699870636,
            "question_id": 77473139,
            "body_markdown": "So there is a requirement of counting the number of occurrences of non null and non empty values of all properties for a given node label.\r\n\r\nFor example, \r\n```\r\nMATCH(p:Person) \r\nWHERE p.name IS NOT NULL and p.name &lt;&gt; &quot;&quot; \r\nRETURN COUNT(p.name);\r\n```\r\n\r\nThis gives me a count for name properties for node label ```Person```\r\nI have to get the count of such other 200 properties for this node label. I am able to get the count of the properties but I am not sure for conditional count like the above. Anything would be helpful as I have just started learning neo4j.\r\n\r\nThe query I am using for all properties count is \r\n```\r\nMATCH(p:Person)\r\nWITH p\r\nUNWIND keys(p) as key\r\nWITH key, COUNT(keys(p)) as cnt\r\nRETURN DISTINCT key, cnt\r\nORDER BY key\r\n```\r\n\r\n\r\nWhat needs to be modified in the query? Or my query is wrong to start with. Thanks in advance.",
            "link": "https://stackoverflow.com/questions/77473139/noe4j-how-to-get-property-names-with-count-of-non-null-or-non-empty-value-for",
            "title": "Noe4j : how to get property names with count of non-null or non-empty value for a given node label"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "query-optimization"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1699901918,
                    "answer_id": 77476221,
                    "question_id": 77471207,
                    "body_markdown": "In `(childDStatCriterionAvgVoteWeight = 0 OR childDStatCriterionAvgVoteWeight &lt;= criterionAvgVoteWeight OR criterionAvgVoteWeight IS NULL)`:\r\n\r\n- You should test `criterionAvgVoteWeight IS NULL` first. That way, if it is `NULL`, then you would not waste time testing with a `NULL` value in the `childDStatCriterionAvgVoteWeight &lt;= criterionAvgVoteWeight` expression (which would be considered `false`), and you would also not need to test `childDStatCriterionAvgVoteWeight = 0`. This could be a big win if the value is frequently `NULL`.\r\n- If `criterionAvgVoteWeight` is always &gt;= 0 (when it is not `NULL`), then the `childDStatCriterionAvgVoteWeight = 0` test can be eliminated completely.\r\n\r\nIn short, you could consider using this expression instead: `(criterionAvgVoteWeight IS NULL OR childDStatCriterionAvgVoteWeight &lt;= criterionAvgVoteWeight)`.\r\n\r\nSimilar considerations apply to `(childDStatCriterionExperienceMonth = 0 OR childDStatCriterionExperienceMonth &lt;= criterionExperienceMonth OR criterionExperienceMonth IS NULL)`.\r\n\r\nThese changes may save some time, depending on your actual data characteristics, but filtering is not free.",
                    "title": "Neo4j Cypher query performnce optimization with WHERE condition"
                }
            ],
            "owner": {
                "account_id": 1261634,
                "reputation": 24551,
                "user_id": 1219755,
                "user_type": "registered",
                "accept_rate": 84,
                "profile_image": "https://i.stack.imgur.com/UmjNt.jpg?s=256&g=1",
                "display_name": "alexanoid",
                "link": "https://stackoverflow.com/users/1219755/alexanoid"
            },
            "is_answered": true,
            "view_count": 49,
            "favorite_count": 0,
            "accepted_answer_id": 77476221,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1699835053,
            "question_id": 77471207,
            "body_markdown": "I have the following Cypher query:\r\n    \r\n    PROFILE\r\n    MATCH (childDStat:JobableStatistic {jobableId: childD.id}) \r\n    WITH collect({`childDStat`:childDStat, `childD`:childD}) as childDStats \r\n    CALL apoc.cypher.mapParallel2(\r\n      &quot; WITH _.childD as childD, _.childDStat as childDStat \r\n        WITH childD, childDStat \r\n        UNWIND childD.detailedCriterionIds as dCId \r\n        WITH childD, childDStat, dCId + coalesce(childDStat[&#39;replaceableCriterionIds.&#39; + dCId],[]) as cGroup \r\n        WITH childD, childDStat, cGroup \r\n        WHERE NOT AlL(x IN cGroup WHERE x IN $zeroCriterionIds ) \r\n        WITH childD, childDStat, collect(cGroup) as cGroups \r\n        WHERE size(cGroups) &gt;= size(childD.detailedCriterionIds) \r\n        UNWIND cGroups as cGroup \r\n        WITH childD, childDStat, cGroup \r\n        WHERE ANY(x IN cGroup WHERE x IN $detailedCriterionIds) \r\n        WITH childD, childDStat, collect(cGroup) as cGroups \r\n        WHERE size(cGroups) &gt; 1 \r\n        RETURN childD, childDStat, cGroups &quot;,\r\n      {`detailedCriterionIds`: [3, 5, 7, 8, 12, 13, 14, 15, 16, 18, 20, 21, 23, 26, 28, 29, 30, 31, 33, 35, 36, 40, 42, 44, 45, 46, 47, 51, 54],\r\n       `zeroCriterionIds`: []},\r\n      childDStats, 6, 10) \r\n    YIELD value\r\n    WITH value.childD as childD, value.childDStat as childDStat, value.cGroups as cGroups WITH collect({`childDStat`:childDStat, `childD`:childD, `cGroups`:cGroups}) as childDStats \r\n    \r\n    CALL apoc.cypher.mapParallel2(\r\n      &quot; WITH _.childD as childD, _.childDStat as childDStat, _.cGroups as cGroups WITH childD, childDStat, size(cGroups) as cGroupsSize, cGroups \r\n        UNWIND cGroups as cGroup \r\n        WITH childD, childDStat, cGroupsSize, cGroup \r\n        UNWIND cGroup as cId WITH childD, childDStat, cGroupsSize, cGroup, cId, cGroup[0] as cG0\r\n    \r\n        WITH childD, childDStat, cGroupsSize, cGroup, cId, cG0, childDStat[&#39;criterionAvgVoteWeights.&#39; + cG0] as childDStatCriterionAvgVoteWeight,\r\n          childDStat[&#39;criterionExperienceMonths.&#39; + cG0] as childDStatCriterionExperienceMonth, \r\n          $criterionAvgVoteWeights[toString(cId)] as criterionAvgVoteWeight, $criterionExperienceMonths[toString(cId)] as criterionExperienceMonth \r\n        WHERE \r\n          (childDStatCriterionAvgVoteWeight = 0 OR childDStatCriterionAvgVoteWeight &lt;= criterionAvgVoteWeight OR criterionAvgVoteWeight IS NULL) AND\r\n          (childDStatCriterionExperienceMonth = 0 OR childDStatCriterionExperienceMonth &lt;= criterionExperienceMonth OR criterionExperienceMonth IS NULL)\r\n    \r\n        WITH childD, childDStat, cGroupsSize, cG0, collect(cId) as cIds WITH childD, childDStat, cGroupsSize, collect(DISTINCT cG0 + cIds) as cGroups\r\n        WHERE size(cGroups) &gt;= cGroupsSize\r\n        RETURN childD, childDStat, cGroups &quot;,\r\n      {`detailedCriterionIds`: [3, 5, 7, 8, 12, 13, 14, 15, 16, 18, 20, 21, 23, 26, 28, 29, 30, 31, 33, 35, 36, 40, 42, 44, 45, 46, 47, 51, 54],\r\n       `zeroCriterionIds`: [],\r\n       `criterionAvgVoteWeights`: {`51`:5.0, `8`:0.0, `33`:5.0, `21`:0.0, `31`:0.0, `26`:4.0, `14`:5.0, `36`:3.0, `46`:3.0, `12`:3.0, `18`:5.0, `28`:5.0, `16`:2.0, `7`:5.0, `40`:1.0, `5`:5.0, `44`:4.0, `3`:1.0, `54`:4.0, `20`:4.0, `42`:4.0, `30`:3.0, `15`:4.0, `47`:1.0, `35`:1.0, `13`:3.0, `45`:3.0, `23`:4.0, `29`:1.0},\r\n       `criterionExperienceMonths`: {`8`:109, `33`:8, `21`:184, `31`:14, `26`:100, `14`:157, `36`:140, `46`:123, `12`:85, `18`:96, `28`:116, `16`:15, `7`:63, `40`:56, `5`:166, `44`:101, `3`:129, `42`:84, `20`:102, `30`:173, `15`:97, `47`:54, `13`:91, `35`:137, `45`:119, `23`:162, `29`:97}\r\n      },\r\n      childDStats, 6, 10) \r\n    YIELD value\r\n    RETURN value.childD.id\r\nThe following condition takes most of the query execution time:\r\n\r\n    WHERE \r\n      (childDStatCriterionAvgVoteWeight = 0 OR childDStatCriterionAvgVoteWeight &lt;= criterionAvgVoteWeight OR criterionAvgVoteWeight IS NULL) AND\r\n      (childDStatCriterionExperienceMonth = 0 OR childDStatCriterionExperienceMonth &lt;= criterionExperienceMonth OR criterionExperienceMonth IS NULL)\r\n\r\nWith this condition in place the query works `~1000ms`, without it `5ms`.\r\n\r\nIs there something I may do with this condition in order to improve the query performance?\r\n\r\nP.S\r\n\r\nThis is just a test query. The real query uses parameters for each single value.",
            "link": "https://stackoverflow.com/questions/77471207/neo4j-cypher-query-performnce-optimization-with-where-condition",
            "title": "Neo4j Cypher query performnce optimization with WHERE condition"
        },
        {
            "tags": [
                "neo4j",
                "neo4j-apoc"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1699472690,
                    "answer_id": 77448519,
                    "question_id": 77447334,
                    "body_markdown": "There are several issues with both of your queries.\r\n\r\nFor example, `REL_VIRTUAL2` is just a temporary variable name, not a relationship type. `COAUTHORS_WITH_VIRTUAL2` is the relationship type you should have used in the projection. However, changing that would still not fix things because **GDS does not support projecting virtual nodes or relationships**.\r\n\r\nYour first approach should work, but you may need to solve some other issues first. For example, the projection should use `[&#39;node1&#39;, &#39;node2&#39;]` instead of just `&#39;node1&#39;` for the node labels,. And you can replace `ON CREATE SET x = y ON MATCH SET x = y` with just `SET x = y`.",
                    "title": "Neo4j: use in a projection a virtual relationship with weights"
                }
            ],
            "owner": {
                "account_id": 17023739,
                "reputation": 119,
                "user_id": 12315558,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBQ0YNNO09fBkzc1bbLAl2u-EgnX1xEHdAW7n5N=k-s256",
                "display_name": "albertovpd",
                "link": "https://stackoverflow.com/users/12315558/albertovpd"
            },
            "is_answered": true,
            "view_count": 28,
            "favorite_count": 0,
            "accepted_answer_id": 77448519,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1699461025,
            "question_id": 77447334,
            "body_markdown": "I can create a relationship in my graph, assign weights and write in disk as follows:\r\n\r\n```\r\nMATCH (a1:node1)-[rel1]-(p:other_node)-[rel2]-(a2:node2)\r\n// create the weight\r\nwith a1.id as id1, a2.id as id2, count(p) as common_ocurrences\r\n// create the rel\r\nMERGE (a1)-[r:NEW_REL]-(a2)\r\n// use the weights as a property of the created relationship\r\nON CREATE SET r.counter = common_occurrences\r\nON MATCH SET r.counter = common_occurrences\r\n\r\n// create projection \r\nCALL gds.graph.project(\r\n &#39;new-graph&#39;,\r\n &#39;node1&#39;,\r\n {NEW_REL:{\r\n orientation:&#39;UNDIRECTED&#39;,\r\n properties:&#39;counter&#39;\r\n }\r\n }\r\n)\r\nyield *\r\n```\r\n\r\nbut what i want is to do the same, without writing the relationship nor the associated weight.\r\nfor that i tried using **virtual relationships** like with this method:\r\n\r\n```\r\nMATCH (a1:node1)-[rel1]-(p:other_node)-[rel2]-(a2:node2)\r\nwith a1, a2, count(p) as common_occurrences\r\nwhere a1.id&gt;a2.id\r\nreturn \r\na1, a2, \r\napoc.create.vRelationship(a1, &#39;COAUTHORS_WITH_VIRTUAL2&#39;, {weight: common_occurrences}, a2) as REL_VIRTUAL2;\r\n```\r\n\r\nthis part seems to work but now i&#39;m quite puzzled about how to use it. if right after the last clause i write something like \r\n\r\n```\r\nCALL gds.graph.project(\r\n &#39;graph42&#39;,\r\n &#39;node1&#39;,\r\n {REL_VIRTUAL_2:{\r\n orientation:&#39;UNDIRECTED&#39;,\r\n properties:&#39;common_occurrences&#39;\r\n }\r\n }\r\n\r\n)\r\nyield *\r\n```\r\n\r\nit says that the relationship can not be found.\r\nany help on this?",
            "link": "https://stackoverflow.com/questions/77447334/neo4j-use-in-a-projection-a-virtual-relationship-with-weights",
            "title": "Neo4j: use in a projection a virtual relationship with weights"
        },
        {
            "tags": [
                "java",
                "neo4j",
                "spring-data",
                "cypher",
                "spring-data-neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 5007043,
                        "reputation": 672,
                        "user_id": 4024409,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/-4JS5nVp4cYs/AAAAAAAAAAI/AAAAAAAAAAA/9dswBlPXPdw/photo.jpg?sz=256",
                        "display_name": "Vincent Rupp",
                        "link": "https://stackoverflow.com/users/4024409/vincent-rupp"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1699990764,
                    "answer_id": 77483393,
                    "question_id": 77446718,
                    "body_markdown": "I suspect the problem lies in evaluating node equality.\r\n\r\nInstead of `WHERE p = $person` try `WHERE id(p) = id($person)`\r\n\r\nUPDATE: Based on this post, I could be mistaken:\r\nhttps://stackoverflow.com/questions/59844124/should-nodes-be-compared-directly-or-they-must-be-going-through-id-first",
                    "title": "Passing domain object as argument to custom Cypher query in Spring Data Neo4j"
                }
            ],
            "owner": {
                "account_id": 26739540,
                "reputation": 91,
                "user_id": 20340543,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/391fa27c030df060dd7293769457b56c?s=256&d=identicon&r=PG",
                "display_name": "Podbrushkin",
                "link": "https://stackoverflow.com/users/20340543/podbrushkin"
            },
            "is_answered": false,
            "view_count": 61,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1699455750,
            "question_id": 77446718,
            "body_markdown": "I&#39;m writing Spring Data Neo4j webapp.\r\nI have this domain object:\r\n```java\r\n@Node(&quot;Person&quot;)\r\npublic class Person {\r\n    \r\n    @Id\r\n    @GeneratedValue\r\n    private String id;\r\n```\r\n\r\nand a `(:Image) - [:DEPICTS] -&gt; (:Person)` relationship.\r\n\r\nI need to count images depicting specific person.\r\nThis was my attempt:\r\n```java\r\npublic interface ImageRepositoryNeo4j extends Neo4jRepository&lt;Image, String&gt; {\r\n@Query(&quot;&quot;&quot;\r\n        MATCH (i:Image) -[:DEPICTS] -&gt; (p:Person)\r\n        WHERE p = $person\r\n        RETURN count(i)\r\n        &quot;&quot;&quot;)\r\n    // DSNT WORK\r\n    public Integer countByPeopleContains(@Param(&quot;person&quot;) Person person);\r\n```\r\nbut it always returns 0.\r\n\r\n## Other failed attempts\r\n```java\r\n@Query(&quot;&quot;&quot;\r\n        MATCH (i:Image)-[:DEPICTS]-&gt;(p:Person)\r\n        WHERE p IN $people\r\n        RETURN count(i)\r\n        &quot;&quot;&quot;)\r\n    // DOESN&#39;T WORK, 0 RESULTS\r\n    public Integer countByPeopleContains(@Param(&quot;people&quot;) Collection&lt;Person&gt; people);\r\n\r\n@Query(&quot;&quot;&quot;\r\n        MATCH (i:Image) -[:DEPICTS] -&gt; (p:Person)\r\n        WHERE ID(p) = $person.__id__\r\n        RETURN count(i)\r\n        &quot;&quot;&quot;)\r\n    // DSNT WORK\r\n    public Integer countByPeopleContains(@Param(&quot;person&quot;) Person person);\r\n\r\n@Query(&quot;&quot;&quot;\r\n        MATCH (i:Image) -[:DEPICTS] -&gt; (p:Person)\r\n        WHERE id(p)=$person\r\n        RETURN count(i)\r\n        &quot;&quot;&quot;)\r\n    // DSNT WORK\r\n    public Integer countByPeopleContains(@Param(&quot;person&quot;) String personId);\r\n\r\n@Query(&quot;&quot;&quot;\r\n        MATCH (i:Image) -[:DEPICTS] -&gt; (p:Person {id: $person.__id__})\r\n        RETURN count(i)\r\n        &quot;&quot;&quot;)\r\n    // DSNT WORK, ALWAYS 0\r\n    public Integer countByPeopleContains(@Param(&quot;person&quot;) Person person);\r\n```\r\nAll of them return 0.\r\n\r\nAnd this one works, but since `fullName` isn&#39;t unique property, it is not suitable by domain logic:\r\n```java\r\n@Query(&quot;&quot;&quot;\r\n        MATCH (i:Image) -[:DEPICTS] -&gt; (p:Person {fullName: $person})\r\n        RETURN count(i)\r\n        &quot;&quot;&quot;)\r\n    // TODO: personFullname is not unique, use smth else\r\n    public Integer countByPeopleContains(@Param(&quot;person&quot;) String personFullName);\r\n```\r\n\r\nHow do I use domain object in custom Cypher query in Spring Data Neo4j Repository?\r\n\r\n## Clue\r\nIn [Spring Data Neo4j documentation][1] closest what I&#39;ve found to what I need is this:\r\n```java\r\n@Node\r\npublic final class Movie {\r\n\r\n    @Id\r\n    private final String title;\r\n...\r\ninterface MovieRepository extends Neo4jRepository&lt;Movie, String&gt; {\r\n\r\n    @Query(&quot;MATCH (m:Movie {title: $movie.__id__})\\n&quot;\r\n           + &quot;MATCH (m) &lt;- [r:DIRECTED|REVIEWED|ACTED_IN] - (p:Person)\\n&quot;\r\n           + &quot;return m, collect(r), collect(p)&quot;)\r\n    Movie findByMovie(@Param(&quot;movie&quot;) Movie movie);\r\n}\r\n```\r\nbut for some reason it doesn&#39;t work in my case. Maybe that&#39;s because my id is `@GeneratedValue`.\r\n\r\n## Another clue\r\n\r\nIn [Neo4j embedded docs](https://neo4j.com/docs/java-reference/current/java-embedded/query-parameters/) there is an example on how to pass an object to Cypher without Spring Data Neo4j:\r\n```\r\nMap&lt;String,Object&gt; params = new HashMap&lt;&gt;();\r\nparams.put( &quot;node&quot;, bobNode );\r\n\r\nString query =\r\n    &quot;MATCH (n:Person)&quot; + &quot;\\n&quot; +\r\n    &quot;WHERE n = $node&quot; + &quot;\\n&quot; +\r\n    &quot;RETURN n.name&quot;;\r\n\r\nResult result = transaction.execute( query, params );\r\n```\r\nIt works wif $node is `org.neo4j.graphdb.Node`:\r\n```java\r\n@Bean\r\nCommandLineRunner countForGregWithoutSDN(GraphDatabaseService graphDatabaseService) {\r\n\treturn args -&gt; {\r\n\t\ttry (var tx = graphDatabaseService.beginTx()) {\r\n\t\t\tString cypherGetGreg = &quot;MATCH (n:Person {birthday: date(&#39;1993-03-03&#39;)}) RETURN n LIMIT 5;&quot;;\r\n\t\t\tResult result = tx.execute(cypherGetGreg);\r\n\t\t\tvar greg1993 = (Node) result.next().get(&quot;n&quot;);\r\n\t\t\tif (!greg1993.getProperty(&quot;name&quot;).equals(&quot;Greg&quot;)) \r\n\t\t\t\tthrow new RuntimeException(&quot;Should be Greg1993 but actually &quot;+greg1993);\r\n\t\t\tresult.close();\r\n\r\n\t\t\tMap&lt;String,Object&gt; params = new HashMap&lt;&gt;();\r\n\t\t\tparams.put( &quot;node&quot;, greg1993 );\r\n\r\n\t\t\tString cypherCountForGreg = &quot;&quot;&quot;\r\n\t\t\t\tMATCH (i:Image) -[:DEPICTS] -&gt; (p:Person)\r\n\t\t\t\tWHERE p = $node\r\n\t\t\t\tRETURN count(i)\r\n\t\t\t\t&quot;&quot;&quot;;\r\n\t\t\tresult = tx.execute( cypherCountForGreg, params );\r\n\t\t\tvar count = result.next().values().iterator().next();\r\n\t\t\tSystem.out.println(&quot;Count for Greg1993 is &quot;+count);\t// 1\r\n\t\t\tresult.close();\r\n\t\t}\r\n\t};\r\n}\r\n```\r\n but it results in 0 if $node is SDN Entity.\r\n\r\n  [1]: https://docs.spring.io/spring-data/neo4j/reference/appendix/custom-queries.html#custom-queries.parameters",
            "link": "https://stackoverflow.com/questions/77446718/passing-domain-object-as-argument-to-custom-cypher-query-in-spring-data-neo4j",
            "title": "Passing domain object as argument to custom Cypher query in Spring Data Neo4j"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 7235347,
                        "reputation": 1631,
                        "user_id": 5520810,
                        "user_type": "registered",
                        "accept_rate": 69,
                        "profile_image": "https://lh5.googleusercontent.com/-Ur8TYb0ls7A/AAAAAAAAAAI/AAAAAAAAAFI/huQDsMpIVGc/photo.jpg?sz=256",
                        "display_name": "Skel",
                        "link": "https://stackoverflow.com/users/5520810/skel"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1699304090,
                    "answer_id": 77434200,
                    "question_id": 77434080,
                    "body_markdown": "I found an answer [here][1]\r\n\r\nI&#39;ve updated it to look like this\r\n\r\n```\r\nMATCH (doc:Captions)\r\nMATCH (p:Pillars {name: &#39;Feel Good&#39;})\r\nMATCH (doc)-[:HAS_PILLAR]-(p)\r\nMATCH (c:Categories {id: &#39;ne0MtinOO6DXryRvqMxS&#39;})\r\nMATCH (doc)-[:HAS_CATEGORY]-(c)\r\nWITH count(*) as docCount, collect(doc) as parts\r\nUNWIND parts as a\r\nRETURN docCount,a \r\nlimit 12\r\n```\r\n\r\nI have Updated based off @cyberSam&#39;s comment\r\n\r\n```typescript\r\nconst hasPillar = pageOptionsDto.pillar\r\n  ? `(p:Pillars {id: &#39;${pageOptionsDto.pillar}&#39;})&lt;-[:HAS_PILLAR]-`\r\n  : &#39;&#39;;\r\nconst hasCat = pageOptionsDto.category\r\n  ? `-[:HAS_CATEGORY]-&gt;(c:Categories {id:&#39;${pageOptionsDto.category}&#39;})`\r\n  : &#39;&#39;;\r\nconst hasOrderBy = pageOptionsDto.orderBy\r\n  ? `ORDER BY doc.${pageOptionsDto.order}, r.date`\r\n  : &#39;ORDER BY r.date&#39;;\r\nconst res = await this.neo4jService.read(`\r\n  MATCH ${hasPillar}(doc:${collection} {active: true})${hasCat}\r\n  WITH count(*) as docCount, collect(doc) as docs\r\n  UNWIND docs as doc\r\n  OPTIONAL MATCH (u:Users {id: &#39;${activeUserData.sub}&#39;})&lt;-[r:USED_BY]-(doc)\r\n  OPTIONAL MATCH (c:Categories)&lt;-[cr:HAS_CATEGORY]-(doc)\r\n  OPTIONAL MATCH (doc)-[:HAS_PILLAR]-&gt;(p:Pillars)\r\n  WITH docCount, doc, r, cr, c, p\r\n  ${hasOrderBy}\r\n  RETURN docCount, doc, COLLECT(r) as rs, COLLECT(c) as crs, COLLECT(p) as prs\r\n  SKIP ${pageOptionsDto.skip} LIMIT ${pageOptionsDto.limit}\r\n`);\r\n\r\nreturn res;\r\n```\r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/29593998/can-you-get-the-full-count-of-result-even-when-using-limit-clause-with-neo4j",
                    "title": "Neo4j Query set of node with 2 relationships and set value for each relationship node"
                },
                {
                    "owner": {
                        "account_id": 5007043,
                        "reputation": 672,
                        "user_id": 4024409,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/-4JS5nVp4cYs/AAAAAAAAAAI/AAAAAAAAAAA/9dswBlPXPdw/photo.jpg?sz=256",
                        "display_name": "Vincent Rupp",
                        "link": "https://stackoverflow.com/users/4024409/vincent-rupp"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1699892419,
                    "answer_id": 77475327,
                    "question_id": 77434080,
                    "body_markdown": "A simple answer is to traverse the graph once and collect the nodes:\r\n\r\n```\r\nMATCH (doc:Captions)-[:HAS_CATEGORY]-(:Categories {id: &#39;ne0MtinOO6DXryRvqMxS&#39;})\r\nMATCH (doc:Captions)-[:HAS_PILLAR]-(p:Pillars {name: &#39;Feel Good&#39;})\r\nwith collect(doc) as Docs\r\nwith [i in range(0,12) | Docs[i] ] as MyDocs, size(Docs) as docCount\r\nunwind MyDocs as Doc\r\nreturn Doc, docCount\r\n```\r\nThis will return 12 lines. Each line is a node and the count of the docs.\r\n\r\nYour comment above says the doc could have a pillar or a category. This query will only find docs that have _both_.\r\n\r\nTo avoid that, collect the docs from the first match statement, collect the docs from the second, and then join the lists before procedding.\r\n\r\nThe other option is to match on the docs first, then `optional match` the two possible paths.",
                    "title": "Neo4j Query set of node with 2 relationships and set value for each relationship node"
                }
            ],
            "owner": {
                "account_id": 7235347,
                "reputation": 1631,
                "user_id": 5520810,
                "user_type": "registered",
                "accept_rate": 69,
                "profile_image": "https://lh5.googleusercontent.com/-Ur8TYb0ls7A/AAAAAAAAAAI/AAAAAAAAAFI/huQDsMpIVGc/photo.jpg?sz=256",
                "display_name": "Skel",
                "link": "https://stackoverflow.com/users/5520810/skel"
            },
            "is_answered": false,
            "view_count": 46,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1699302877,
            "question_id": 77434080,
            "body_markdown": "I&#39;ve got this Query working:\r\n\r\n```cypher\r\nMATCH (doc:Captions)-[:HAS_CATEGORY]-(c:Categories {id: &#39;ne0MtinOO6DXryRvqMxS&#39;})\r\nMATCH (doc:Captions)-[:HAS_PILLAR]-(p:Pillars {name: &#39;Feel Good&#39;})\r\nWITH count(doc) as docCount\r\nMATCH (doc:Captions)-[:HAS_CATEGORY]-(c:Categories {id: &#39;ne0MtinOO6DXryRvqMxS&#39;})\r\nMATCH (doc:Captions)-[:HAS_PILLAR]-(p:Pillars {name: &#39;Feel Good&#39;})\r\nWITH docCount, doc Limit 12\r\nRETURN doc, docCount\r\n```\r\n\r\nThis will return a `docCount` of 25 and the `doc`s, limited to 12.\r\nBut it feels like I&#39;m making the same call twice.\r\n\r\nI&#39;m wanting to not make the same call twice",
            "link": "https://stackoverflow.com/questions/77434080/neo4j-query-set-of-node-with-2-relationships-and-set-value-for-each-relationship",
            "title": "Neo4j Query set of node with 2 relationships and set value for each relationship node"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1699267393,
                    "answer_id": 77430467,
                    "question_id": 77430266,
                    "body_markdown": "To get the first and last `SECTION` in your path, declare a variable in the node patterns either side of the `NEXT_SECTION` variable length portion:\r\n```\r\nMATCH (start:CITY {Name: &quot;London&quot;})\r\nMATCH (end:CITY {Name: &quot;Edinburgh&quot;})\r\nMATCH path = (start)-[:HAS_STATION]-&gt;(:STATION)-[:BOARDS]-&gt;\r\n             (first:SECTION)-[:NEXT_SECTION*]-&gt;(last:SECTION)-[:UNBOARDS]-&gt;\r\n             (:STATION)&lt;-[:HAS_STATION]-(end)\r\nRETURN first, last\r\n```",
                    "title": "Neo4j Cypher show first and last connected node"
                },
                {
                    "owner": {
                        "account_id": 5007043,
                        "reputation": 672,
                        "user_id": 4024409,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/-4JS5nVp4cYs/AAAAAAAAAAI/AAAAAAAAAAA/9dswBlPXPdw/photo.jpg?sz=256",
                        "display_name": "Vincent Rupp",
                        "link": "https://stackoverflow.com/users/4024409/vincent-rupp"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1699894635,
                    "answer_id": 77475549,
                    "question_id": 77430266,
                    "body_markdown": "The title asks for the first and last sections.\r\n\r\nYour text asks to find &quot;every section that is directly connected to a station from the path.&quot; For that, we&#39;ll find the path and then filter for the station nodes.\r\n\r\n```\r\nMATCH (start:CITY {Name: &quot;London&quot;})\r\nMATCH (end:CITY {Name: &quot;Edinburgh&quot;})\r\nmatch path = (start)-[mid:HAS_STATION|BOARDS|NEXT_SECTION|UNBOARDS*]-(end)\r\nwith mid\r\nwhere mid:STATION\r\nreturn mid\r\n```\r\n\r\n",
                    "title": "Neo4j Cypher show first and last connected node"
                }
            ],
            "owner": {
                "account_id": 28269614,
                "reputation": 19,
                "user_id": 21613020,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/7183a46897df9d6f4e57395a306a29cb?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "thomaswiiswitch",
                "link": "https://stackoverflow.com/users/21613020/thomaswiiswitch"
            },
            "is_answered": true,
            "view_count": 52,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1699265434,
            "question_id": 77430266,
            "body_markdown": "I created a graph in Neo4j for test purposes. Graph looks like screenshot below (simplified):\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/Mzzug.png\r\n\r\nWhat I want is the path from London to Edinburgh. For that I created following Cypher Query:\r\n\r\n\r\n```\r\nMATCH (start:CITY {Name: &quot;London&quot;})\r\nMATCH (end:CITY {Name: &quot;Edinburgh&quot;})\r\nMATCH path = (start)-[:HAS_STATION]-&gt;(:STATION)-[:BOARDS]-&gt;(:SECTION)-[:NEXT_SECTION*]-&gt;(:SECTION)-[:UNBOARDS]-&gt;(:STATION)&lt;-[:HAS_STATION]-(end)\r\n \r\n```\r\n\r\nThis Query leaves me with the whole path Via Section 1, 2 and 3. All I need for my result is the first and last section. If there is a transshipment in between (i.e. Glasgow), I also would need the last section before transshipment and the first after the transshipment.\r\n\r\nIn other words: I need every section that is directly connected to a station from the path. I tried out following extension:\r\n\r\n```\r\nwith nodes(path) as nodes\r\nunwind nodes as node\r\nwith node\r\nwhere ()-[:BOARDS]-&gt;(node) or (node)-[:UNBOARDS]-&gt;()\r\n```\r\n\r\nBut with that query extension I ended up with all Sections, since they all can either board or unboard at a specific station (even if that station is not part of the path).",
            "link": "https://stackoverflow.com/questions/77430266/neo4j-cypher-show-first-and-last-connected-node",
            "title": "Neo4j Cypher show first and last connected node"
        },
        {
            "tags": [
                "java",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 26739540,
                        "reputation": 91,
                        "user_id": 20340543,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/391fa27c030df060dd7293769457b56c?s=256&d=identicon&r=PG",
                        "display_name": "Podbrushkin",
                        "link": "https://stackoverflow.com/users/20340543/podbrushkin"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1700243597,
                    "answer_id": 77503708,
                    "question_id": 77428848,
                    "body_markdown": "Looks like it is Neo4j Browser is that you&#39;re interested in, not Neo4j Desktop. Most straightforward way is to connect Neo4j Browser to your embedded database while your app is running. But also indeed you can export whole database to a file and import it in Neo4j Browser which is connected to some other db, preferably empty.\r\n\r\n## Connect from Neo4j Browser in Neo4j Desktop\r\n\r\nIf you have started Neo4j Embedded with these settings:\r\n```\r\n.setConfig( BoltConnector.enabled, true )`\r\n.setConfig(BoltConnector.encryption_level, BoltConnector.EncryptionLevel.DISABLED)\r\n```\r\n\r\nthen you can connect to it while application is running by pointing Neo4j Browser to localhost:7687 and `No authentication` option:\r\n\r\n[![connect to db with neo4j browser in neo4j desktop][1]][1]\r\n\r\n---\r\n\r\n## Connect from Neo4j Browser in Docker Neo4j image\r\n\r\nIf you have **Docker**, you can access database created by your application without application itself and without *Neo4j Desktop* installed.\r\n\r\nIf you are creating your embedded db like that:\r\n```\r\nDatabaseManagementService managementService = \r\n    new  DatabaseManagementServiceBuilder(new File(&quot;target/mydb&quot;).toPath())\r\n```\r\nit means database is located at `/target/mydb/` directory. It stays there even after application is stopped.\r\n\r\nYou can run a new neo4j server with this database by executing this bash command in directory with `pom.xml` once your application is stopped:\r\n```\r\nsudo docker run --rm -p 7474:7474 -p 7687:7687 -v $PWD/target/mydb/data:/data --name neo4j-1 neo4j\r\n```\r\n\r\nI am using powershell and actual commands I execute are:\r\n```\r\n$neo4jDataDir = &#39;./target/mydb/data/&#39;\r\ndocker run --name neo4j-1 --rm -v $neo4jDataDir`:/data -p 7474:7474 -p 7687:7687 -e NEO4J_AUTH=neo4j/qwertyuiop -d neo4j\r\n# Checkout what&#39;s happening:\r\ndocker logs neo4j-1\r\n# Stop server:\r\ndocker stop neo4j-1\r\n```\r\n\r\nOnce server is up and running, **Neo4j Browser** becomes available at localhost:7474 in web browser.\r\n\r\nAlso I&#39;ve noticed when you stop server, **Neo4j Browser** keeps working until you will close it&#39;s tab in web browser.\r\n\r\n## Export database and import in Neo4j Browser\r\n\r\nIf for some reason you can&#39;t connect to your database with Neo4j Browser, you can dump your db to a file and import it afterwards in Neo4j Browser which is connected to a different db, preferably empty. For this you will need external plugin Apoc.\r\n\r\n1. Add these dependencies to project:\r\n```\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.neo4j.procedure&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;apoc-core&lt;/artifactId&gt;\r\n\t&lt;version&gt;${neo4j.version}&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n&lt;dependency&gt;\r\n\t&lt;groupId&gt;org.neo4j.procedure&lt;/groupId&gt;\r\n\t&lt;artifactId&gt;apoc-common&lt;/artifactId&gt;\r\n\t&lt;version&gt;${neo4j.version}&lt;/version&gt;\r\n&lt;/dependency&gt;\r\n```\r\n\r\n2. Register procedure you will use:\r\n```java\r\n...\r\nGraphDatabaseService db = graphDb.database(GraphDatabaseSettings.DEFAULT_DATABASE_NAME);\r\nregisterProcedure(db,\r\n\t\tapoc.export.cypher.ExportCypher.class);\r\n...\r\npublic static void registerProcedure(GraphDatabaseService db, Class&lt;?&gt;... procedures) {\r\n\tGlobalProcedures globalProcedures = ((GraphDatabaseAPI) db).getDependencyResolver()\r\n\t\t\t.resolveDependency(GlobalProcedures.class);\r\n\tfor (Class&lt;?&gt; procedure : procedures) {\r\n\t\ttry {\r\n\t\t\tglobalProcedures.registerProcedure(procedure);\r\n\t\t\tglobalProcedures.registerFunction(procedure);\r\n\t\t\tglobalProcedures.registerAggregationFunction(procedure);\r\n\t\t} catch (KernelException e) {\r\n\t\t\tthrow new RuntimeException(&quot;while registering &quot; + procedure, e);\r\n\t\t}\r\n\t}\r\n}\r\n```\r\n\r\n3. Enable exporting to a file:\r\n```java\r\nApocConfig.apocConfig().setProperty(ApocConfig.APOC_EXPORT_FILE_ENABLED, true);\r\n```\r\n\r\n4. Execute procedure:\r\n```java\r\ntry (\r\n\tvar driver = GraphDatabase.driver(&quot;bolt://localhost:7687&quot;, AuthTokens.none());\r\n\tvar session = driver.session()) {\r\n\tvar query = &quot;&quot;&quot;\r\n\t\t\tCALL apoc.export.cypher.all(&quot;all-plain.cypher&quot;, {\r\n\t\t\t\tformat: &quot;plain&quot;,\r\n\t\t\t\tuseOptimizations: {type: &quot;UNWIND_BATCH&quot;, unwindBatchSize: 20}\r\n\t\t\t})\r\n\t\t\t&quot;&quot;&quot;;\r\n\tsession.executeRead(t -&gt; t.run(query).consume());\r\n}\r\n```\r\n\r\n5. Find a `./target/mydb/all-plain.cypher` text file with all your data in Cypher format.\r\n\r\n6. Drag and drop it to Neo4j Browser or copy-paste it&#39;s contents. \r\n\r\nFully working example of dumping database to a file can be found [in this Gist](https://gist.github.com/Podbrushkin/3f16feb9b9da22ab27ee2878c38633aa).\r\n\r\n  [1]: https://i.stack.imgur.com/PHRyl.gif",
                    "title": "Embedded database to neo4j desktop"
                }
            ],
            "owner": {
                "account_id": 20062508,
                "reputation": 5,
                "user_id": 14708942,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-s8lHGK-a3m4/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmhBZDytDnvFrHNKrwMUA_SmxBmmg/s96-c/photo.jpg?sz=256",
                "display_name": "AES",
                "link": "https://stackoverflow.com/users/14708942/aes"
            },
            "is_answered": true,
            "view_count": 71,
            "favorite_count": 0,
            "accepted_answer_id": 77503708,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1699247159,
            "question_id": 77428848,
            "body_markdown": "I&#39;m currently using `DatabaseManagementServiceBuilder` to store `neo4j` data on my local host. Is there anyway to import the data to `neo4j` desktop or any other tool for visualisation? for example by creating a `.csv` file or dumping the data.\r\n\r\nThis is how my directories look like.\r\n\r\nfirst  \r\n![first][1]\r\n\r\nsecond  \r\n![second][2]\r\n\r\nthird  \r\n![third][3]\r\n\r\nI tried to replace the `/data` directory in a `neo4j` desktop database with my own `/data` directory but it didn&#39;t work (`neo4j` desktop kept giving an error which was no surprise).\r\n\r\n\r\n[enter image description here][4]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/QLm9Z.jpg\r\n  [2]: https://i.stack.imgur.com/3EW2r.jpg\r\n  [3]: https://i.stack.imgur.com/uU9xt.jpg\r\n\r\nthis is my code for connecting\r\n  [4]: https://i.stack.imgur.com/GkIKu.png",
            "link": "https://stackoverflow.com/questions/77428848/embedded-database-to-neo4j-desktop",
            "title": "Embedded database to neo4j desktop"
        },
        {
            "tags": [
                "apache-kafka",
                "neo4j",
                "apache-kafka-connect"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1112644,
                        "reputation": 4427,
                        "user_id": 1102806,
                        "user_type": "registered",
                        "accept_rate": 84,
                        "profile_image": "https://www.gravatar.com/avatar/60f22692ed394826a6a07d9155474877?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "DevEx",
                        "link": "https://stackoverflow.com/users/1102806/devex"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1699255907,
                    "answer_id": 77429408,
                    "question_id": 77424154,
                    "body_markdown": "I tried rebuilding the artifact and discovered my java version was outdated. Upgrading to java 11 resolved the issue for me.",
                    "title": "Apache Kafka Neo4j Connector issues"
                }
            ],
            "owner": {
                "account_id": 1112644,
                "reputation": 4427,
                "user_id": 1102806,
                "user_type": "registered",
                "accept_rate": 84,
                "profile_image": "https://www.gravatar.com/avatar/60f22692ed394826a6a07d9155474877?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "DevEx",
                "link": "https://stackoverflow.com/users/1102806/devex"
            },
            "is_answered": true,
            "view_count": 37,
            "favorite_count": 0,
            "accepted_answer_id": 77429408,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1699139716,
            "question_id": 77424154,
            "body_markdown": "I set up kafka neo4j sink connector the following way:\r\n 1. Created `/tmp/plugins`, downloaded `neo4j-kafka-connect-neo4j-5.0.3-kc-oss.zip` (for Apache Kafka) and unzip into plugins folder i.e.\r\n 2. Modified `connect-standalone.properties`, added `plugin.path=/tmp/plugins`\r\n 3. Created `connect-neo4j-sink.properties` in config with the following\r\n\r\n    ```name=Neo4jSinkConnector\r\n    topics=my-events\r\n    connector.class=streams.kafka.connect.sink.Neo4jSinkConnector\r\n    key.converter=org.apache.kafka.connect.json.JsonConverter\r\n    key.converter.schemas.enable=false\r\n    value.converter=org.apache.kafka.connect.json.JsonConverter\r\n    errors.retry.timeout=-1\r\n    errors.retry.delay.max.ms=1000\r\n    errors.tolerance=all\r\n    errors.log.enable=true\r\n    errors.log.include.messages=true\r\n    neo4j.server.uri=bolt://neo4j:7687\r\n    neo4j.authentication.basic.username=neo4j\r\n    neo4j.authentication.basic.password=neo4j\r\n    neo4j.encryption.enabled=false\r\n    neo4j.topic.cypher.my-topic=MERGE (p:Person{name: event.name, surname: event.surname}) MERGE (f:Family{name: event.surname}) MERGE (p)-[:BELONGS_TO]-&gt;(f)```\r\n\r\n\r\nAnd when I start:\r\n\r\n```/bin/connect-standalone.sh config/connect-standalone.properties config/connect-neo4j-sink.properties```\r\n\r\nI get this error: \r\n\r\n```Caused by: org.apache.kafka.connect.errors.ConnectException: Failed to find any class that implements Connector and which name matches streams.kafka.connect.sink.Neo4jSinkConnector```\r\n\r\n**Environment**\r\n\r\n - neo4j:5-community \r\n - apache kafka 2.13-3.6.0",
            "link": "https://stackoverflow.com/questions/77424154/apache-kafka-neo4j-connector-issues",
            "title": "Apache Kafka Neo4j Connector issues"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "neo4j-apoc"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1699034115,
                    "answer_id": 77418774,
                    "question_id": 77417923,
                    "body_markdown": "Because you&#39;re only counting relationships for a single node, either version will take milliseconds, so performance isn&#39;t relevant. Only where counts were being done for many nodes would you consider it. In any case, without profiling, the best way would be to actually measure it.\r\n\r\nI compared the following Cypher and APOC versions for different numbers of relationships (the actual `MATCH` double counts, but that doesn&#39;t matter for this):\r\n\r\n**Cypher**\r\n```sql\r\nMATCH (n)-[r]-()\r\nRETURN \r\n  CASE \r\n    WHEN (startNode(r) = n) THEN type(r) + &#39;&gt;&#39; \r\n    ELSE &#39;&lt;&#39; + type(r)\r\n  END AS type, \r\n  count(r) AS count\r\n```\r\n\r\n**APOC**\r\n```sql\r\nMATCH (n)\r\nCALL {\r\n    WITH n\r\n    WITH n, apoc.node.relationship.types(n) AS types\r\n    CALL {\r\n        WITH n, types\r\n        UNWIND types as type\r\n        RETURN &#39;&lt;&#39;+type AS type, apoc.node.degree.in(n, type) as count\r\n    UNION ALL \r\n        WITH n, types\r\n        UNWIND types as type\r\n        RETURN type+&#39;&gt;&#39; AS type, apoc.node.degree.out(n, type) as count\r\n    }\r\n    RETURN type, count\r\n}\r\nRETURN type, sum(count)\r\n```\r\n\r\nHere is a comparison (based on running the DB locally):\r\n\r\n[![enter image description here][1]][1]\r\n\r\nThere may be a more efficient version for the APOC query, but in any case, the Cypher here is faster.\r\n\r\n  [1]: https://i.stack.imgur.com/rIvld.png",
                    "title": "Neo4j count relationships of each type for given node"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1699036773,
                    "answer_id": 77419012,
                    "question_id": 77417923,
                    "body_markdown": "There is actually a faster approach that also fixes a potential problem in your current queries. If `n` has any self-relationships (relationships that start/end at `n`), then such relationships would be counted twice (as both inbound and outbound relationships). In other words, the sum of the counts could be greater than the actual number of relationships.\r\n\r\nThis query should be fast and also solve the self-relationship problem:\r\n\r\n    MATCH (n)-[r]-() WHERE id(n) = 0\r\n    RETURN\r\n      CASE n WHEN ENDNODE(r) THEN &#39;&lt;&#39; ELSE &#39;&#39; END +\r\n      TYPE(r) +\r\n      CASE n WHEN STARTNODE(r) THEN &#39;&gt;&#39; ELSE &#39;&#39; END AS type,\r\n      COUNT(*) AS count\r\n\r\nAn inbound `REL` relationship would be represented as `&lt;REL`, an outbound one as `REL&gt;`, and a self-relationship as `&lt;REL&gt;`. And the sum of the counts would equal the actual number of relationships.\r\n\r\n#### Including endnode labels\r\nHere is a slightly altered query that returns a count of each distinct combination of type and end node labels (a node can have multiple labels):\r\n\r\n    MATCH (n)-[r]-(m) WHERE id(n) = 0\r\n    RETURN\r\n      CASE n WHEN ENDNODE(r) THEN &#39;&lt;&#39; ELSE &#39;&#39; END +\r\n      TYPE(r) +\r\n      CASE n WHEN STARTNODE(r) THEN &#39;&gt;&#39; ELSE &#39;&#39; END AS type,\r\n      LABELS(m) AS endNodeLabels,\r\n      COUNT(*) AS count\r\n\r\nReading how [aggregating functions](https://neo4j.com/docs/cypher-manual/current/functions/aggregating/) work will help you understand these 2 queries.",
                    "title": "Neo4j count relationships of each type for given node"
                }
            ],
            "owner": {
                "account_id": 2229788,
                "reputation": 1463,
                "user_id": 1967693,
                "user_type": "registered",
                "accept_rate": 62,
                "profile_image": "https://www.gravatar.com/avatar/91a12c6019aaf3d7635e9d4b09522322?s=256&d=identicon&r=PG",
                "display_name": "zirkelc",
                "link": "https://stackoverflow.com/users/1967693/zirkelc"
            },
            "is_answered": true,
            "view_count": 52,
            "favorite_count": 0,
            "accepted_answer_id": 77419012,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1699025458,
            "question_id": 77417923,
            "body_markdown": "I want to count the relationships for each type of a given start node. I have constructed two possible queries to achieve that, but I don&#39;t know which one is going to be more efficient when dealing with lots of relationships.\r\n\r\n1. Cypher only query with `count()`\r\n```sql\r\nMATCH (n) WHERE id(n) = 0\r\nCALL {\r\n    WITH n\r\n    MATCH (n)&lt;-[r]-()\r\n    RETURN &#39;&lt;&#39;+TYPE(r) AS type, COUNT(r) AS count\r\nUNION ALL \r\n    WITH n\r\n    MATCH (n)-[r]-&gt;()\r\n    RETURN TYPE(r)+&#39;&gt;&#39; AS type, COUNT(r) AS count\r\n}\r\nRETURN type, count\r\n```\r\n\r\nResult:\r\n```\r\n╒════════════╤═════╕\r\n│type        │count│\r\n╞════════════╪═════╡\r\n│&quot;&lt;ACTED_IN&quot; │5    │\r\n├────────────┼─────┤\r\n│&quot;&lt;PRODUCED&quot; │1    │\r\n├────────────┼─────┤\r\n│&quot;&lt;DIRECTED&quot; │2    │\r\n└────────────┴─────┘\r\n```\r\n\r\n2. Cypher + APOC `apoc.node.relationship.types()` and `type, apoc.node.degree.[in|out]()`\r\n```sql\r\nMATCH (n) WHERE id(n) = 0\r\nWITH n, apoc.node.relationship.types(n) AS types\r\nCALL {\r\n    WITH n, types\r\n    UNWIND types as type\r\n    RETURN &#39;&lt;&#39;+type AS type, apoc.node.degree.in(n, type) as count\r\nUNION ALL \r\n    WITH n, types\r\n    UNWIND types as type\r\n    RETURN type+&#39;&gt;&#39; AS type, apoc.node.degree.out(n, type) as count\r\n}\r\nRETURN type, count\r\n```\r\nResult:\r\n```\r\n╒════════════╤═════╕\r\n│type        │count│\r\n╞════════════╪═════╡\r\n│&quot;&lt;ACTED_IN&quot; │5    │\r\n├────────────┼─────┤\r\n│&quot;&lt;DIRECTED&quot; │2    │\r\n├────────────┼─────┤\r\n│&quot;&lt;PRODUCED&quot; │1    │\r\n├────────────┼─────┤\r\n│&quot;ACTED_IN&gt;&quot; │0    │\r\n├────────────┼─────┤\r\n│&quot;DIRECTED&gt;&quot; │0    │\r\n├────────────┼─────┤\r\n│&quot;PRODUCED&gt;&quot; │0    │\r\n└────────────┴─────┘\r\n```\r\n\r\nThe second query returns rows for empty relationship types, but this can be neglected.\r\n\r\nI can only profile the first cypher-only query, because custom procedures like APOC can&#39;t be profiled.  ",
            "link": "https://stackoverflow.com/questions/77417923/neo4j-count-relationships-of-each-type-for-given-node",
            "title": "Neo4j count relationships of each type for given node"
        },
        {
            "tags": [
                "neo4j",
                "podman"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 29000777,
                        "reputation": 1,
                        "user_id": 22214354,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/96faa0d16e180bc41836018844e66c62?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "Jonathan Giffard",
                        "link": "https://stackoverflow.com/users/22214354/jonathan-giffard"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698935367,
                    "answer_id": 77410440,
                    "question_id": 77409903,
                    "body_markdown": "Here&#39;s the command I have used successfully with podman in the past.  I have the volumes located in sub-folders of my home folder\r\n\r\n```\r\npodman run -dt \\\r\n    --name=neo4jdb01 \\\r\n    --env=NEO4J_ACCEPT_LICENSE_AGREEMENT=yes \\\r\n    --env=NEO4J_AUTH=neo4j/password \\\r\n    --userns=keep-id\r\n    --publish=7474:7474 --publish=7687:7687 \\\r\n    --volume=$HOME/Projects/neo4j/data:/data \\\r\n    --volume=$HOME/Projects/neo4j/conf:/conf \\\r\n    --volume=$HOME/Projects/neo4j/logs:/logs \\\r\n    --volume=$HOME/Projects/neo4j/plugins:/plugins \\\r\n    neo4j:enterprise\r\n```",
                    "title": "podman neo4j unable to mount volume to persist data"
                }
            ],
            "owner": {
                "account_id": 2741787,
                "reputation": 17227,
                "user_id": 2411173,
                "user_type": "registered",
                "accept_rate": 65,
                "profile_image": "https://www.gravatar.com/avatar/52e928a6f9e3077749b75cddab339f4f?s=256&d=identicon&r=PG",
                "display_name": "Donbeo",
                "link": "https://stackoverflow.com/users/2411173/donbeo"
            },
            "is_answered": false,
            "view_count": 40,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698930949,
            "question_id": 77409903,
            "body_markdown": "I am trying to run neo4j with podman  with persisted data on volumes. \r\n\r\nI do not know why but when I try to run the container with `--volume` option it dies. \r\nAm I doing something wrong? \r\n\r\n\r\n```\r\n(venv) [app_runner@eu012vm2093 ~]$ podman ps -a\r\nCONTAINER ID  IMAGE       COMMAND     CREATED     STATUS      PORTS       NAMES\r\n(venv) [app_runner@eu012vm2093 ~]$ podman run -d --name neo4jVol -p 7474:7474 -p 7687:7687 --volume /app/podman_storage/volumes/neo4j:/data neo4j\r\na281c68231f0987140e0d8a5b74d1e960056bd1a65df7a2be1426e433de05b10\r\n(venv) [app_runner@eu012vm2093 ~]$ podman ps -a\r\nCONTAINER ID  IMAGE                           COMMAND     CREATED        STATUS                    PORTS                                           NAMES\r\na281c68231f0  docker.io/library/neo4j:latest  neo4j       3 seconds ago  Exited (1) 4 seconds ago  0.0.0.0:7474-&gt;7474/tcp, 0.0.0.0:7687-&gt;7687/tcp  neo4jVol\r\n(venv) [app_runner@eu012vm2093 ~]$ podman run -d --name neo4j -p 7474:7474 -p 7687:7687  neo4j\r\n8408fd2f49bcc478b303fa05170dc56a5c48da2e0f59fbdabe8ace7e415bdfb8\r\n(venv) [app_runner@eu012vm2093 ~]$ podman ps -a\r\nCONTAINER ID  IMAGE                           COMMAND     CREATED         STATUS                     PORTS                                           NAMES\r\na281c68231f0  docker.io/library/neo4j:latest  neo4j       17 seconds ago  Exited (1) 18 seconds ago  0.0.0.0:7474-&gt;7474/tcp, 0.0.0.0:7687-&gt;7687/tcp  neo4jVol\r\n8408fd2f49bc  docker.io/library/neo4j:latest  neo4j       3 seconds ago   Up 3 seconds               0.0.0.0:7474-&gt;7474/tcp, 0.0.0.0:7687-&gt;7687/tcp  neo4j\r\n(venv) [app_runner@eu012vm2093 ~]$\r\n```\r\n\r\n\r\nEDIT:\r\n\r\nI have tried to do as suggested by jonathan but I still get the same error:\r\n\r\n```\r\n(venv) [app_runner@eu012vm2093 ~]$ cat run_neo4j.sh\r\npodman run -dt --name=neo4jdb01     --env=NEO4J_ACCEPT_LICENSE_AGREEMENT=yes     --env=NEO4J_AUTH=neo4j/password     --userns=keep-id   --publish=7474:7474 --publish=7687:7687 \\\r\n    --volume=$HOME/data/data:/data \\\r\n    --volume=$HOME/data/conf:/conf \\\r\n    --volume=$HOME/data/logs:/logs \\\r\n    --volume=$HOME/data/plugins:/plugins \\\r\n    neo4j\r\n(venv) [app_runner@eu012vm2093 ~]$ podman ps -a\r\nCONTAINER ID  IMAGE       COMMAND     CREATED     STATUS      PORTS       NAMES\r\n(venv) [app_runner@eu012vm2093 ~]$ sh run_neo4j.sh\r\ndfe473547f6d7a16912d160e9654b5b0ed08945149fb4aacae7b4c1f2a6cd7fe\r\n(venv) [app_runner@eu012vm2093 ~]$ podman ps -a\r\nCONTAINER ID  IMAGE                           COMMAND     CREATED        STATUS                    PORTS                                           NAMES\r\ndfe473547f6d  docker.io/library/neo4j:latest  neo4j       2 seconds ago  Exited (1) 3 seconds ago  0.0.0.0:7474-&gt;7474/tcp, 0.0.0.0:7687-&gt;7687/tcp  neo4jdb01\r\n(venv) [app_runner@eu012vm2093 ~]$\r\n```\r\n",
            "link": "https://stackoverflow.com/questions/77409903/podman-neo4j-unable-to-mount-volume-to-persist-data",
            "title": "podman neo4j unable to mount volume to persist data"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 9963444,
                        "reputation": 12317,
                        "user_id": 7371893,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=256&g=1",
                        "display_name": "jose_bacoy",
                        "link": "https://stackoverflow.com/users/7371893/jose-bacoy"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698926447,
                    "answer_id": 77409391,
                    "question_id": 77409184,
                    "body_markdown": "Simple delete is ok!\r\n\r\nDETACH DELETE is a shorter way of doing a delete relationship then delete node. So instead of doing two steps of Delete node then Delete relationship, we use DETACH DELETE in one go.\r\n\r\nFor relationship, you are NOT detach(ing) it from a node, you simply deleting it. So using detach is not needed but neo4j will flag it as an error if you do DETACH DELETE for a relationship.  It understands the redundancy and deletes it anyway.",
                    "title": "Optimization of a cypher query which deletes duplicate relationships"
                },
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698939567,
                    "answer_id": 77410965,
                    "question_id": 77409184,
                    "body_markdown": "`DETACH DELETE` will delete _all_ relationships attached to a given node before deleting that node. In your case, you are deleting specified relationships, so the `DETACH` keyword has no effect.\r\n\r\nAs you are using Neo4j 3.5, you could use the following as an optimized version of your query—assuming you have apoc installed:\r\n\r\n```\r\nCALL apoc.periodic.iterate(\r\n    &quot;MATCH (n)-[r:R]-&gt;(m)\r\n     WHERE exists((n)-[r]-&gt;(m)&lt;-[:R {id: r.id}]-(n))\r\n     WITH r.id AS id, tail(collect(r)) AS branches\r\n     UNWIND branches AS branch\r\n     RETURN branch&quot;,\r\n    &quot;DELETE branch&quot;,\r\n    {batchSize: 10000, parallel: true}\r\n)\r\n```\r\n\r\nUsing `r.id` as the grouping key works because its value is the same for all relationships that are duplicates of each other. The `exists` also assumes that the duplicate relationships have the same source and target nodes.\r\n\r\nIf you are on Neo4j 5, you could do a safer batched version of the above with `CALL IN TRANSACTIONS`:\r\n```\r\nMATCH (n)-[r:R]-&gt;(m) \r\nWHERE EXISTS { (n)-[r]-&gt;(m)&lt;-[:R {id: r.id}]-(n) }\r\nWITH r.id AS id, tail(collect(r)) AS branches\r\nUNWIND branches AS branch\r\nCALL { \r\n    WITH branch\r\n    DELETE branch\r\n} IN TRANSACTIONS OF 10000 ROWS\r\n```",
                    "title": "Optimization of a cypher query which deletes duplicate relationships"
                }
            ],
            "owner": {
                "account_id": 29810119,
                "reputation": 11,
                "user_id": 22845737,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocKNKzG4ZG21RjKJZ87NmjljaKskSXrI6x6i6Z3c2cr241k=k-s256",
                "display_name": "Somnath Deb",
                "link": "https://stackoverflow.com/users/22845737/somnath-deb"
            },
            "is_answered": false,
            "view_count": 82,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 1,
            "creation_date": 1698924475,
            "question_id": 77409184,
            "body_markdown": "I am trying to delete a few duplicate relationships that got created between the same nodes. For example, node A is connected to node B with relationship R two times. Hence I have to delete one relationship. To do that I have written a query like this: \r\n```\r\nMATCH p = ()-[r:relationship]-&gt;()\r\nWITH r.id AS id, collect(r) AS branches WHERE size(branches) &gt; 1\r\nFOREACH (n IN tail(branches) | DELETE n)\r\n```\r\n\r\nMy question is whether I should use `DETACH DELETE`, or is a simple `DELETE` ok? Or in this case will `DETACH DELETE` and `DELETE` both do the same work?\r\n\r\nIn addition, please suggest how I can optimize this query!! Since there are millions of records to be deleted.\r\n\r\nI have tried using both the `DELETE` clause and the `DETACH DELETE` clause, seems both worked the same. Note: I am using Neo4j version 3.5.",
            "link": "https://stackoverflow.com/questions/77409184/optimization-of-a-cypher-query-which-deletes-duplicate-relationships",
            "title": "Optimization of a cypher query which deletes duplicate relationships"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1698868516,
                    "answer_id": 77405263,
                    "question_id": 77404810,
                    "body_markdown": "You have inconsistencies in your sample data.\r\n\r\n- `scenario2` says it has 3 parents, but there are only 2 `GAP` nodes containing the `s2` key.\r\n- `scenario3` says it has 1 parent, but there are actually 2 `GAP` nodes containing the `s3` key.\r\n\r\nHere is a query that should work, assuming you fix your data to be consistent:\r\n\r\n    MATCH (gap:GAP)\r\n    WHERE gap.name IN $gaps\r\n    UNWIND SPLIT(gap.next, &#39;,&#39;) AS sKey\r\n    WITH sKey, COUNT(*) AS cnt\r\n    WITH COLLECT({sKey: sKey, cnt: cnt}) AS data\r\n    MATCH (s:SCENARIO)\r\n    WHERE ANY(d IN data WHERE d.sKey = s.key AND d.cnt = s.parents)\r\n    RETURN s.name AS ScenarioName;\r\n\r\nThe query assumes that the list of `GAP` names is provided as a `$gaps` [parameter](https://neo4j.com/docs/cypher-manual/current/syntax/parameters/).\r\n\r\n#### Suggested new model\r\n\r\nYou should strongly consider changing your data model, however. You are not using any relationships, which is the main strength of a graph database. `GAP` and `SCENARIO` nodes should not store relationship information as properties, but should be linked by actual relationships. I would also recommend conforming to the [recommended neo4j naming convention](https://neo4j.com/docs/cypher-manual/current/syntax/naming/#_recommendations), where labels are camel-cased.\r\n\r\nFor example, this could conceptually be your new data model (without the `next` and `parents` properties):\r\n\r\n    (g:Gap {name, key, desc})-[:HAS_SCENARIO]-&gt;(s:Scenario {name, key, desc})\r\n\r\nWith this new model, the query for your use case would simply be:\r\n\r\n    MATCH (g:Gap)-[:HAS_SCENARIO]-&gt;(s:Scenario)\r\n    WHERE g.name IN $gaps\r\n    WITH s, COUNT(g) AS cnt\r\n    WHERE COUNT{ ()-[:HAS_SCENARIO]-&gt;(s) } = cnt\r\n    RETURN s.name AS scenarioName;\r\n",
                    "title": "Cypher Query to Filter SCENARIO Nodes Based on GAP Nodes"
                }
            ],
            "owner": {
                "account_id": 10150295,
                "reputation": 1257,
                "user_id": 7497127,
                "user_type": "registered",
                "accept_rate": 67,
                "profile_image": "https://lh6.googleusercontent.com/-DUakSAslaoA/AAAAAAAAAAI/AAAAAAAADHc/lIAG1nu4vzM/photo.jpg?sz=256",
                "display_name": "JAMSHAID",
                "link": "https://stackoverflow.com/users/7497127/jamshaid"
            },
            "is_answered": true,
            "view_count": 39,
            "favorite_count": 0,
            "accepted_answer_id": 77405263,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698863109,
            "question_id": 77404810,
            "body_markdown": "I&#39;m working with a Neo4j database with a data model with GAP and SCENARIO nodes. Each GAP node has a &quot;next&quot; property that lists the keys of connected SCENARIO nodes. The SCENARIO nodes have a &quot;parents&quot; property indicating how many parent nodes they have. I want to filter SCENARIO nodes based on a list of selected GAP nodes and the number of parents. \r\n\r\nHere is how GAP nodes are supposed to SCENARIO nodes:   \r\n\r\n- gap1 key:g1\r\n- gap2 key:g2\r\n- gap3 key:g3\r\n\r\n----------\r\n\r\n- scenario1 key:  s1 \r\n- scenario2 key:  s2\r\n- scenario3 key: s3\r\n\r\n----------\r\n\r\n- parents of scenario 1 are: gap1, gap2\r\n- parents of scenario 2 are: gap1, gap2, gap3\r\n- parents of scenario 3 are: gap2\r\n\r\nHere is my GAP and SCENARIO nodes model:    \r\n\r\n     (gap1:GAP {name:  &#39;g1&#39;,\r\n\t            key:   &#39;g1&#39;,\r\n\t            desc:  &#39;&#39;,\r\n\t            next:  &#39;s1,s2&#39;\r\n\t  }),\r\n\t//GAP2\r\n\t  (gap2:GAP {name:  &#39;g2&#39;,\r\n                 key:   &#39;g2&#39;,\r\n                 desc:  &#39;&#39;,\r\n                 next:  &#39;s1,s2,s3&#39;\r\n\t  }),\r\n\t//GAP3\r\n\t  (gap3:GAP {name:  &#39;g3&#39;,\r\n                 key:   &#39;g3&#39;,\r\n                 desc:  &#39;g3&#39;,\r\n                 next:  &#39;s2&#39;\r\n\t  }),\r\n\r\n\t//SCENARIO\r\n\t  (scenario1:SCENARIO {name:    &#39;s1&#39;,\r\n                           key:     &#39;s1&#39;,\r\n                           DESC:    &#39;&#39;,\r\n                           parents: 2\r\n                           }),\r\n\t  (scenario2:SCENARIO {name:    &#39;s2&#39;,\r\n                           key:     &#39;s2&#39;,\r\n                           DESC:    &#39;&#39;,\r\n                           parents: 3\r\n                           }),\r\n\t  (scenario3:SCENARIO {name:    &#39;s3&#39;,\r\n                           key:     &#39;s3&#39;,\r\n                           DESC:    &#39;&#39;,\r\n                           parents: 1}),\r\n\r\nIf a gap is provided as input in the query and it is a parent of a scenario, but the number of parents of that scenario is more than 1 in the parent node, it should exclude the scenario from the result. If two gaps are provided, and both are parents of a single scenario, other scenario nodes are included. Still, the parent condition only meets for that single node; it should only return that single node. \r\n\r\nI have tried too many combinations but always fail somewhere.\r\nThis query somehow worked, but it failed for the following conditions: \r\n\r\n 1. When g1,g2 are provided, it should return s1 only. it returns all three scenario\r\n 2. if g1 is provided, it should return empty, but it returns s1,s2\r\n 3. if g2 is provided, it should return only s3 but it returns all s1,s2,s3    \r\n\r\n\r\nI have been stuck on this for around three days but have been unable to figure out a solution. Please note that, per the scenario, a direct link from GAP to SCENARIO will not solve the problem.\r\n\r\n    MATCH (gap:GAP)\r\n\tWHERE gap.name IN [&#39;g1&#39;, &#39;g2&#39;, &#39;g3&#39;]\r\n\r\n\tWITH COLLECT(DISTINCT gap) AS selectedGaps\r\n\r\n\tWHERE size(selectedGaps) &gt; 0  \r\n\r\n\tMATCH (scenario:SCENARIO)\r\n\tWHERE ANY(gap IN selectedGaps WHERE scenario.key IN split(gap.next, &#39;,&#39;))\r\n\tRETURN scenario.name AS ScenarioName;\r\n",
            "link": "https://stackoverflow.com/questions/77404810/cypher-query-to-filter-scenario-nodes-based-on-gap-nodes",
            "title": "Cypher Query to Filter SCENARIO Nodes Based on GAP Nodes"
        },
        {
            "tags": [
                "apache-kafka",
                "neo4j",
                "confluent-schema-registry"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1698943383,
                    "answer_id": 77411430,
                    "question_id": 77403628,
                    "body_markdown": "You deleted `timestamp` from the source instance&#39;s `neo4j.source.query` value, but presumably kept the `neo4j.streaming.property` still assigned to &quot;timestamp&quot;.\r\n\r\nAccording to [the documentation](https://neo4j.com/docs/kafka/kafka-connect/configuration/), the optional `neo4j.streaming.property` property is:\r\n\r\n&gt; The name of the property that we need to consider in order to\r\n&gt; determinate the last queried record; if not defined we use an internal\r\n&gt; value given from the last performed check. We use this value for\r\n&gt; injecting it in the provided query defined in `neo4j.source.query` as\r\n&gt; `$lastCheck` parameter.\r\n\r\n*I fixed a typo in the above quote.*\r\n\r\nTry deleting the optional `neo4j.streaming.property` property so that the internal value can be used instead.",
                    "title": "Kafka-Neo4J-Connector: $lastCheck not updating if no timestamp is returned"
                }
            ],
            "owner": {
                "account_id": 15429584,
                "reputation": 25,
                "user_id": 11131384,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/--DeVhMDpXR0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdVAu7uVfbmwzFI-snrC01_K9X2yg/mo/photo.jpg?sz=256",
                "display_name": "Max ",
                "link": "https://stackoverflow.com/users/11131384/max"
            },
            "is_answered": true,
            "view_count": 53,
            "favorite_count": 0,
            "accepted_answer_id": 77411430,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698851225,
            "question_id": 77403628,
            "body_markdown": "I followed the quickstart-tutorial for the [Neo4J-Kafka-Connector](https://neo4j.com/docs/kafka/quickstart-connect/). The following source instance cypher\r\n\r\n```\r\nMATCH (ts:TestSource) WHERE ts.timestamp &gt; $lastCheck RETURN ts.name AS name, ts.surname AS surname, ts.timestamp AS timestamp\r\n```\r\n\r\ninserts `name, surname, timestamp` rows in a kafka topic, if the `ts.timestamp &gt; $lastCheck` condition is satisfied.\r\n\r\nIf I am removing the `ts.timestamp as timestamp` from the return-clause, then the `$lastCheck `parameter isn&#39;t updated anymore, so the where condition is always true and the whole graph is queried for every request. Is there a way to update the `$lastCheck` parameter without returning a timestamp? This would be great, especially for aggregations, if a grouping on the timestamp is not wanted.\r\n\r\n**EDIT**\r\n\r\nTo illustrate the problem a bit better, I added the `$lastCheck` parameter to the return clause. So my first query\r\n```\r\nMATCH (ts:TestSource) WHERE ts.timestamp &gt; $lastCheck RETURN ts.name AS name, ts.surname AS surname, ts.timestamp AS timestamp, $lastCheck as lastCheck\r\n```\r\nwrites the following messages into my topic:\r\n[![Topic after first topic][1]][1]\r\n\r\n\r\nHere, I inserted the example `TestSource` nodes **twice** (after a short delay), to show the updated `$lastCheck` parameter.\r\n\r\n&gt; CREATE (:TestSource {name: &#39;john&#39;, surname: &#39;doe&#39;, timestamp: datetime().epochMillis});\r\nCREATE (:TestSource {name: &#39;mary&#39;, surname: &#39;doe&#39;, timestamp: datetime().epochMillis});\r\nCREATE (:TestSource {name: &#39;jack&#39;, surname: &#39;small&#39;, timestamp: datetime().epochMillis});\r\n\r\nNow I remove the `ts.timestamp as timestamp` from the return clause.\r\n```\r\nMATCH (ts:TestSource) WHERE ts.timestamp &gt; $lastCheck RETURN ts.name AS name, ts.surname AS surname, $lastCheck as lastCheck\r\n```\r\nThe nodes in the database were deleted, and I inserted them only **once**. The messages in the topic look like this:\r\n\r\n[![Topic after second query][2]][2]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/U58p0.png\r\n  [2]: https://i.stack.imgur.com/DYhyw.png\r\n\r\nThe screenshot only shows the first seven, but these messages are printed infinitely. Sometimes the `$lastCheck` in the topic is also just returned by the second query as `-1`.",
            "link": "https://stackoverflow.com/questions/77403628/kafka-neo4j-connector-lastcheck-not-updating-if-no-timestamp-is-returned",
            "title": "Kafka-Neo4J-Connector: $lastCheck not updating if no timestamp is returned"
        },
        {
            "tags": [
                "docker",
                "docker-compose",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 13863020,
                        "reputation": 136993,
                        "user_id": 10008173,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/bc86d913c15f3b126673faa654e9668c?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "David Maze",
                        "link": "https://stackoverflow.com/users/10008173/david-maze"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1698849948,
                    "answer_id": 77403478,
                    "question_id": 77403423,
                    "body_markdown": "For all that the current Docker documentation shows examples with `version: &#39;3.9&#39;`, that was never actually a [Compose file format version](https://docs.docker.com/compose/compose-file/compose-versioning/).  The most recent numbered versions are `2.4` (with extended plain-Docker options) and `3.8` (with extended Swarm-oriented options) and I&#39;d use one of these.\r\n\r\nDocker states that they no longer support the Python-based Compose 1.x as of June 2023.  The Go-plugin-based Compose 2.x completely ignores the `version:` field, which is why the documentation examples that show `version: &#39;3.9&#39;` apparently work.  (I&#39;ve also seen some SO questions declaring `version: &#39;1.2&#39;` but Compose file format version 1 didn&#39;t support a `version:` field.)  Upgrading to the newer Compose will also make the file you show work.",
                    "title": "Version in &quot;neo4j-uat.yaml&quot; is unsupported. you&#39;re using the wrong Compose file version"
                }
            ],
            "owner": {
                "account_id": 10150295,
                "reputation": 1257,
                "user_id": 7497127,
                "user_type": "registered",
                "accept_rate": 67,
                "profile_image": "https://lh6.googleusercontent.com/-DUakSAslaoA/AAAAAAAAAAI/AAAAAAAADHc/lIAG1nu4vzM/photo.jpg?sz=256",
                "display_name": "JAMSHAID",
                "link": "https://stackoverflow.com/users/7497127/jamshaid"
            },
            "is_answered": true,
            "view_count": 19,
            "favorite_count": 0,
            "accepted_answer_id": 77403478,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698849495,
            "question_id": 77403423,
            "body_markdown": "I am trying to run the following docker-compose file but it always ends up with an error:\r\n\r\n    version: &#39;3.9&#39;\r\n\r\n\tservices:\r\n\t  neo4j:\r\n\t    image: neo4j:5.8\r\n\t    container_name: cybersage-neo4j\r\n\t    hostname: neo4j\r\n\t    user: 501:20 \r\n\t    ports:\r\n\t      - &#39;0.0.0.0:9001:7474&#39;\r\n\t      - &#39;0.0.0.0:9002:7687&#39;\r\n\t    volumes:\r\n\t      - ./neo4j-config:/config\r\n\t      - ./neo4j-data:/data:rw\r\n\t      - ./neo4j-plugins:/plugins:rw\r\n\t    environment:\r\n\t      - NEO4J_server_memory_pagecache_size=1G\r\n\t      - NEO4J_AUTH=neo4j/admin12345678\r\n\t      - NEO4J_apoc_export_file_enabled=true\r\n\t      - NEO4J_apoc_import_file_enabled=true\r\n\t      - NEO4J_apoc_import_file_use__neo4j__config=true\r\n\t      - NEO4JLABS_PLUGINS=\\[\\&quot;apoc\\&quot;\\] \\\r\n\t      - NEO4J_dbms_security_procedures_unrestricted=apoc.\\\\\\*\r\n\r\n\r\nMy docker-compose version is: **docker-compose version 1.25.0, build 0a186604**. Here is how I am trying to run it: \r\n    \r\nsudo docker-compose -f neo4j-uat.yaml up -d\r\n\r\n    ERROR: Version in &quot;./neo4j-uat.yaml&quot; is unsupported. You might be seeing this error because you&#39;re using the wrong Compose file version. \r\n    Either specify a supported version (e.g &quot;2.2&quot; or &quot;3.3&quot;) and place your service definitions under the `services` key, or omit the `version` key \r\n    and place your service definitions at the root of the file to use version 1.\r\n\tFor more on the Compose file format versions, see https://docs.docker.com/compose/compose-file/\r\n\r\nThis error appears if I remove the version from my docker-compose file:    \r\n    \r\n    ERROR: The Compose file &#39;./neo4j-uat.yaml&#39; is invalid because:\r\n    Unsupported config option for services: &#39;neo4j&#39;\r\n",
            "link": "https://stackoverflow.com/questions/77403423/version-in-neo4j-uat-yaml-is-unsupported-youre-using-the-wrong-compose-file",
            "title": "Version in &quot;neo4j-uat.yaml&quot; is unsupported. you&#39;re using the wrong Compose file version"
        },
        {
            "tags": [
                "neo4j",
                "version",
                "upgrade"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1150864,
                        "reputation": 1160,
                        "user_id": 1132615,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/6XRH8.png?s=256&g=1",
                        "display_name": "nmervaillie",
                        "link": "https://stackoverflow.com/users/1132615/nmervaillie"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1699003394,
                    "answer_id": 77415493,
                    "question_id": 77402233,
                    "body_markdown": "I frequently use `neo4j-admin copy` to migrate databases, and it works really well.\r\n\r\nIt recreates a fresh copy of your existing DB into the target format of the new Neo4j version.\r\n\r\nThere is a tutorial describing how to use it to migrate from `3.5` to `4.x`. That works the same way for `4.2` to `4.4` :\r\nhttps://neo4j.com/docs/upgrade-migration-guide/current/version-4/tutorials/online-backup-copy-database/\r\n\r\n**Update**: this ^^ works only for with the enterprise edition. With the community edition, you can upgrade 4.2 -&gt; 4.3 -&gt; 4.4 using a 4.3 community version downloadable [here][1].\r\n\r\n\r\n  [1]: https://neo4j.com/download-thanks/?edition=community&amp;release=4.3.23&amp;flavour=winzip",
                    "title": "Can I upgrade Neo4j from version 4.2.4 straight to version 4.4.26?"
                }
            ],
            "owner": {
                "account_id": 13528888,
                "reputation": 13,
                "user_id": 9759943,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/e4c002283ee40e336315b7eb07a6bb28?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "user9759943",
                "link": "https://stackoverflow.com/users/9759943/user9759943"
            },
            "is_answered": true,
            "view_count": 43,
            "favorite_count": 0,
            "accepted_answer_id": 77415493,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1698837667,
            "question_id": 77402233,
            "body_markdown": "I have neo4j Community edition installed on Windows, currently version 4.2.4 and need to upgrade it. The neo4j documentation suggests 4.2 -&gt; 4.3 -&gt; 4.4 but the only version 4 available to download is now 4.4.26\r\n\r\nThe upgrade instructions are the same, can I just follow them but jump from 4.2 to 4.4?\r\n\r\nhttps://neo4j.com/docs/upgrade-migration-guide/current/version-4/understanding-upgrades-migration/\r\n\r\n",
            "link": "https://stackoverflow.com/questions/77402233/can-i-upgrade-neo4j-from-version-4-2-4-straight-to-version-4-4-26",
            "title": "Can I upgrade Neo4j from version 4.2.4 straight to version 4.4.26?"
        },
        {
            "tags": [
                "graph",
                "neo4j",
                "cypher",
                "graph-data-science"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1698971254,
                    "answer_id": 77413581,
                    "question_id": 77396899,
                    "body_markdown": "You have set the `undirectedRelationshipTypes` incorrectly. Use the following instead:\r\n\r\n```\r\nMATCH (src:Subnet)-[r:SUB_OF|CONNECT_TO]-&gt;(trg:Network|TGW)\r\nRETURN gds.graph.project(\r\n  &#39;cypherGraph10&#39;,\r\n  src,\r\n  trg,\r\n  {relationshipType: type(r)},\r\n  {undirectedRelationshipTypes: [&#39;*&#39;]})\r\n```\r\n\r\nThe problem lay with you setting the `undirectedRelationshipTypes` dynamically. The graph projection will only set to undirected those relationships that have the type to whatever value `type(r)` has for its first invocation i.e. the type of the relationship `r` in whatever happens to be the first record from the `MATCH` clause. For example, if the first record happens to have relationship with type `SUB_OF`, then only those relationships will be undirected in the projection.\r\n\r\nThe reason this matters is that APSP will only traverse directed relationships following their direction. If you look at your graph, if all the `CONNECT_TO` relationships were directed, then the graph would be partitioned at the green `TGW` nodes:\r\n\r\n[![enter image description here][1]][1]\r\n\r\nAnd in that case, you will get no paths connecting sub2 to sub6.   \r\n\r\n\r\n  [1]: https://i.stack.imgur.com/nObiC.png",
                    "title": "Why is All Pairs Shortest Paths not finding some paths between subnets?"
                }
            ],
            "owner": {
                "account_id": 29770823,
                "reputation": 11,
                "user_id": 22816114,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocKPe1CbLAdQKQvw37pP4bzZb2sxMWyqTBP8Vy1iX2Hh=k-s256",
                "display_name": "Sur",
                "link": "https://stackoverflow.com/users/22816114/sur"
            },
            "is_answered": true,
            "view_count": 45,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1698763633,
            "question_id": 77396899,
            "body_markdown": "For example In my case there should be path from sub2 to sub6 and sub2 to sub8, sub2 to tgw2 etc.. But I am not getting any of these paths. \r\n\r\nMy data:\r\n\r\n```\r\nCREATE \r\n(s1:Subnet{name:&quot;sub1&quot;}),\r\n(s2:Subnet{name:&quot;sub2&quot;}),\r\n(s3:Subnet{name:&quot;sub3&quot;}),\r\n(s4:Subnet{name:&quot;sub4&quot;}),\r\n(n1:Network{name:&quot;net1&quot;}),\r\n(s1)-[:SUB_OF]-&gt; (n1),\r\n(s3)-[:SUB_OF]-&gt; (n1),\r\n(s2)-[:SUB_OF]-&gt; (n1),\r\n(s4)-[:SUB_OF]-&gt; (n1),\r\n(s5:Subnet{name:&quot;sub5&quot;}),\r\n(s6:Subnet{name:&quot;sub6&quot;}),\r\n(s7:Subnet{name:&quot;sub7&quot;}),\r\n(s8:Subnet{name:&quot;sub8&quot;}),\r\n(n2:Network{name:&quot;net2&quot;}),\r\n(t1:TGW{name:&quot;tgw1&quot;}),\r\n(t2:TGW{name:&quot;tgw2&quot;}),\r\n(s5)-[:SUB_OF]-&gt; (n2),\r\n(s6)-[:SUB_OF]-&gt; (n2),\r\n(s7)-[:SUB_OF]-&gt; (n2),\r\n(s8)-[:SUB_OF]-&gt; (n2),\r\n(s5)-[:CONNECT_TO]-&gt;(t1),\r\n(s3)-[:CONNECT_TO]-&gt;(t1),\r\n(s4)-[:CONNECT_TO]-&gt;(t2),\r\n(s8)-[:CONNECT_TO]-&gt;(t2);\r\n```\r\nmy Projection is:\r\n```\r\nMATCH (src:Subnet)-[r:SUB_OF | CONNECT_TO]-&gt;(trg:Network|TGW)\r\nRETURN gds.graph.project(\r\n  &#39;cypherGraph10&#39;,\r\n  src,\r\n  trg,\r\n  {relationshipType: type(r)},\r\n  {undirectedRelationshipTypes: [type(r)]\r\n})\r\n```\r\nI am not getting all y\\my answers after trying this:\r\n\r\n```\r\nCALL gds.allShortestPaths.stream(&#39;cypherGraph10&#39;) YIELD sourceNodeId, targetNodeId, distance\r\nWHERE gds.util.isFinite(distance) AND sourceNodeId &lt;&gt; targetNodeId\r\nWITH gds.util.asNode(sourceNodeId) AS source, gds.util.asNode(targetNodeId) AS target, distance\r\nWHERE NONE(n IN [source, target] WHERE n:Network|TGW)\r\nRETURN source.name AS source, target.name AS target, distance\r\nORDER BY distance DESC, source ASC, target ASC\r\n```",
            "link": "https://stackoverflow.com/questions/77396899/why-is-all-pairs-shortest-paths-not-finding-some-paths-between-subnets",
            "title": "Why is All Pairs Shortest Paths not finding some paths between subnets?"
        },
        {
            "tags": [
                "neo4j",
                "spring-data-neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 28282947,
                        "reputation": 86,
                        "user_id": 21624328,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxZzl1uvGNT2Zj90oWIgnDozeOoiJzA7-rJgem4f=k-s256",
                        "display_name": "Christoffer Bergman",
                        "link": "https://stackoverflow.com/users/21624328/christoffer-bergman"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698764341,
                    "answer_id": 77396986,
                    "question_id": 77396698,
                    "body_markdown": "You must have parentheses around the nodes in the match, so it should be like this:\r\n\r\n    match (n:Yonetmen)\r\n    where n.title=&quot;Stephen King&quot;\r\n    match (n)-[:WRITE]-&gt;(Movie)\r\n    return Movie ",
                    "title": "Neo4j Invalid input &#39;n&#39;: expected &quot;(&quot;, &quot;ALL&quot;, &quot;ANY&quot; or &quot;SHORTEST&quot;)"
                }
            ],
            "owner": {
                "account_id": 28060178,
                "reputation": 13,
                "user_id": 21434477,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxavAhgFSTHx-fPBkVbjtkl7To8XivZnFLcHtWig=k-s256",
                "display_name": "gizem tangalay",
                "link": "https://stackoverflow.com/users/21434477/gizem-tangalay"
            },
            "is_answered": false,
            "view_count": 37,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698761820,
            "question_id": 77396698,
            "body_markdown": "I have a database that I created with the following codes. \r\n\r\n\r\n```\r\nLOAD CSV WITH HEADERS FROM &#39;FilmData.csv&#39; AS line\r\nMERGE (n:Movie{title:line.Film_Adi_TR,yabanci_isim:coalesce(line.Film_Adi_Yabanci,&quot;Yabancı İsim Yok&quot;),released:line.Vizyon_Tarihi,numberOfAudience:line.Seyirci_Sayisi,TotalRevenue:line.Toplam_Hasilat,IMDb:line.IMDb,Screening_Week:line.Gosterim_Hafta,CountryOfManufacture:line.Yapimci_Ulke}) \r\nWITH n, split(line.Yapimci,&quot;,&quot;) as manufacturers, split(line.Yonetmen,&quot;,&quot;) as directors,split(line.Film_Turu,&quot;,&quot;) as genres,split(line.Oyuncular,&quot;,&quot;) as players\r\nUNWIND manufacturers as m\r\nUNWIND directors as d\r\nUNWIND genres as g\r\nUNWIND players as p\r\nMERGE (y:Yapimci{title: m}) \r\nMERGE (yntmn:Yonetmen{title: d})\r\nMERGE (gnrs:Film_Turu{title: g})\r\nMERGE (o:Oyuncular{title: p})\r\nMERGE (n)-[:Yapımcı]-&gt;(y)\r\nMERGE (n)-[:Y&#246;netmen]-&gt;(yntmn)\r\nMERGE (n)-[:FilmT&#252;r&#252;]-&gt;(gnrs)\r\nMERGE (n)-[:Oyuncusu]-&gt;(o)\r\n```\r\n\r\nI want to list movies directed by the same director, but I&#39;m getting an error. Can you help me?\r\n```\r\nmatch (n:Yonetmen)\r\nwhere n.title=&quot;Stephen King&quot;\r\nmatch n-[:WRITE]-&gt;Movie\r\nreturn Movie \r\n```\r\n\r\nNeo.ClientError.Statement.SyntaxError\r\nInvalid input &#39;n&#39;: expected &quot;(&quot;, &quot;ALL&quot;, &quot;ANY&quot; or &quot;SHORTEST&quot; (line 3, column 7 (offset: 54))\r\n&quot;match n-[:WRITE]-&gt;Movie&quot;\r\n       ^\r\n\r\n\r\nI&#39;m new to Neo4j and I couldn&#39;t solve the problem.",
            "link": "https://stackoverflow.com/questions/77396698/neo4j-invalid-input-n-expected-all-any-or-shortest",
            "title": "Neo4j Invalid input &#39;n&#39;: expected &quot;(&quot;, &quot;ALL&quot;, &quot;ANY&quot; or &quot;SHORTEST&quot;)"
        },
        {
            "tags": [
                "neo4j",
                "knowledge-graph"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1698775163,
                    "answer_id": 77398164,
                    "question_id": 77395340,
                    "body_markdown": "[As documented](https://neo4j.com/docs/bloom-user-guide/current/bloom-visual-tour/legend-panel/#_default_styling), you now set the properties to display in Bloom in the `Legend Panel`&#39;s `Text` tab.\r\n\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/RaItD.png",
                    "title": "How to change caption of nodes from nodetype to fully specified name property?"
                }
            ],
            "owner": {
                "account_id": 24863022,
                "reputation": 13,
                "user_id": 18738502,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AATXAJxMp4AsfMhUoKEfk3dmkzjnZ-M3q7AqnxTUDhN7=k-s256",
                "display_name": "Jos&#233; Luis Neves",
                "link": "https://stackoverflow.com/users/18738502/jos%c3%a9-luis-neves"
            },
            "is_answered": true,
            "view_count": 24,
            "favorite_count": 0,
            "accepted_answer_id": 77398164,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698750271,
            "question_id": 77395340,
            "body_markdown": "I am working with Snomed in Neo4j bloom. \r\nI used the steps from the tutorial https://medium.com/@john.newberry27/populating-a-snomed-ct-property-graph-with-synthetic-patient-data-a43a3a044649 to create the graph database. However, there is a step in the tutorial to change what property nodes use as caption in neo4j bloom that is represented in the following image:\r\n[![enter image description here][1]][1]\r\n\r\n\r\nHowever, following the same steps and going into the same location, I find only the option to exclude:[![enter image description here][2]][2]\r\n\r\nI am using the neo4j 2.10.1 version. Anybody has any ideas about why this is the case?\r\n\r\n  [1]: https://i.stack.imgur.com/9ZkXL.png\r\n  [2]: https://i.stack.imgur.com/OBf5w.png",
            "link": "https://stackoverflow.com/questions/77395340/how-to-change-caption-of-nodes-from-nodetype-to-fully-specified-name-property",
            "title": "How to change caption of nodes from nodetype to fully specified name property?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 55989,
                        "reputation": 17809,
                        "user_id": 167745,
                        "user_type": "registered",
                        "accept_rate": 76,
                        "profile_image": "https://i.stack.imgur.com/wBebv.jpg?s=256&g=1",
                        "display_name": "Stewart",
                        "link": "https://stackoverflow.com/users/167745/stewart"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698750817,
                    "answer_id": 77395391,
                    "question_id": 77395141,
                    "body_markdown": "Both queries have a `LIMIT 10`, but the second query is not qualified by any `WHERE` clause, so it can simply return you the first 10 it finds.\r\n\r\nIt just finds 10 and stops.\r\n\r\nThe first query, with the additional `WHERE`, means your returned 10 *must* have a path length &gt; 3, which means it must traverse all the shorter paths and discard them, keeping track in memory of the paths it has tried. You are only looking for the longer paths. So it is simply more computation effort. And maybe more computation effort than we have patience for waiting.\r\n\r\n",
                    "title": "Why does this neo4j query not finish?"
                },
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698751612,
                    "answer_id": 77395476,
                    "question_id": 77395141,
                    "body_markdown": "The [answer][1] by Stewart correctly answers your question as to why the `WHERE` changes the performance. \r\n\r\nBut to actually improve the performance of your first query, move the criteria into the lower bound for the length of paths matched:\r\n```\r\nMATCH path = (start:A)-[*4..]-&gt;(end:A)\r\nWHERE start.fen = &#39;abc&#39;\r\nWITH DISTINCT path AS distinct_path\r\nRETURN distinct_path\r\nLIMIT 10\r\n```\r\n\r\n\r\n  [1]: https://stackoverflow.com/a/77395391/2258090",
                    "title": "Why does this neo4j query not finish?"
                }
            ],
            "owner": {
                "account_id": 1108171,
                "reputation": 6225,
                "user_id": 1099123,
                "user_type": "registered",
                "accept_rate": 55,
                "profile_image": "https://www.gravatar.com/avatar/41f5144169c49d431963661b24fa918d?s=256&d=identicon&r=PG",
                "display_name": "user1099123",
                "link": "https://stackoverflow.com/users/1099123/user1099123"
            },
            "is_answered": false,
            "view_count": 24,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 1,
            "creation_date": 1698748502,
            "question_id": 77395141,
            "body_markdown": "The following doesn&#39;t finish\r\n\r\n    MATCH path = (start:A)-[*]-&gt;(end:A)\r\n    WHERE start.fen = &#39;abc&#39;\r\n    WITH distinct path as distinct_path\r\n    WHERE length(distinct_path) &gt; 3\r\n    return distinct_path\r\n    LIMIT 10\r\n\r\nBut when removing the WHERE clause, it returns\r\n\r\n    MATCH path = (start:A)-[*]-&gt;(end:A)\r\n    WHERE start.fen = &#39;abc&#39;\r\n    WITH distinct path as distinct_path\r\n    return distinct_path\r\n    LIMIT 10\r\n\r\nWhat about the WHERE clause makes it not finish?",
            "link": "https://stackoverflow.com/questions/77395141/why-does-this-neo4j-query-not-finish",
            "title": "Why does this neo4j query not finish?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698684079,
                    "answer_id": 77390440,
                    "question_id": 77390261,
                    "body_markdown": "Since your query did not return any nodes, relationships, or paths, no *graph visualization* is possible.\r\n\r\nFor example, if you want the Neo4j Browser to display the `a` nodes in a graph visualization, your `RETURN` clause will also have to include `a` as a term (not just `a.name`, which is only a string property and not the entire node). ",
                    "title": "How to graph relationships between movies and actors (that they performed in common) in Neo4J movies database?"
                }
            ],
            "owner": {
                "account_id": 26720743,
                "reputation": 3,
                "user_id": 20324642,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/4f67d7aefbf897789708d8ab5899e992?s=256&d=identicon&r=PG",
                "display_name": "Tadeo",
                "link": "https://stackoverflow.com/users/20324642/tadeo"
            },
            "is_answered": false,
            "view_count": 36,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698682380,
            "question_id": 77390261,
            "body_markdown": "I have a custom CSV with movies data with the following strucuture:\r\n\r\n    id,title,media_type,original_language,actor\r\n    1002185.0,A Million Miles Away,movie,en,Emma Fassler\r\n    447332.0,A Quiet Place,movie,en,Noah Jupe\r\n\r\nand i want to graph in neo4j the actors (names) that share one or more movies (title) between each other, the code where i load the data:\r\n\r\n    LOAD CSV WITH HEADERS FROM &quot;file:///movies_neo_graph/part-00000-c5c5507e-5501-4adb-87fc-38be1d908076-c000.csv&quot; AS row\r\n    CREATE (m:Movie)\r\n    SET m = row,\r\n    m.id = toInteger(row.id),\r\n    m.title = toString(row.title),\r\n    m.language = toString(row.original_language);\r\n    \r\n    LOAD CSV WITH HEADERS FROM &quot;file:///movies_neo_graph/part-00000-c5c5507e-5501-4adb-87fc-38be1d908076-c000.csv&quot; AS row\r\n    CREATE (a:Actor)\r\n    SET a = row,\r\n    a.name = toString(row.actor),\r\n    a.movie_id = toInteger(row.id);\r\n\r\nThen I setup the relationship between nodes Movie and Actor:\r\n\r\n    MATCH (a:Actor),(m:Movie)\r\n    WHERE a.movie_id = m.id\r\n    CREATE (a)-[:ACTED_IN]-&gt;(m);\r\n\r\nThis is my first time in Neo4J and i don&#39;t know how to perform the query, i tried with\r\n\r\n    MATCH (a:Actor)-[:ACTED_IN]-&gt;(m:Movie) \r\n    RETURN a.name AS actor, COLLECT(DISTINCT m.title) AS movies_acted, COUNT(m.title) AS movies_cnt\r\n    ORDER BY movies_cnt DESC\r\n    LIMIT 50;\r\n\r\nAnd the result is a table but not a graph:\r\n\r\n![Neo4J query table][1]\r\n\r\n  [1]: https://i.stack.imgur.com/Sa20k.png\r\n\r\nAny ideas? really appreciate the help",
            "link": "https://stackoverflow.com/questions/77390261/how-to-graph-relationships-between-movies-and-actors-that-they-performed-in-com",
            "title": "How to graph relationships between movies and actors (that they performed in common) in Neo4J movies database?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1698683528,
                    "answer_id": 77390382,
                    "question_id": 77389501,
                    "body_markdown": "You can use the APOC procedure [`apoc.do.when`](https://neo4j.com/labs/apoc/4.2/overview/apoc.do/apoc.do.when/) to do conditional if-then-else writes. There is also a more general procedure, [`apoc.do.case`](https://neo4j.com/labs/apoc/4.2/overview/apoc.do/apoc.do.case/) for more complex conditional writes.\r\n\r\nFor example:\r\n\r\n    CREATE (u:User)-[v:VOTES_ON {points: $points}]-&gt;(i:Item)\r\n    WITH u, v, i\r\n    CALL apoc.do.when(\r\n      $points &gt; 0,\r\n      &#39;SET i.points_up = COALESCE(i.points_up, 0) + points RETURN i&#39;,\r\n      &#39;SET i.points_down = COALESCE(i.points_down, 0) + points RETURN i&#39;,\r\n      { i: i, points: $points }\r\n    )\r\n    YIELD value AS _\r\n    SET i.points = COALESCE(i.points, 0) + $points\r\n    RETURN u, v, i\r\n\r\n(Note the `RETURN i` statement in the `apoc.do.when` call, so that we get back the value and then return it later on.)",
                    "title": "How to Conditionally SET in Cypher depending on parameter?"
                }
            ],
            "owner": {
                "account_id": 3348911,
                "reputation": 6259,
                "user_id": 4756173,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/0e50f7e8bb3963d1dc749e278c3d8d33?s=256&d=identicon&r=PG",
                "display_name": "Philippe Fanaro",
                "link": "https://stackoverflow.com/users/4756173/philippe-fanaro"
            },
            "is_answered": true,
            "view_count": 35,
            "favorite_count": 0,
            "accepted_answer_id": 77390382,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698676214,
            "question_id": 77389501,
            "body_markdown": "When voting on a node, I would like to register the points related to the vote. However, I would also like to keep track, in separate properties, of the amount of negative and positive points.\r\n\r\nHere&#39;s a sketch of what I&#39;m trying to achieve, even though it doesn&#39;t work:\r\n\r\n```cypher\r\nCREATE   (u:User)\r\n        -[v:VOTES_ON{ points: $points }]\r\n       -&gt;(i:Item)\r\n\r\nCASE\r\n  WHEN $points &gt; 0 SET i.points_up = COALESCE(i.points_up, 0) + $points\r\n  ELSE SET i.points_down = COALESCE(i.points_down, 0) + $points\r\n\r\nSET i.points = COALESCE(i.points, 0) + $points\r\n       \r\nRETURN u, v, i\r\n```\r\n\r\n(I&#39;m using Neo4j&#39;s JavaScript&#39;s driver, that&#39;s the reason for `$points`.)\r\n\r\nIs there a way of doing this in Cypher?",
            "link": "https://stackoverflow.com/questions/77389501/how-to-conditionally-set-in-cypher-depending-on-parameter",
            "title": "How to Conditionally SET in Cypher depending on parameter?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1698681881,
                    "answer_id": 77390212,
                    "question_id": 77385680,
                    "body_markdown": "In a `WITH` or `RETURN` clause, an [aggregating function](https://neo4j.com/docs/cypher-manual/current/functions/aggregating/) (like [COLLECT](https://neo4j.com/docs/cypher-manual/current/functions/aggregating/#functions-collect)) aggregates over the [grouping keys](https://neo4j.com/docs/cypher-manual/current/functions/aggregating/#grouping-keys) (i.e., non-aggregating expressions) in the same clause.\r\n\r\nTherefore:\r\n\r\n 1. In `WITH p1, p2, interest, COUNT(interest) AS conto`:\r\n    - `conto` is the number of `interest` nodes associated with each unique set of `p1`, `p2`, and `interest` values.\r\n 2. In `RETURN p1.name, p2.name, COUNT(interest), conto, COLLECT(interest.name) AS interessi`:\r\n    - `COUNT(interest)` is the number of `interest` nodes associated with each unique set of `p1.name`, `p2.name`, and `conto` values.\r\n    - `interessi` is a collection of `interest.name` values associated with each unique set of `p1.name`, `p2.name`, and `conto` values.\r\n\r\nIn summary, since #1 and #2 have different grouping keys, the `COUNT(interest`) values are different as well.\r\n ",
                    "title": "Cypher queries: misuse of the with clause"
                }
            ],
            "owner": {
                "account_id": 17566884,
                "reputation": 259,
                "user_id": 12743491,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/1420615ac458d23777a7d31172c467db?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Jenny",
                "link": "https://stackoverflow.com/users/12743491/jenny"
            },
            "is_answered": true,
            "view_count": 23,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698625736,
            "question_id": 77385680,
            "body_markdown": "I am now starting approaching Cypher and I have probably a trivial question; so i provide an example query to make you understand what i mean:\r\n\r\n    match (p1:Person)-[:works_on]-&gt;(project1:Project), (p2:Person)-[:works_on]-&gt;(project2:Project), (p1)-[:interested_in]-&gt;(interest:Skill)&lt;-[:interested_in]-(p2)\r\n    where id(p1)&gt;id(p2) \r\n    with p1,p2, interest, count(interest) as conto\r\n    return p1.name, p2.name, count(interest) ,conto,  collect(interest.name) as interessi\r\n\r\nresults:\r\n\r\n    ╒════════╤═════════╤═══════════════╤═════╤══════════════════════════╕\r\n    │p1.name │p2.name  │count(interest)│conto│interessi                 │\r\n    ╞════════╪═════════╪═══════════════╪═════╪══════════════════════════╡\r\n    │&quot;Sarah&quot; │&quot;Charlie&quot;│1              │2    │[&quot;DBMS&quot;]                │\r\n    ├────────┼─────────┼───────────────┼─────┼──────────────────────────┤\r\n    │&quot;Sarah&quot; │&quot;Ben&quot;    │2              │2    │[&quot;DBMS&quot;, &quot;TRAVEL&quot;]        │\r\n    ├────────┼─────────┼───────────────┼─────┼──────────────────────────┤\r\n    │&quot;Ben&quot;   │&quot;Charlie&quot;│1              │1    │[&quot;DBMS&quot;]                │\r\n    ├────────┼─────────┼───────────────┼─────┼──────────────────────────┤\r\n    │&quot;Arnold&quot;│&quot;Sarah&quot;  │3              │2    │[&quot;TRAVEL&quot;, &quot;JAVA&quot;, &quot;DBMS&quot;]│\r\n    ├────────┼─────────┼───────────────┼─────┼──────────────────────────┤\r\n    │&quot;Arnold&quot;│&quot;Ben&quot;    │2              │1    │[&quot;TRAVEL&quot;, &quot;DBMS&quot;]        │\r\n    ├────────┼─────────┼───────────────┼─────┼──────────────────────────┤\r\n    │&quot;Arnold&quot;│&quot;Charlie&quot;│1              │1    │[&quot;DBMSs&quot;]                │\r\n\r\nThe thing I&#39;d like to understand is why the 2 columns `count(interest)` and `conto` differ. Why? what is the latter actually counting?",
            "link": "https://stackoverflow.com/questions/77385680/cypher-queries-misuse-of-the-with-clause",
            "title": "Cypher queries: misuse of the with clause"
        },
        {
            "tags": [
                "neo4j",
                "raft",
                "ongdb"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 13214861,
                        "reputation": 41,
                        "user_id": 9543759,
                        "user_type": "registered",
                        "profile_image": "https://lh4.googleusercontent.com/-1U732aa62rs/AAAAAAAAAAI/AAAAAAAAABU/Q2RdKahyOYE/photo.jpg?sz=256",
                        "display_name": "Prathibha Nag",
                        "link": "https://stackoverflow.com/users/9543759/prathibha-nag"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698727375,
                    "answer_id": 77393259,
                    "question_id": 77383547,
                    "body_markdown": "This is resolved. \r\nI had added one node at a time to the cluster so the first added node missed the new node IPs in the config. After adding all nodes in the current cluster, and restarting the neo4j server, the cluster was up.",
                    "title": "neo4j ongdb: Member is not getting added to cluster after restart"
                }
            ],
            "owner": {
                "account_id": 13214861,
                "reputation": 41,
                "user_id": 9543759,
                "user_type": "registered",
                "profile_image": "https://lh4.googleusercontent.com/-1U732aa62rs/AAAAAAAAAAI/AAAAAAAAABU/Q2RdKahyOYE/photo.jpg?sz=256",
                "display_name": "Prathibha Nag",
                "link": "https://stackoverflow.com/users/9543759/prathibha-nag"
            },
            "is_answered": false,
            "view_count": 15,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698586906,
            "question_id": 77383547,
            "body_markdown": "I have restarted one of the CORE nodes of the cluster and it is unable to join the cluster.\r\nSeeing the following in logs:\r\n\r\n&gt; 2023-10-29 13:12:46.904+0000 INFO\r\n&gt; [o.n.c.d.SecureHazelcastCoreTopologyService] Discovering other core\r\n&gt; members in initial members set: [10.195.83.231:5000] 2023-10-29\r\n&gt; 13:12:47.071+0000 INFO [o.n.c.c.c.l.s.RecoveryProtocol] Skipping from\r\n&gt; index -1 to 1. 2023-10-29 13:12:47.089+0000 INFO\r\n&gt; [o.n.c.c.c.l.s.SegmentedRaftLog] log started with recovered state\r\n&gt; State{prevIndex=0, prevTerm=0, appendIndex=26} 2023-10-29\r\n&gt; 13:12:47.093+0000 INFO [o.n.c.c.c.m.RaftMembershipManager] Membership\r\n&gt; state before recovery:\r\n&gt; RaftMembershipState{committed=MembershipEntry{logIndex=26,\r\n&gt; members=[MemberId{f4425d42}, MemberId{eee36e32}, MemberId{456f7b24}]},\r\n&gt; appended=null, ordinal=10} 2023-10-29 13:12:47.093+0000 INFO\r\n&gt; [o.n.c.c.c.m.RaftMembershipManager] Recovering from: 26 to: 26\r\n&gt; 2023-10-29 13:12:47.096+0000 WARN [o.n.c.c.c.m.RaftMembershipManager]\r\n&gt; Appending member set was ignored. Current state:\r\n&gt; RaftMembershipState{committed=MembershipEntry{logIndex=26,\r\n&gt; members=[MemberId{f4425d42}, MemberId{eee36e32}, MemberId{456f7b24}]},\r\n&gt; appended=null, ordinal=10}, Appended set: MemberIdSet{\r\n&gt; members=[MemberId{f4425d42}, MemberId{eee36e32}, MemberId{456f7b24}]},\r\n&gt; Log index: 26\r\n&gt; \r\n&gt; 2023-10-29 13:12:47.096+0000 INFO [o.n.c.c.c.m.RaftMembershipManager]\r\n&gt; Membership state after recovery:\r\n&gt; RaftMembershipState{committed=MembershipEntry{logIndex=26,\r\n&gt; members=[MemberId{f4425d42}, MemberId{eee36e32}, MemberId{456f7b24}]},\r\n&gt; appended=null, ordinal=10} 2023-10-29 13:12:47.096+0000 INFO\r\n&gt; [o.n.c.c.c.m.RaftMembershipManager] Target membership: [] 2023-10-29\r\n&gt; 13:12:47.233+0000 INFO [o.n.c.n.Server] raft-server: bound to\r\n&gt; 10.195.83.231:7000 2023-10-29 13:12:48.301+0000 INFO [o.n.c.p.h.HandshakeServerInitializer] Installing handshake server\r\n&gt; local /10.195.83.231:7000 remote /10.195.83.187:52944 2023-10-29\r\n&gt; 13:12:48.525+0000 INFO [o.n.c.p.h.HandshakeServerInitializer]\r\n&gt; Installing handshake server local /10.195.83.231:7000 remote\r\n&gt; /10.195.83.187:52956 2023-10-29 13:12:48.560+0000 INFO\r\n&gt; [o.n.c.p.h.HandshakeServerInitializer] Installing handshake server\r\n&gt; local /10.195.83.231:7000 remote /10.195.83.219:44370 2023-10-29\r\n&gt; 13:22:46.907+0000 WARN [o.n.c.d.SecureHazelcastCoreTopologyService]\r\n&gt; The server has not been able to connect in a timely fashion to the\r\n&gt; cluster. Please consult the logs for more details. Rebooting the\r\n&gt; server may solve the problem.\r\n\r\n",
            "link": "https://stackoverflow.com/questions/77383547/neo4j-ongdb-member-is-not-getting-added-to-cluster-after-restart",
            "title": "neo4j ongdb: Member is not getting added to cluster after restart"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1698433887,
                    "answer_id": 77376560,
                    "question_id": 77376071,
                    "body_markdown": "Your main problem is that relationships always have 1 and only 1 type. You need to reconsider how to carry out your use case.\r\n\r\nI also have a lot of observations.\r\n\r\n 1. `X` and `Y` are not defined, so queries 1 and 2 would fail anyway.\r\n 2. You are incorrectly using the term &quot;label&quot;, which only applies to nodes (for example, `c` has the label `Companies`). Every relationship has **1 and only 1** &quot;type&quot;.\r\n 3. The `SET` clause syntaxes you used are only for copying *properties*, not node labels or relationship types. In fact, you cannot change a relationship instance&#39;s type, so there is no way to do that in Cypher.\r\n 4. Your third query is missing a `SET` clause, which I assume was accidentally omitted from your question.\r\n 5. For better performance, filtering should always be done as soon as possible (like, right after the relevant `MATCH`).\r\n    - Option 1: move the `c.CompanyID = 477` test immediately after `MATCH\r\n    (c:Companies)-[r:Rel_Office]-(o:Companies)`.\r\n    - Option 2, combine the 2 `MATCH` clauses, like this: `MATCH (c:Companies)-[r:Rel_Office]-(o:Companies), (n:Companies)`\r\n\r\n",
                    "title": "Neo4j/cypher - copy relationship labels to another"
                },
                {
                    "owner": {
                        "account_id": 9963444,
                        "reputation": 12317,
                        "user_id": 7371893,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=256&g=1",
                        "display_name": "jose_bacoy",
                        "link": "https://stackoverflow.com/users/7371893/jose-bacoy"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1698434356,
                    "answer_id": 77376601,
                    "question_id": 77376071,
                    "body_markdown": "Your question can be treated as &quot;copy or duplicate all relationships from : Rel_Office into a new one called : Props.  Thus below query will work.\r\n\r\n    MATCH (c:Companies)-[r:Rel_Office]-(o:Companies)\r\n    MERGE (c)-[rn:Props]-(o)\r\n    SET rn = properties(r)\r\n\r\n [![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/Ziald.png",
                    "title": "Neo4j/cypher - copy relationship labels to another"
                }
            ],
            "owner": {
                "account_id": 4828331,
                "reputation": 3978,
                "user_id": 3897214,
                "user_type": "registered",
                "accept_rate": 56,
                "profile_image": "https://www.gravatar.com/avatar/3f029f1fe1b13872be86f5694bd05c40?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Antony",
                "link": "https://stackoverflow.com/users/3897214/antony"
            },
            "is_answered": true,
            "view_count": 37,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1698428006,
            "question_id": 77376071,
            "body_markdown": "I have done a number of different queries but am trying to copy *all* the relationships between my two nodes `r` to `rn` (where there is a Rel_Office label) but for some reason only the final query here works. I&#39;m using Neo4j Community 5.13.0.\r\n\r\n*Doesn&#39;t work*\r\n\r\n\tMATCH (c:Companies)-[r:Rel_Office]-(o:Companies) \r\n\tMATCH (n:Companies) WHERE c.CompanyID = X AND n.CompanyID = Y\r\n\tMERGE (n)-[rn:Props]-(o) \r\n\tSET rn = properties(r)\r\n\r\n*Doesn&#39;t work*\r\n\r\n\tMATCH (c:Companies)-[r:Rel_Office]-(o:Companies) \r\n\tMATCH (n:Companies) WHERE c.CompanyID = X AND n.CompanyID = Y\r\n\tMERGE (n)-[rn:Props]-(o) \r\n\tSET rn = r\r\n\r\n*Does work but limited to one label!*\r\n\r\n\tMATCH (c:Companies)-[r:Rel_Office]-(o:Companies) \r\n\tMATCH (n:Companies) WHERE c.CompanyID = 477 AND n.CompanyID = 9045\r\n\tMERGE (n)-[rn:Rel_Office]-(o) \r\n\r\n\r\nI suspect its something obvious, but please can someone explain how this should be working to do a full copy of all the labels/properties?",
            "link": "https://stackoverflow.com/questions/77376071/neo4j-cypher-copy-relationship-labels-to-another",
            "title": "Neo4j/cypher - copy relationship labels to another"
        },
        {
            "tags": [
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 376992,
                        "reputation": 41434,
                        "user_id": 728812,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/f522bc835d745f319a9567d63f5c0cc9?s=256&d=identicon&r=PG",
                        "display_name": "Michael Hunger",
                        "link": "https://stackoverflow.com/users/728812/michael-hunger"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1698322520,
                    "answer_id": 77366917,
                    "question_id": 77366735,
                    "body_markdown": "It is visible until you end its scope with a `WITH` statement or `RETURN`.\r\n\r\ne.g.\r\n\r\n    MATCH (p:Person)\r\n    UNWIND [1, 2, 3] AS x\r\n    WITH p // no x behind this WITH\r\n\r\nor keep it visible\r\n\r\n    MATCH (p:Person)\r\n    UNWIND [1, 2, 3] AS x\r\n    WITH p,x // x is still visible after\r\n\r\n",
                    "title": "What is the scope of unwind in neo4j"
                }
            ],
            "owner": {
                "account_id": 29759116,
                "reputation": 13,
                "user_id": 22807132,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocJ5nIZRq7dm3BpCwPgkV6rid5DPxb_dLQ_Mr8tQx3Jy=k-s256",
                "display_name": "Trichian",
                "link": "https://stackoverflow.com/users/22807132/trichian"
            },
            "is_answered": true,
            "view_count": 37,
            "favorite_count": 0,
            "accepted_answer_id": 77366917,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1698320855,
            "question_id": 77366735,
            "body_markdown": "I wanted to know what is the scope of unwind variable?\r\nLike the unwind variable is accessible till where?\r\nI have this question since there is no marking of END for the unwind.\r\n\r\n|e.g|\r\n\r\nIf I have lengthy query, the below x not accessible where\r\nUNWIND [1, 2, 3] AS x\r\n\r\nThanks.\r\n\r\nI want to know where the unwind variable scope ends",
            "link": "https://stackoverflow.com/questions/77366735/what-is-the-scope-of-unwind-in-neo4j",
            "title": "What is the scope of unwind in neo4j"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "spring-data-neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698262486,
                    "answer_id": 77362433,
                    "question_id": 77359271,
                    "body_markdown": "Since your original query returns a path, you can try using [apoc.path.expand](https://neo4j.com/docs/apoc/current/graph-querying/expand-paths/) instead of `apoc.path.subgraphAll`:\r\n\r\n    @Query(&quot;&quot;&quot;\r\n       MATCH (ord:Order {id: $orderId})\r\n       CALL apoc.path.expand(ord, null, null, 0, -1) YIELD path\r\n       RETURN path\r\n    &quot;&quot;&quot;)\r\n    List&lt;Order&gt; getOrders(@Param(&quot;orderId&quot;) Long orderId);\r\n\r\n*NOTE: The above specifies a lower bound of `0`, so a path containing just `ord` would be returned if that node has no relationships, which I think is maybe what you intended. But this behavior is different than your original query&#39;s, which used a (defaulted) lower bound of 1 and would return nothing if `ord` has no relationships. If the latter is what you intended, change my `0` to `1`.*\r\n\r\nAlternatively, if acceptable, a simple workaround would be to limit the length of the variable-length path search. For example, to limit the search to at most 10 hops, you could replace `[*]` with `[*..10]` (or, to use `0` lower bound: `[*0..10]`) in your original query. With my query, use `10` instead of `-1`.",
                    "title": "Running APOC subGraphAll() in Spring Data Neo4j"
                }
            ],
            "owner": {
                "account_id": 9879959,
                "reputation": 421,
                "user_id": 7316385,
                "user_type": "registered",
                "accept_rate": 50,
                "profile_image": "https://www.gravatar.com/avatar/1f73fa9ad138c2a629498256c2d203a8?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Can Cinar",
                "link": "https://stackoverflow.com/users/7316385/can-cinar"
            },
            "is_answered": false,
            "view_count": 19,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1698235120,
            "question_id": 77359271,
            "body_markdown": "I am using Spring Data Neo4j, and trying to execute the following code:\r\n\r\n        @Query(&quot;&quot;&quot;\r\n             MATCH (orders:Order {id:1})\r\n             CALL apoc.path.subgraphAll(orders, {})\r\n             YIELD nodes, relationships\r\n             RETURN  nodes, relationships\r\n            &quot;&quot;&quot;)\r\n    List&lt;Order&gt; getOrders(@Param(&quot;orderId&quot;) Long orderId);\r\n\r\nHowever, it returns only one Order with null fields instead of two with all fields populated.\r\n\r\nBefore, I was using the following code:\r\n\r\n          @Query(&quot;&quot;&quot;\r\n             MATCH path = (orders:Order {id: $orderId})-[*]-(commons)\r\n             RETURN path\r\n            &quot;&quot;&quot;)\r\n    List&lt;Order&gt; getOrders(@Param(&quot;orderId&quot;) Long orderId);\r\n\r\nHowever, it becomes prolonged after adding 10-20 nodes... So I either need to improve this query or somehow make Spring work with APOC procedures.\r\n\r\nI really appreciate it if you could helm me on this matter.\r\n\r\nThank you in advance!\r\n\r\n",
            "link": "https://stackoverflow.com/questions/77359271/running-apoc-subgraphall-in-spring-data-neo4j",
            "title": "Running APOC subGraphAll() in Spring Data Neo4j"
        },
        {
            "tags": [
                "neo4j",
                "neo4j-graphql-js"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698254863,
                    "answer_id": 77361712,
                    "question_id": 77359216,
                    "body_markdown": "That `database` config parameter [does not seem to be documented](https://neo4j.com/docs/api/javascript-driver/current/class/lib6/types.js~Config.html).\r\n\r\nTry following the [documented approach to specifying the database](https://neo4j.com/docs/graphql/current/driver-configuration/#_specifying_the_neo4j_database). That is, specify the database name the server should use when creating driver sessions:\r\n\r\n    await startStandaloneServer(server, {\r\n        context: async ({ req }) =&gt; ({ req, sessionConfig: { database: &quot;mydb_name&quot; }}),\r\n    });",
                    "title": "Error ACCESS on database &#39;neo4j&#39; is not allowed for user on se of neo4j/graphql"
                }
            ],
            "owner": {
                "account_id": 24665125,
                "reputation": 11,
                "user_id": 18560912,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AATXAJxbPYrKiebak2oNRYUAaZO_JBjxuGu0BG9W4JfP=k-s256",
                "display_name": "vetti ",
                "link": "https://stackoverflow.com/users/18560912/vetti"
            },
            "is_answered": false,
            "view_count": 25,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698234696,
            "question_id": 77359216,
            "body_markdown": "I am using this in Apollo GraphQL server:\r\n\r\n    const { Neo4jGraphQL } = require(&#39;@neo4j/graphql&#39;);\r\n\r\nAnd I am getting this error:  `Error  ACCESS on database &#39;neo4j&#39; is not allowed for user myuser`\r\n\r\nBut I am not referring to the `neo4j` database.  I have specified a different DB to the driver: &quot;mydb_name&quot;\r\n\r\n    const driver = neo4j.driver(uri, neo4j.auth.basic(user, password), {\r\n            database: &#39;mydb_name&#39;, // Specify your database name here\r\n        })\r\n\r\nI set the the Home DB of that user to &quot;mydb_name&quot;.\r\n\r\nWhy is th error referring to the `neo4j` DB? How to solve this?\r\n\r\nIf using directly with driver session query that working same with schema then getting error ",
            "link": "https://stackoverflow.com/questions/77359216/error-access-on-database-neo4j-is-not-allowed-for-user-on-se-of-neo4j-graphql",
            "title": "Error ACCESS on database &#39;neo4j&#39; is not allowed for user on se of neo4j/graphql"
        },
        {
            "tags": [
                "python",
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 7348951,
                        "reputation": 1,
                        "user_id": 5595816,
                        "user_type": "registered",
                        "profile_image": "https://lh5.googleusercontent.com/-Sm1ZDFRC7pQ/AAAAAAAAAAI/AAAAAAAAAIo/wv-tNaaDmDU/photo.jpg?sz=256",
                        "display_name": "Samuel Fran&#231;a",
                        "link": "https://stackoverflow.com/users/5595816/samuel-fran%c3%a7a"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698347812,
                    "answer_id": 77369794,
                    "question_id": 77353888,
                    "body_markdown": "Try to use &quot;neo4j+ssc&quot; on the uri like this \r\nURI = &quot;neo4j+ssc://838f9df7.databases.neo4j.io&quot;",
                    "title": "Cannot connect to Neo4j in Python to push data"
                }
            ],
            "owner": {
                "account_id": 24672080,
                "reputation": 29,
                "user_id": 18566978,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a-/AOh14GjAj7isO-roI4iM4ZBFQYV91O-r1pLNJht_JBB6rg=k-s256",
                "display_name": "Benjamin Hammond",
                "link": "https://stackoverflow.com/users/18566978/benjamin-hammond"
            },
            "is_answered": false,
            "view_count": 51,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1698165150,
            "question_id": 77353888,
            "body_markdown": "I am going slightly crazy trying to understand why I can&#39;t push data to my Neo4j database using CYPHER in Python.\r\n\r\nI am running basic testing code just to see if I can push data. Here is my testing code:\r\n\r\n```py\r\nimport logging\r\nfrom neo4j import GraphDatabase\r\n\r\n# Set up logging\r\nlogging.basicConfig(level=logging.DEBUG)  # Change the level to ERROR, WARNING, INFO, or DEBUG as needed\r\nlog = logging.getLogger(&quot;neo4j&quot;)\r\n\r\nclass Neo4jService:\r\n    def __init__(self, uri, user, password):\r\n        self._driver = GraphDatabase.driver(uri, auth=(user, password))\r\n        \r\n    def close(self):\r\n        log.debug(&quot;Closing driver.&quot;)\r\n        self._driver.close()\r\n        \r\n    def run_queries(self, queries):\r\n        log.debug(&quot;Running queries.&quot;)\r\n        with self._driver.session() as session:\r\n            for query in queries:\r\n                log.debug(f&quot;Executing query: {query}&quot;)\r\n                session.run(query)\r\n\r\ntry:\r\n    # Initialize the Neo4j service\r\n    URI = &quot;neo4j+s://838f9df7.databases.neo4j.io&quot;\r\n    AUTH = (&quot;neo4j&quot;, &quot;my_password&quot;)\r\n\r\n    log.info(&quot;Initializing driver.&quot;)\r\n    with GraphDatabase.driver(URI, auth=AUTH) as driver:\r\n        log.info(&quot;Verifying connectivity.&quot;)\r\n        driver.verify_connectivity()\r\n\r\n    summary = driver.execute_query(\r\n        &quot;MERGE (:Person {name: $name})&quot;,\r\n        name=&quot;Alice&quot;,\r\n        database_=&quot;neo4j&quot;,\r\n    ).summary\r\n\r\n    log.info(f&quot;Created {summary.counters.nodes_created} nodes in {summary.result_available_after} ms.&quot;)\r\n\r\nexcept Exception as e:\r\n    log.error(&quot;An error occurred:&quot;, exc_info=True)\r\n```\r\n\r\nWhatever I seem to do, I get an error like this:\r\n\r\n```\r\nneo4j.exceptions.ServiceUnavailable: Unable to retrieve routing information\r\n```\r\n\r\nI have tried manually telling the Neo4j to trust the certificate by saving the certificate as a file and including a trust setting in my code. But this didn&#39;t work. I have tried swithcing from neo4j+s to bolt or just neo4j. I have updated neo4j and python. I feel like I have been debugging for about two days. Whatever I do, nothing happens in my Neo4j database. Help appreciated!",
            "link": "https://stackoverflow.com/questions/77353888/cannot-connect-to-neo4j-in-python-to-push-data",
            "title": "Cannot connect to Neo4j in Python to push data"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1698086458,
                    "answer_id": 77347595,
                    "question_id": 77347515,
                    "body_markdown": "It appears that there is no sequence of relationships from `parent` to `gap` that passes through a `FACT` relationship.\r\n\r\nIf that is true, then your query is working as expected and should not find any `FACT` relationships.\r\n\r\n#### Answer 1\r\n\r\nHere is one way to display each path `p` and a list of the &quot;factoids&quot; for the nodes in that path.\r\n\r\n    MATCH p=(parent:FEATURE)-[*]-&gt;(gap:GAP)\r\n    WHERE parent.name = &quot;Update Profile&quot; AND gap.name contains &quot;CSRF&quot;\r\n    UNWIND NODES(p) AS n\r\n    RETURN p, REDUCE(\r\n      s = [], t IN COLLECT({n: n, facts: [(n)&lt;-[r:FACT]-(f) | {rel: f, fact: f}]}) |\r\n      CASE WHEN SIZE(t.facts) &gt; 0 THEN s + t ELSE s END) AS factoids\r\n\r\nA &quot;factoid&quot; is a map with these properties:\r\n  - `n` is a node in the path that has an incoming `FACT` relationship (even if that relationship is not on the path)\r\n  - `rel` is the `FACT` relationship\r\n  - `fact` is the source node of that `FACT` relationship\r\n\r\n#### Answer 2\r\n\r\n@Graphileon&#39;s fine answer is more compact, but its result contains a superfluous empty list for every path node that has no incoming `FACT` relationship.\r\n\r\nThis version of his answer uses [apoc.coll.removeAll](https://neo4j.com/docs/apoc/current/overview/apoc.coll/apoc.coll.removeAll/) to remove the empty lists:\r\n\r\n    MATCH p=(parent:FEATURE)-[*]-&gt;(gap:GAP)\r\n    WHERE parent.name = &quot;Update Profile&quot; AND gap.name contains &quot;CSRF&quot;\r\n    RETURN p,\r\n           apoc.coll.removeAll(\r\n             [node IN NODES(p) | [fp = (node)&lt;-[:FACT]-(f) | fp ]],\r\n             [[]]) AS factPaths\r\n\r\nUsing`apoc.coll.removeAll` to remove empty lists is for convenience and readability, but not necessary. For example, we could use `REDUCE` instead, as in Answer #1.",
                    "title": "Displaying hidden nodes in Neo4j"
                },
                {
                    "owner": {
                        "account_id": 1924160,
                        "reputation": 5335,
                        "user_id": 1734996,
                        "user_type": "registered",
                        "accept_rate": 85,
                        "profile_image": "https://i.stack.imgur.com/MaqL4.png?s=256&g=1",
                        "display_name": "Graphileon",
                        "link": "https://stackoverflow.com/users/1734996/graphileon"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1698093061,
                    "answer_id": 77348149,
                    "question_id": 77347515,
                    "body_markdown": "I would go for something like this:\r\n\r\n    MATCH p=(parent:FEATURE)-[*]-&gt;(gap:GAP)\r\n    WHERE parent.name = &quot;Update Profile&quot; AND gap.name contains &quot;CSRF&quot;\r\n    RETURN p,\r\n           [node IN nodes(p) |\r\n    \t       [ factPath = (node)&lt;-[:FACT]-(f) | factPath ]\r\n    \t   ] AS factPaths\r\n\r\nSo you basically loop through the nodes on the path p, and pick up any incoming paths with FACT relationships\r\n\r\nIn case you want to filter out the empty lists (for nodes that do not have incoming FACT rels) it can be done with an additional WHERE\r\n\r\n    MATCH p=(parent:FEATURE)-[*]-&gt;(gap:GAP)\r\n    WHERE parent.name = &quot;Update Profile&quot; AND gap.name contains &quot;CSRF&quot;\r\n    RETURN p,\r\n         [node IN nodes(p) WHERE EXISTS((node)&lt;-[:FACT]-()) |\r\n    \t       [ factPath = (node)&lt;-[:FACT]-(f) | factPath ]\r\n    \t ] AS factPaths\r\n\r\n NOTE: factPaths is returned as a nested array of paths. Depending on what you want to do with it (to the viz) or further processing, you may want to use apoc.coll.flatten() to ..eh .. flatten it",
                    "title": "Displaying hidden nodes in Neo4j"
                }
            ],
            "owner": {
                "account_id": 10150295,
                "reputation": 1257,
                "user_id": 7497127,
                "user_type": "registered",
                "accept_rate": 67,
                "profile_image": "https://lh6.googleusercontent.com/-DUakSAslaoA/AAAAAAAAAAI/AAAAAAAADHc/lIAG1nu4vzM/photo.jpg?sz=256",
                "display_name": "JAMSHAID",
                "link": "https://stackoverflow.com/users/7497127/jamshaid"
            },
            "is_answered": true,
            "view_count": 43,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1698085429,
            "question_id": 77347515,
            "body_markdown": "I have a query that shows the results from my large graph as follows:\r\n\r\n[![graph][1]][1]\r\n\r\nHere is my query to show the graph\r\n\r\n    MATCH p=(parent:FEATURE)-[*]-&gt;(gap:GAP) WHERE parent.name = &quot;Update Profile&quot; \r\n    and (gap.name contains &quot;CSRF&quot; )  RETURN p\r\n\r\nThe nodes R11_UP and R12_UP have an incoming edge of type FACT; this query is not displaying that. Here is what the graph looks like if I manually show these incoming edges:\r\n\r\n[![enter image description here][2]][2]\r\n\r\nI want to update my query to show these FACT nodes along with the other graph shown by this query. I am unable to design a query for it. I tried several queries, but none of them worked. I am always stuck with this graph at the end.\r\n\r\n  [1]: https://i.stack.imgur.com/nrhJ0.png\r\n  [2]: https://i.stack.imgur.com/r5ESA.png",
            "link": "https://stackoverflow.com/questions/77347515/displaying-hidden-nodes-in-neo4j",
            "title": "Displaying hidden nodes in Neo4j"
        },
        {
            "tags": [
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 1924160,
                        "reputation": 5335,
                        "user_id": 1734996,
                        "user_type": "registered",
                        "accept_rate": 85,
                        "profile_image": "https://i.stack.imgur.com/MaqL4.png?s=256&g=1",
                        "display_name": "Graphileon",
                        "link": "https://stackoverflow.com/users/1734996/graphileon"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698093392,
                    "answer_id": 77348188,
                    "question_id": 77346710,
                    "body_markdown": "AFAIK, Cypher does not support dynamic labels. But the apoc library does: See \r\n\r\nhttps://neo4j.com/labs/apoc/4.1/overview/apoc.merge/apoc.merge.node/",
                    "title": "Neo4j query not making use of indexes"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 2,
                    "creation_date": 1698114753,
                    "answer_id": 77349202,
                    "question_id": 77346710,
                    "body_markdown": "Neo4j does not require nodes to have consistent labeling, so every node can have any number of labels (including 0).\r\n\r\nNow, let&#39;s suppose the Cypher execution planner was &quot;super-smart&quot; and *could* automatically use indexes if you did not specify any labels. In that case, the planner would have to test *every matching node* for its labels, and then try to determine a single coherent plan that used a combination of indexes involving those labels to minimize execution time.\r\n\r\nSince this requires scanning all matching nodes just to come up with the execution plan, we have swamped any speedup we would get by executing the resulting plan with indexes.\r\n\r\nSo, a &quot;super-smart&quot; Cypher planner would be too slow to be of any use.",
                    "title": "Neo4j query not making use of indexes"
                }
            ],
            "owner": {
                "account_id": 2867026,
                "reputation": 73,
                "user_id": 2461139,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/M2NBq.jpg?s=256&g=1",
                "display_name": "Prassi",
                "link": "https://stackoverflow.com/users/2461139/prassi"
            },
            "is_answered": true,
            "view_count": 35,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1698077162,
            "question_id": 77346710,
            "body_markdown": "I have several types of node labels (Asset1, Asset2, etc), all of which can be connected to any of the others; each asset has different fields but all have in common an `id` field. I am saving this data in CSV files to be loaded in Neo4j: node data is saved in asset1.csv, asset2.csv, etc, while relationship data is saved in a connection.csv file with the following header: `asset_1_id`, `asset_1_type`, `asset_2_id`, `asset_2_type`.\r\n\r\nLoading the nodes is easy:\r\n\r\n```cypher\r\nLOAD CSV WITH HEADERS FROM &#39;file:///assetN.csv&#39; AS row\r\nCREATE (n:AssetN {\r\n  id: row.id,\r\n  // other fields for AssetN\r\n})\r\n```\r\n\r\nBefore loading the nodes, I define separate indexes for each asset type:\r\n\r\n```cypher\r\nCREATE INDEX assetN_id IF NOT EXISTS FOR (n:AssetN) ON (n.id);\r\n```\r\n\r\nLoading the relationships is a bit trickier, because my first solution never terminates:\r\n\r\n```cypher\r\nLOAD CSV WITH HEADERS FROM &#39;file:///connection.csv&#39; AS row\r\nMATCH (asset1 { id: row.asset_1_id })\r\nMATCH (asset2 { id: row.asset_2_id }) \r\n    \r\nMERGE (asset1)-[:CONNECTED_TO]-(asset2)\r\n```\r\n\r\nIt seems that if I don&#39;t specify the label type, Neo4j does not look for an index in case it exists. I understand sometimes it may not exist (e.g. let&#39;s say there is another asset type without that index defined), but I would expect it to try and then default to a full scan otherwise.\r\n\r\nSo my second solution is to try and use APOC to read the labels dynamically from the CSV file:\r\n\r\n```cypher\r\nLOAD CSV WITH HEADERS FROM &#39;file:///connection.csv&#39; AS row\r\nCALL apoc.merge.node([row.asset_1_type], { mrid: row.asset_1_id }) YIELD node as asset1\r\nCALL apoc.merge.node([row.asset_2_type], { mrid: row.asset_2_id }) YIELD node as asset2   \r\n \r\nMERGE (asset1)-[:CONNECTED_TO]-(asset2)\r\n```\r\n\r\nBut this never terminates either, as it still does not seem to use the indexes.\r\n\r\nThe only solution I found so far that actually works is defining an additional label for each asset type (called Asset), defining a single index on Asset and then loading the relationship data:\r\n\r\n```cypher\r\nLOAD CSV WITH HEADERS FROM &#39;file:///connection.csv&#39; AS row\r\nMATCH (asset1:Asset { id: row.asset_1_id })\r\nMATCH (asset2:Asset { id: row.asset_2_id }) \r\n    \r\nMERGE (asset1)-[:CONNECTED_TO]-(asset2)\r\n```\r\n\r\nThis is extremely quick because it actually uses the index, but I don&#39;t like having to add a label to each node just to optimise loading the data.\r\n\r\nAre there other solutions I am not seeing?",
            "link": "https://stackoverflow.com/questions/77346710/neo4j-query-not-making-use-of-indexes",
            "title": "Neo4j query not making use of indexes"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "memgraphdb"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 3,
                    "creation_date": 1698007525,
                    "answer_id": 77341642,
                    "question_id": 77341203,
                    "body_markdown": "You can return pairs of endpoints in the results, in descending order of the number of paths between them, like so:\r\n```\r\nMATCH path = (start:Fen)-[*]-&gt;(end:Fen)\r\nWHERE start.Name = &#39;A&#39;\r\nRETURN start, end, count(*) AS count\r\nORDER BY count DESC\r\n```\r\nAs an aside, you depict your desired result in the form of `A -r-&gt; B`. Assuming by `-r-&gt;` you mean all the intermediate nodes and relationships in the path, then these would all be distinct and appear in separate rows.",
                    "title": "How do I get the unique paths in a graph in memgraph/cypher?"
                },
                {
                    "owner": {
                        "account_id": 27692271,
                        "reputation": 203,
                        "user_id": 21138720,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/0f2f11bd6cc32fc7f0497cb4e7aa9aa3?s=256&d=identicon&r=PG",
                        "display_name": "GrandMel",
                        "link": "https://stackoverflow.com/users/21138720/grandmel"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1698044891,
                    "answer_id": 77343237,
                    "question_id": 77341203,
                    "body_markdown": "If you have a this type of dataset:\r\n\r\n    CREATE (:Node {name: &#39;A&#39;});\r\n    CREATE (:Node {name: &#39;B&#39;});\r\n    CREATE (:Node {name: &#39;C&#39;});\r\n    CREATE (:Node {name: &#39;D&#39;});\r\n    CREATE (:Node {name: &#39;E&#39;});\r\n    MATCH (a:Node {name: &#39;A&#39;}), (b:Node {name: &#39;B&#39;})\r\n    CREATE (a)-[:r1]-&gt;(b)\r\n    CREATE (a)-[:r2]-&gt;(b);\r\n    MATCH (a:Node {name: &#39;A&#39;}), (c:Node {name: &#39;C&#39;})\r\n    CREATE (a)-[:r3]-&gt;(c);\r\n    MATCH (d:Node {name: &#39;D&#39;}), (e:Node {name: &#39;E&#39;})\r\n    CREATE (d)-[:r4]-&gt;(e);\r\n    MATCH (b:Node {name: &#39;B&#39;}), (d:Node {name: &#39;D&#39;})\r\n    CREATE (b)-[:r5]-&gt;(d);\r\n    MATCH (c:Node {name: &#39;C&#39;}), (e:Node {name: &#39;E&#39;})\r\n    CREATE (c)-[:r6]-&gt;(e);\r\n\r\nThis should work in Memgraph:\r\n\r\n    MATCH (start:Node {name: &#39;A&#39;})-[r]-&gt;(end:Node)\r\n    WITH start, end, collect(r) AS rels\r\n    ORDER BY size(rels) DESC\r\n    RETURN start.name AS StartNode, end.name AS EndNode, size(rels) AS RelationshipCount\r\n\r\nAs result I get `A-&gt;B count:2`, `A-&gt;C count:1`\r\n\r\n",
                    "title": "How do I get the unique paths in a graph in memgraph/cypher?"
                }
            ],
            "owner": {
                "account_id": 1108171,
                "reputation": 6225,
                "user_id": 1099123,
                "user_type": "registered",
                "accept_rate": 55,
                "profile_image": "https://www.gravatar.com/avatar/41f5144169c49d431963661b24fa918d?s=256&d=identicon&r=PG",
                "display_name": "user1099123",
                "link": "https://stackoverflow.com/users/1099123/user1099123"
            },
            "is_answered": true,
            "view_count": 72,
            "favorite_count": 0,
            "accepted_answer_id": 77341642,
            "answer_count": 2,
            "score": 4,
            "creation_date": 1697999220,
            "question_id": 77341203,
            "body_markdown": "Suppose I had two nodes: A and B. Now suppose I had two relations that are similar:\r\n\r\n```\r\nA -r1-&gt; B\r\nA -r2-&gt; B\r\n```\r\n\r\nHow do I make a query that returns just a path from A -&gt; B? The following query returns two paths that are identical. Can we merge the results?\r\n\r\n```\r\nMATCH path = (start:Fen)-[r*]-&gt;(end:Fen)\r\nWHERE start.Name = &#39;A&#39;\r\nRETURN DISTINCT(path)\r\n```\r\n\r\nWhat I am trying to solve is to find the most popular paths between nodes. so given the graph:\r\n\r\n```\r\nA -r1-&gt; B\r\nA -r2-&gt; B\r\nA -r3-&gt; C\r\n```\r\nthe query should return \r\n```\r\nA -r-&gt; B\r\nA -r-&gt; C\r\n```\r\nsince A -&gt; B is the most popular it appears first\r\n",
            "link": "https://stackoverflow.com/questions/77341203/how-do-i-get-the-unique-paths-in-a-graph-in-memgraph-cypher",
            "title": "How do I get the unique paths in a graph in memgraph/cypher?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1697994572,
                    "answer_id": 77340950,
                    "question_id": 77339992,
                    "body_markdown": "Paths are linear, so it isn&#39;t possible to have a result with `D` as part of the same path as `A`, `B` and `F` (without re-traversing the relationship that joins `B` and `D`—but that would yield a path with `B` appearing twice i.e. `A-&gt;B-&gt;D-&gt;B-&gt;F`). \r\n\r\nYou can assign the second pattern to another path variable e.g. `q` and return that along with `p`:\r\n```\r\nMATCH p = (:Service {name: &quot;A&quot;})-[r1:CAN_READ]-&gt;(n:Service)-[r2:CAN_WRITE]-&gt;\r\n            (:Service {name: &quot;F&quot;}),\r\n      q = (n)-[r3:CAN_WRITE]-&gt;(:Service {name: &quot;D&quot;}) \r\nRETURN p, q\r\n\r\nResults:\r\n╒══════════════════════════════════════════════════════════════════════╤═══════════════════════════════════════════════════════════╕\r\n│p                                                                     │q                                                          │\r\n╞══════════════════════════════════════════════════════════════════════╪═══════════════════════════════════════════════════════════╡\r\n│(:Service {name: &quot;A&quot;})-[:CAN_READ]-&gt;(:Service {name: &quot;B&quot;})-[:CAN_WRITE│(:Service {name: &quot;B&quot;})-[:CAN_WRITE]-&gt;(:Service {name: &quot;D&quot;})│\r\n│]-&gt;(:Service {name: &quot;F&quot;})                                             │                                                           │\r\n├──────────────────────────────────────────────────────────────────────┼───────────────────────────────────────────────────────────┤\r\n│(:Service {name: &quot;A&quot;})-[:CAN_READ]-&gt;(:Service {name: &quot;C&quot;})-[:CAN_WRITE│(:Service {name: &quot;C&quot;})-[:CAN_WRITE]-&gt;(:Service {name: &quot;D&quot;})│\r\n│]-&gt;(:Service {name: &quot;F&quot;})                                             │                                                           │\r\n└──────────────────────────────────────────────────────────────────────┴───────────────────────────────────────────────────────────┘\r\n```\r\n",
                    "title": "How to find paths between different services in Neo4j"
                }
            ],
            "owner": {
                "account_id": 12603102,
                "reputation": 43,
                "user_id": 9165128,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/a6e20379f5387fd7f4902a072e308f7d?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "basic",
                "link": "https://stackoverflow.com/users/9165128/basic"
            },
            "is_answered": true,
            "view_count": 45,
            "favorite_count": 0,
            "accepted_answer_id": 77340950,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697978777,
            "question_id": 77339992,
            "body_markdown": "I&#39;m new to Neo4j and I&#39;m working on poc where there are multiple services that can read and write to each other and modeled with &lt;CAN_READ(INCOMING):CAN_WRITE(OUTGOING)&gt; directed relationships as shown in the image below. I want to find all paths from A to F through compute services which can read from A and write to Service F and compute service should also able to write data to Service D. So the query should able to return paths highlighted in green and purple.\r\n\r\nI have tried the below query which is giving Compute Services B,C and Storage Service A and Database Service F but Service D is not part of result path\r\n\r\nWhat I&#39;m trying to achieve is, I&#39;m trying to find the services that can read from a service and write to multiple other services with the same relations\r\n\r\n    Query : MATCH p= (m:Service WHERE m.name = &quot;A&quot;)-[r1:CAN_READ]-&gt;(n:Service)-[r2:CAN_WRITE]-&gt;(o:Service WHERE o.name = &quot;F&quot;),(n)-[r3:CAN_WRITE]-&gt;(t:Service WHERE t.name = &quot;D&quot;) RETURN p\r\n\r\n    Result Output Paths: (A)&lt;-[:CAN_READ]-(B)-[:WRITE_TO]-&gt;(F), (A)&lt;-[:CAN_READ]-(C)-[:WRITE_TO]-&gt;(F)\r\n\r\nHow to get the node D as part of output path? Will i able to get the node D as part of output or it will be omitted as it not part of the primary MATCH path ? Do I need to use any other functions or features of neo4j to achieve the same\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/8kvbu.png",
            "link": "https://stackoverflow.com/questions/77339992/how-to-find-paths-between-different-services-in-neo4j",
            "title": "How to find paths between different services in Neo4j"
        },
        {
            "tags": [
                "import",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697925465,
                    "answer_id": 77337939,
                    "question_id": 77335429,
                    "body_markdown": "On Windows, a backslash (`\\`) in the path is taken to be a path-component separator. To treat is as a regular backslash, you need to escape it with another backslash.\r\n\r\nThis should work:\r\n\r\n    neo4j-admin database import full --nodes /import/data_header.csv,/import/data_\\\\d+.csv --overwrite-destination=true\r\n",
                    "title": "bulk Neo4j admin import from csv using regex"
                }
            ],
            "owner": {
                "account_id": 29716092,
                "reputation": 1,
                "user_id": 22774573,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocKlkzIiiPUARmv4SHNI9R3NPscr1-QY3r4Ma4Nv7sY=k-s256",
                "display_name": "Mudit Shukla",
                "link": "https://stackoverflow.com/users/22774573/mudit-shukla"
            },
            "is_answered": false,
            "view_count": 29,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697880643,
            "question_id": 77335429,
            "body_markdown": "I am trying to import data from multiple csv files by matching regex pattern into neo4j database instance by neo4j admin import method, which is probably the fastest way to import data in neo4j. \r\n\r\nI am trying to use the below command to import the data in my neo4j database instance:\r\n \r\n\r\n    neo4j-admin database import full --nodes import/data_header.csv,import/data_\\d+\\.csv --overwrite-destination=true\r\n\r\nBut I am getting error something like this:\r\n\r\n    Invalid nodes file: import/data_header.csv,import/data_\\d+\\.csv (java.lang.IllegalStateException: Directory C:\\Program Files\\neo4j-community-5.12.0-windows\\neo4j-community-5.12.0\\import\\data_\\d+ of import/data_\\d+\\.csv doesn&#39;t exist)\r\n\r\nI am trying to import the data from all files that start with data_ and have any number after it.\r\nFor example, a valid file would be `data_1.csv`.\r\n\r\nI even tried with absolute path but that too did not yield any result.\r\n\r\nThanks for the help in advance.",
            "link": "https://stackoverflow.com/questions/77335429/bulk-neo4j-admin-import-from-csv-using-regex",
            "title": "bulk Neo4j admin import from csv using regex"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 9963444,
                        "reputation": 12317,
                        "user_id": 7371893,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=256&g=1",
                        "display_name": "jose_bacoy",
                        "link": "https://stackoverflow.com/users/7371893/jose-bacoy"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697812966,
                    "answer_id": 77331835,
                    "question_id": 77331216,
                    "body_markdown": "You can sort the items on the list in below examples:\r\n\r\n1) Using UNWIND and COLLECT\r\n\r\n```\r\n    WITH  [ &quot;Coyote&quot;,&quot; Eastern Coyote&quot;]  as lst\r\n    UNWIND lst as l\r\n    WITH l ORDER by l\r\n    RETURN  collect(l) as sorted_lst\r\n```\r\n2) Using apoc function sort\r\n\r\n\r\n```\r\n    WITH  [ &quot;Coyote&quot;,&quot; Eastern Coyote&quot;]  as lst\r\n    RETURN apoc.coll.sort(lst) as sorted_lst\r\n```\r\n\r\nResult:\r\n\r\n    ╒════════════════════════════╕\r\n    │&quot;sorted_lst&quot;                │\r\n    ╞════════════════════════════╡\r\n    │[&quot; Eastern Coyote&quot;,&quot;Coyote&quot;]│\r\n    └────────────────────────────┘\r\n\r\n",
                    "title": "How string item order in neo4j"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697828517,
                    "answer_id": 77333248,
                    "question_id": 77331216,
                    "body_markdown": "In your question, you made some major mistakes:\r\n\r\n1. `[&quot;Coyote&quot;,&quot; Eastern Coyote&quot;]` is a **list** of strings, not a string.\r\n2. `ORDER BY xxx DESC` sorts in **descending** order, not ascending.\r\n3. You said:\r\n\r\n    &gt; ... still not make sense, cause &quot;E&quot; is Larger than &quot;C&quot;\r\n\r\n   But the string &quot; Eastern Coyote&quot; actually starts with a **space** character, so you should have been comparing &quot; &quot; to &quot;C&quot;. The &quot; &quot; character has a lower lexical value than &quot;C&quot;. Therefore, `[&quot;Coyote&quot;,&quot; Eastern Coyote&quot;]` is the correct answer after sorting the list items in **descending** order.\r\n\r\n\r\nYou need to double-check your string values to remove extraneous spaces.\r\n\r\nAlso, to return a list of the strings from `xxx` in **ascending** order (which is the default order), you can use this snippet:\r\n\r\n    ...\r\n    UNWIND xxx AS y\r\n    WITH y ORDER BY y\r\n    RETURN COLLECT(y) AS result\r\n\r\nOr, if you really want to return the list in **descending** order:\r\n\r\n    ...\r\n    UNWIND xxx AS y\r\n    WITH y ORDER BY y DESC\r\n    RETURN COLLECT(y) AS result",
                    "title": "How string item order in neo4j"
                }
            ],
            "owner": {
                "account_id": 21516925,
                "reputation": 13,
                "user_id": 15858616,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/987018c9cecb2d014aacae331dfb2e9a?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Frank.H",
                "link": "https://stackoverflow.com/users/15858616/frank-h"
            },
            "is_answered": false,
            "view_count": 33,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1697807745,
            "question_id": 77331216,
            "body_markdown": "I ran a Cypher query with the clause:\r\n\r\n&gt; ORDER BY xxx DESC\r\n\r\nwhere `xxx` is a string, like `[&quot;Coyote&quot;,&quot; Eastern Coyote&quot;]`. I want it ordered with first alphabet ASC, like this: `[&quot; Eastern Coyote&quot;,&quot;Coyote&quot;]`.\r\nbut the outcome is still this: `[&quot;Coyote&quot;,&quot; Eastern Coyote&quot;]`.\r\n\r\nFYI: i asked chatgpt,it said order in neo4j is depends on alphabet&#39;s unicode, but it still not make sense, cause &quot;E&quot; is Larger than &quot;C&quot;",
            "link": "https://stackoverflow.com/questions/77331216/how-string-item-order-in-neo4j",
            "title": "How string item order in neo4j"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1697825798,
                    "answer_id": 77333022,
                    "question_id": 77328455,
                    "body_markdown": "Your query seems to be spending most of its time scanning through all the possible `SubjectUserNode` candidates.\r\n\r\nSo, try adding an index on `User.NodeID`. The execution planner should be able to use that index to reduce the execution time.\r\n\r\n#### Addendum\r\n\r\nAlso, unless logically required, you should simplify your query to remove unnecessary filtering, which wastes time. For example, if all `User` nodes are also `Transaction` nodes, use `(SubjectUserNode:User ...)` instead of `(SubjectUserNode:User:Transaction ...)`.",
                    "title": "How to Optimize this Neo4j Query"
                },
                {
                    "owner": {
                        "account_id": 9963444,
                        "reputation": 12317,
                        "user_id": 7371893,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=256&g=1",
                        "display_name": "jose_bacoy",
                        "link": "https://stackoverflow.com/users/7371893/jose-bacoy"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1698336304,
                    "answer_id": 77368647,
                    "question_id": 77328455,
                    "body_markdown": "As per meeting with Garv (and also from @cybersam previous answer), removing :Transaction label on the query fixed the slow performance. The query is doing a table scan because all data in the database is labeled as Transaction.  After the fix, the run time is now 6ms vs 3.4s before. \r\n \r\n\r\n    MATCH (subjectUserNode:User{NodeID: &quot;2547:12109:000:381864&quot;})-[dimensionRelation:LegalEntity\r\n        WHERE dimensionRelation.Status = &quot;1&quot;\r\n    ]-&gt;(dimension:LegalEntity)&lt;-[udimensionRelation:LegalEntity\r\n        WHERE udimensionRelation.Status = &quot;1&quot;\r\n    ]-(user:User)-[roleRelationship:Role\r\n        WHERE roleRelationship.Status = &quot;1&quot;\r\n    ]-&gt;(role:Role{NodeID: &quot;2547:12122:000:70163&quot;})\r\n    RETURN user.TransactionID as UserID",
                    "title": "How to Optimize this Neo4j Query"
                }
            ],
            "owner": {
                "account_id": 29396152,
                "reputation": 23,
                "user_id": 22523452,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AAcHTtcrIYxAUHFuLpGn4QhD4iig5CwEKNc42e5zRW8kHD52=k-s256",
                "display_name": "Garv",
                "link": "https://stackoverflow.com/users/22523452/garv"
            },
            "is_answered": true,
            "view_count": 56,
            "favorite_count": 0,
            "accepted_answer_id": 77333022,
            "answer_count": 2,
            "score": 1,
            "creation_date": 1697778950,
            "question_id": 77328455,
            "body_markdown": "I have this cypher query that I had written:\r\n\r\n    MATCH (SubjectUserNode:User:Transaction {NodeID: &quot;2547:12109:000:381864&quot;})-[dimensionRelation:LegalEntity\r\n        WHERE dimensionRelation.Status = &quot;1&quot;\r\n    ]-&gt;(dimension:LegalEntity:Transaction)&lt;-[udimensionRelation:LegalEntity\r\n        WHERE udimensionRelation.Status = &quot;1&quot;\r\n    ]-(User:User:Transaction)-[RoleRelationship:Role\r\n        WHERE RoleRelationship.Status = &quot;1&quot;\r\n    ]-&gt;(Role:Role:Transaction {NodeID: &quot;2547:12122:000:70163&quot;})\r\n    RETURN User.TransactionID as UserID\r\n\r\nIn this query, I&#39;m trying to get all those User nodes that are related to a given Role node(NodeID given) and are also related to the LegalEntity node which has a relation to the given User node(NodeID given).\r\n\r\nExample:\r\n\r\n[![Node image][1]][1]\r\n\r\nThe query profile is:\r\n\r\n[![Query Profile][2]][2]\r\n\r\nThe query is taking between 4-5 seconds to return the data and the number of nodes being returned is about 150.\r\n\r\nIs there anyway to improve this query like by using any apoc procedure? I can&#39;t think of any other way as according to me this is a simple query in itself. Also, indices are already created on the nodeID of each node type.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/jnxtf.png\r\n  [2]: https://i.stack.imgur.com/XUgH7.png",
            "link": "https://stackoverflow.com/questions/77328455/how-to-optimize-this-neo4j-query",
            "title": "How to Optimize this Neo4j Query"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1697564318,
                    "answer_id": 77311131,
                    "question_id": 77311116,
                    "body_markdown": "Aggregation functions like `COUNT` can only be used in `WITH` and `RETURN` clauses.\r\n\r\nBut starting with neo4j 5.0 you can use the new [COUNT subquery](https://neo4j.com/docs/cypher-manual/current/subqueries/count/#:~:text=COUNT%20subquery%20with%20a%20UNION,not%20require%20the%20RETURN%20clause.). For example:\r\n\r\n    MATCH (childD:ChildD {id:123})\r\n    RETURN COUNT { (:Vacancy)&lt;-[:POTENTIAL_PROFILE]-(childD) } AS potentialJobablesCount",
                    "title": "Return count() from Cypher pattern comprehension"
                }
            ],
            "owner": {
                "account_id": 1261634,
                "reputation": 24551,
                "user_id": 1219755,
                "user_type": "registered",
                "accept_rate": 84,
                "profile_image": "https://i.stack.imgur.com/UmjNt.jpg?s=256&g=1",
                "display_name": "alexanoid",
                "link": "https://stackoverflow.com/users/1219755/alexanoid"
            },
            "is_answered": true,
            "view_count": 35,
            "favorite_count": 0,
            "accepted_answer_id": 77311131,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697564138,
            "question_id": 77311116,
            "body_markdown": "Is it possible to return `count()` from Cypher pattern comprehension ?\r\n\r\nThe following query doesn&#39;t work:\r\n\r\n    [ (:Vacancy)&lt;-[rpp:POTENTIAL_PROFILE]-(childD) | count(rpp) ] AS potentialJobablesCount\r\n\r\nwith the following error:\r\n\r\n    Aggregation column contains implicit grouping expressions. For example, in &#39;RETURN n.a, n.a + n.b + count(*)&#39; the aggregation expression &#39;n.a + n.b + count(*)&#39; includes the implicit grouping key &#39;n.b&#39;. It may be possible to rewrite the query by extracting these grouping/aggregation expressions into a preceding WITH clause. Illegal expression(s): rpp\r\n",
            "link": "https://stackoverflow.com/questions/77311116/return-count-from-cypher-pattern-comprehension",
            "title": "Return count() from Cypher pattern comprehension"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1697562129,
                    "answer_id": 77310912,
                    "question_id": 77309885,
                    "body_markdown": "You need to carefully read the [MERGE](https://neo4j.com/docs/cypher-manual/current/clauses/merge/) clause documentation, as it is easy to use incorrectly and get unexpected results. For example, individual nodes and relationships should always be `MERGE`d separately.\r\n\r\nAlso, since your query `MATCH`es `Id` nodes at the outset, all `Id` nodes mentioned in the CSV file must already exist, or else some `line`s will do nothing. It is not clear if that is intentional.\r\n\r\nHere is a query that should work as expected (and create `Id` nodes as necessary). Note that I changed the node labels to mixed case to match the standard neo4j naming convention. Also, there is no need for a temporary node.\r\n\r\n    LOAD CSV WITH HEADERS FROM &#39;path&#39; AS line\r\n    MERGE (id:Id {id: line.ID})\r\n    WITH line, id\r\n    UNWIND SPLIT(line.Class, &quot; &quot;) AS cId\r\n    MERGE (class:Class {id: cId})\r\n    MERGE (id)-[r:HAS]-&gt;(class)\r\n    RETURN r",
                    "title": "How to make nodes and form n to m relationship in neo4j when given &#39;m&#39; data is constructed in one csv column?"
                }
            ],
            "owner": {
                "account_id": 12719800,
                "reputation": 95,
                "user_id": 9240633,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/t0RDd.png?s=256&g=1",
                "display_name": "Duda Validator",
                "link": "https://stackoverflow.com/users/9240633/duda-validator"
            },
            "is_answered": true,
            "view_count": 30,
            "favorite_count": 0,
            "accepted_answer_id": 77310912,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697552779,
            "question_id": 77309885,
            "body_markdown": "I want to design a database in neo4j where I want to make nodes and relationships between other nodes. To explain it neatly please consider following scenario:\r\n\r\nFrom given csv file one column represents unique IDs and another column represents classes, where in some class column there is only one class whereas in many column there are many classes. \r\n\r\ni.e.\r\n\r\n    ---------------------\r\n    |  ID   |  Class    |\r\n    ---------------------\r\n    |  ID1  |  Class-A  |\r\n    ---------------------\r\n    |  ID2  |  Class-A  |\r\n    |       |  Class-B  |\r\n    |       |  Class-C  |\r\n    ---------------------\r\n\r\nFrom the above example data, the query must generate `(ID1)` node and `(Class-A)` node with HAS relationship. Same with `ID2`. `(ID2)--[HAS]--&gt;(Class-A)` , `(ID2)--[HAS]--&gt;(Class-B)` and so on. \r\n\r\n\r\n\r\n\r\nI was able to write following query.\r\n\r\n```\r\nload csv with headers from &#39;path&#39; as line\r\nmatch(id:ID{id:line.ID}), (temp:TEMP{id:line.Class})\r\n    with temp, split(temp.id, &quot; &quot;) as ids\r\n    unwind range(0,size(ids)-1) as i\r\nmerge(id)-[n:HAS]-&gt;(class:CLASS{id:ids[i]})\r\ndelete temp\r\nreturn n\r\n```\r\n\r\nI am able to create individual nodes from Class column, but it creates relationships with empty nodes and not with associated IDs.\r\n\r\nAny lead would be great help. \r\n\r\nI am new to database design.\r\nThanks",
            "link": "https://stackoverflow.com/questions/77309885/how-to-make-nodes-and-form-n-to-m-relationship-in-neo4j-when-given-m-data-is-c",
            "title": "How to make nodes and form n to m relationship in neo4j when given &#39;m&#39; data is constructed in one csv column?"
        },
        {
            "tags": [
                "neo4j",
                "version",
                "compatibility"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 103469,
                        "reputation": 8520,
                        "user_id": 277128,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "profile_image": "https://www.gravatar.com/avatar/f06979a03b9b522c80cb12def209c31a?s=256&d=identicon&r=PG",
                        "display_name": "fbiville",
                        "link": "https://stackoverflow.com/users/277128/fbiville"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697465554,
                    "answer_id": 77302699,
                    "question_id": 77301601,
                    "body_markdown": "[`exists` has changed since Neo4j 5.0][1] to only check for graph pattern existence, not property.\r\n\r\nneovis.js must use this variant instead:\r\n\r\n```cypher\r\nMATCH (n) WHERE n.pagerank IS NOT NULL\r\n```\r\n\r\nNote: you can read the [documentation of `exists` for Neo4j 4.4][2], which indeed worked with properties as well.\r\n\r\n\r\n  [1]: https://neo4j.com/docs/cypher-manual/5/functions/predicate/#functions-exists\r\n  [2]: https://neo4j.com/docs/cypher-manual/4.4/functions/predicate/#functions-exists",
                    "title": "Is neovis.js version 2.1.0 incompatible with neo4j version 5.12.0?"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697476205,
                    "answer_id": 77303790,
                    "question_id": 77301601,
                    "body_markdown": "Neovis.js source code [contains this snippet](https://github.com/neo4j-contrib/neovis.js/blob/7815563f5c118040e0d21c0f7bfd7dfbcfa5938f/src/defaults.ts#L3) in `defaults.ts`:\r\n\r\n\tneo4j: {\r\n\t\tinitialQuery: `MATCH (n) WHERE exists(n.pagerank)\r\n                        WITH (n), RAND() AS random\r\n                        ORDER BY random LIMIT 3000\r\n                        OPTIONAL MATCH (n)-[r]-(m)\r\n                        //WITH n,r,m WHERE exists(n.pagerank) AND exists(m.pagerank) AND exists(m.community)\r\n                        RETURN n, r, m;`,\r\n        ...\r\n\r\nThat seems to be the cause of your error. You should probably create [an issue](https://github.com/neo4j-contrib/neovis.js/issues) for this.\r\n",
                    "title": "Is neovis.js version 2.1.0 incompatible with neo4j version 5.12.0?"
                },
                {
                    "owner": {
                        "account_id": 2509446,
                        "reputation": 11,
                        "user_id": 2182284,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/c46d9a065d2878bf51d29b90172a72f5?s=256&d=identicon&r=PG",
                        "display_name": "user2182284",
                        "link": "https://stackoverflow.com/users/2182284/user2182284"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697503273,
                    "answer_id": 77305617,
                    "question_id": 77301601,
                    "body_markdown": "Thank you for your assistance.\r\n\r\nNeovis.js is compatible with Neo4j 5.12.0, with the exception of some deprecated syntax, such as `exists` mentioned above.\r\n\r\nMy error stemmed from the incorrect code `const vis = new NeoVis(config)`. It should have been `const vis = new NeoVis(config.value)`. I am using Vue3.js. Without the `.value`, Neovis.js cannot initialize the configuration and defaults to a Cypher clause containing `exists`. The error was resolved when I added `.value`, and my initial Cypher clause without `exists` will be executed.",
                    "title": "Is neovis.js version 2.1.0 incompatible with neo4j version 5.12.0?"
                }
            ],
            "owner": {
                "account_id": 2509446,
                "reputation": 11,
                "user_id": 2182284,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/c46d9a065d2878bf51d29b90172a72f5?s=256&d=identicon&r=PG",
                "display_name": "user2182284",
                "link": "https://stackoverflow.com/users/2182284/user2182284"
            },
            "is_answered": false,
            "view_count": 83,
            "favorite_count": 0,
            "answer_count": 3,
            "score": 0,
            "creation_date": 1697455742,
            "question_id": 77301601,
            "body_markdown": "I am using neovis.js version 2.1.0 with neo4j version 5.12.0. When I tried accessing according to the examples, the neo4j server returned the following error:\r\n\r\n```\r\nNeo4jError: The property existence syntax `... exists(variable.property)` is no longer supported. Please use `variable.property IS NOT NULL` instead. (line 1, column 17 (offset: 16))\r\n&quot;MATCH (n) WHERE exists(n.pagerank)&quot;\r\n\r\n```\r\n\r\nIs there a known incompatibility between these versions?\r\n\r\nMy vue3.js code is as follows:\r\n\r\n```\r\n&lt;template&gt;\r\n  &lt;h3&gt;graph demo&lt;/h3&gt;\r\n  &lt;div id=&quot;graph&quot;&gt;&lt;/div&gt;\r\n&lt;/template&gt;\r\n\r\n&lt;script setup&gt;\r\nimport NeoVis from &quot;neovis.js&quot;;\r\nimport { onMounted } from &quot;vue&quot;;\r\n\r\nconst config = ref({\r\n  containerId: &quot;graph&quot;,\r\n  neo4j: {\r\n    serverUrl: &quot;bolt://localhost:7687&quot;,\r\n    serverUser: &quot;neo4j&quot;,\r\n    serverPassword: &quot;neo4j_password&quot;,\r\n  },\r\n  labels: {},\r\n  relationships: {},\r\n  initialCypher: &quot;MATCH (n) return n&quot;,\r\n});\r\n\r\nnMounted(() =&gt; {\r\n  const vis = new NeoVis(config);\r\n  vis.render();\r\n});\r\n&lt;/script&gt;\r\n\r\n&lt;style scoped&gt;&lt;/style&gt;\r\n```",
            "link": "https://stackoverflow.com/questions/77301601/is-neovis-js-version-2-1-0-incompatible-with-neo4j-version-5-12-0",
            "title": "Is neovis.js version 2.1.0 incompatible with neo4j version 5.12.0?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 17092302,
                        "reputation": 9084,
                        "user_id": 12368154,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/7fcc314eb5f3167abcc6dbb28b5ad350?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "Charchit Kapoor",
                        "link": "https://stackoverflow.com/users/12368154/charchit-kapoor"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697468703,
                    "answer_id": 77303078,
                    "question_id": 77300899,
                    "body_markdown": "You can try making the last `MATCH` optional, and then use `WITH` to filter the rows.\r\nLike this:\r\n\r\n    MATCH (n {id: &quot;exists&quot;})\r\n    CALL {\r\n        WITH n\r\n        OPTIONAL MATCH (n)--(m {id: &quot;mightExist&quot;})\r\n        CALL {\r\n            WITH m\r\n            OPTIONAL MATCH (m)--(o {id: &quot;does-not-exist&quot;})\r\n            WITH \r\n            CASE WHEN m IS NULL THEN NULL\r\n            WHEN m IS NOT NULL AND o IS NULL THEN m\r\n            ELSE o END AS inner\r\n            RETURN inner\r\n        }\r\n        RETURN inner\r\n    }\r\n    RETURN inner",
                    "title": "How do I prevent a subquery from executing when an `OPTIONAL MATCH` does not return any rows"
                }
            ],
            "owner": {
                "account_id": 14968494,
                "reputation": 589,
                "user_id": 10806063,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/dd967.jpg?s=256&g=1",
                "display_name": "Nils",
                "link": "https://stackoverflow.com/users/10806063/nils"
            },
            "is_answered": false,
            "view_count": 51,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697449260,
            "question_id": 77300899,
            "body_markdown": "Using this query:\r\n```cypher\r\nOPTIONAL MATCH (n {id: &quot;does-not-exist&quot;})\r\nCALL {\r\n    RETURN &quot;test&quot; as inner\r\n}\r\nRETURN inner\r\n```\r\nI would expect the subquery not to be executed and the outer `RETURN` to return no results. Instead, the subquery is executed once and the return value is `&quot;test&quot;`. I suppose it being `OPTIONAL` causes the whole query to continue with one empty row.  \r\nMy actual query looks more like this:\r\n```cypher\r\nMATCH (n {id: &quot;exists&quot;})\r\nCALL {\r\n    WITH n\r\n    OPTIONAL MATCH (n)--(m {id: &quot;mightExist&quot;})\r\n    CALL {\r\n        WITH m\r\n        MATCH (m)--(o {id: &quot;does-not-exist&quot;})\r\n        RETURN &quot;test&quot; as inner\r\n    }\r\n    RETURN inner\r\n}\r\nRETURN inner\r\n```  \r\nThis causes the query to return nothing as the deepest subquery does not `MATCH` anything. The deepest subquery is still called once because the behavior of `OPTIONAL MATCH`. I can&#39;t change the `OPTIONAL MATCH` to be `MATCH` because then the whole query would not return anything when that relation does not exist, even though it should.\r\n\r\n\r\n**Essentially, I&#39;m trying to return a nested relation of a node which may or may not exist as a relation to the root node. How can I do that?**\r\n\r\n\r\n*Note: I&#39;m trying to stay away from APOC as much as I can to reduce vendor lock-in, but if I absolutely must use something like `apoc.when`, I could.*",
            "link": "https://stackoverflow.com/questions/77300899/how-do-i-prevent-a-subquery-from-executing-when-an-optional-match-does-not-ret",
            "title": "How do I prevent a subquery from executing when an `OPTIONAL MATCH` does not return any rows"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1697223556,
                    "answer_id": 77290102,
                    "question_id": 77289431,
                    "body_markdown": "GDS currently does not support `elementId()` values, so you will have to use `id()`.",
                    "title": "How to use Neo4j&#39;s gds.shortestPath.dijkstra.stream for nodes with elementId(node) intead of id(node)?"
                },
                {
                    "owner": {
                        "account_id": 5567614,
                        "reputation": 773,
                        "user_id": 4414246,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "profile_image": "https://i.stack.imgur.com/HDcLp.jpg?s=256&g=1",
                        "display_name": "David A Stumpf",
                        "link": "https://stackoverflow.com/users/4414246/david-a-stumpf"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1697250528,
                    "answer_id": 77291412,
                    "question_id": 77289431,
                    "body_markdown": "elementID is a string, but you can get the id as illustrated here:\r\n\r\n    match (n) return  toInteger(split(elementId(n),&#39;:&#39;)[2]) \r\n\r\n",
                    "title": "How to use Neo4j&#39;s gds.shortestPath.dijkstra.stream for nodes with elementId(node) intead of id(node)?"
                },
                {
                    "owner": {
                        "account_id": 28792384,
                        "reputation": 51,
                        "user_id": 22051375,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/ebac96d9426add4ab84d30940c7cd511?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "florentin",
                        "link": "https://stackoverflow.com/users/22051375/florentin"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1697402128,
                    "answer_id": 77298404,
                    "question_id": 77289431,
                    "body_markdown": "You can also pass the whole node to the procedure. lets GDS handle the rest on how to identify the node.",
                    "title": "How to use Neo4j&#39;s gds.shortestPath.dijkstra.stream for nodes with elementId(node) intead of id(node)?"
                }
            ],
            "owner": {
                "account_id": 477089,
                "reputation": 512,
                "user_id": 888367,
                "user_type": "registered",
                "accept_rate": 33,
                "profile_image": "https://i.stack.imgur.com/hGdwz.jpg?s=256&g=1",
                "display_name": "Andr&#233;s Meza-Escall&#243;n",
                "link": "https://stackoverflow.com/users/888367/andr%c3%a9s-meza-escall%c3%b3n"
            },
            "is_answered": true,
            "view_count": 35,
            "favorite_count": 0,
            "accepted_answer_id": 77298404,
            "answer_count": 3,
            "score": 0,
            "creation_date": 1697215438,
            "question_id": 77289431,
            "body_markdown": "I have a graph projected from nodes and relationships &quot;(n1:Place)-[r:COST]-&gt;(n2:Place)&quot;.\r\nTo find the cheapest path between two nodes with names &#39;a&#39; and &#39;z&#39; I use [Dijkstra&#39;s shortest path algorithm][1]:\r\n\r\n    MATCH (start:Place) where &#39;a&#39; = start.name\r\n    MATCH (end:Place) where &#39;z&#39; = end.name\r\n    CALL gds.shortestPath.dijkstra.stream(&#39;my-graph&#39;,{\r\n        sourceNode: id(start),\r\n        targetNode: id(end),\r\n        relationshipWeightProperty: &#39;cost&#39;\r\n    })\r\n    YIELD nodeIds\r\n\r\nIt works perfectly, but I read that [id(node):int is deprecated][2] and in Neo4j 1.5.8 I should use the new [elementId(node):string][3] function instead. \r\n\r\n\r\n    MATCH (start:Place) where &#39;a&#39; = start.name\r\n    MATCH (end:Place) where &#39;z&#39; = end.name\r\n    CALL gds.shortestPath.dijkstra.stream(&#39;my-graph&#39;,{\r\n        sourceNode: elementId(start),\r\n        targetNode: elementId(end),\r\n        relationshipWeightProperty: &#39;cost&#39;\r\n    })\r\n    YIELD nodeIds\r\n\r\nHowever, since elementId() returns a string instead of an int, it causes an exception:\r\n\r\n    Failed to invoke procedure `gds.shortestPath.dijkstra.stream`: Caused by: java.lang.IllegalArgumentException: Expected a node or a node id for `sourceNode`. Got String. \r\n\r\n \r\n\r\nIs there another option that supports pathfinding using elementId() instead of id()? \r\n\r\n\r\n  [1]: https://neo4j.com/docs/graph-data-science/current/algorithms/dijkstra-source-target/\r\n  [2]: https://neo4j.com/docs/cypher-manual/current/functions/scalar/#functions-id\r\n  [3]: https://neo4j.com/docs/cypher-manual/current/functions/scalar/#functions-elementid",
            "link": "https://stackoverflow.com/questions/77289431/how-to-use-neo4js-gds-shortestpath-dijkstra-stream-for-nodes-with-elementidnod",
            "title": "How to use Neo4j&#39;s gds.shortestPath.dijkstra.stream for nodes with elementId(node) intead of id(node)?"
        },
        {
            "tags": [
                "amazon-ec2",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 3908099,
                        "reputation": 187,
                        "user_id": 3234217,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/fdf0b82ca9731a859d7705aff9123621?s=256&d=identicon&r=PG",
                        "display_name": "Makarov",
                        "link": "https://stackoverflow.com/users/3234217/makarov"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697256887,
                    "answer_id": 77291596,
                    "question_id": 77284758,
                    "body_markdown": "The issue was that I was running the `neo4j-admin database load` command as `root`\r\n**Solution:** \r\n\r\n    su neo4j             // this is the default user the ec2 neo4j template created for me\r\n    cd $HOME\r\n    wget &quot;url to backup&quot; // download of put .dump file here\r\n    pwd                  // To then add it the path of the neo4j load command\r\n    neo4j-admin database load --from-path=/var/lib/neo4j neo4j --overwrite-destination=true",
                    "title": "Neo4j export from Aura to AWS EC2 community instance corrupts database"
                }
            ],
            "owner": {
                "account_id": 3908099,
                "reputation": 187,
                "user_id": 3234217,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/fdf0b82ca9731a859d7705aff9123621?s=256&d=identicon&r=PG",
                "display_name": "Makarov",
                "link": "https://stackoverflow.com/users/3234217/makarov"
            },
            "is_answered": false,
            "view_count": 27,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697164325,
            "question_id": 77284758,
            "body_markdown": "I&#39;m moving a database from Neo4j AURA to a Neo4j community edition instance hosted in AWS EC2.\r\n\r\n**The problem:**\r\nI export one of the AURA snapshots, it downloads a `neo4j.dump` file. When using the next command on the EC2 instance to **import / load** the file `neo4j-admin database load --from-path=/root neo4j --overwrite-destination=true` the process is okay but after that, I can&#39;t connect to the database using the browser or any driver anymore, the browser connects via `bolt` but it gives me an error that *neo4j database is no available use command* `:sysinfo` *for more information*\r\n\r\n[![enter image description here][1]][1]\r\n\r\nAlso when running `neo4j-admin database check neo4j`\r\n\r\nGet:\r\n[![enter image description here][2]][2]\r\n[![enter image description here][3]][3]\r\n\r\n**Notes:**\r\n- I have repeated the process by creating new EC2 Neo4j instances and the result is the same, I also tried in the Enterprise edition with no luck\r\n- If anyone is wondering why I&#39;m moving from AURA, the reason is the latency/connection time, our server is in Heroku, and with aura, every query takes up to &gt;300ms even just doing a simple MATCH, in the EC2 instance takes &lt;10ms.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/CTUYJ.png\r\n  [2]: https://i.stack.imgur.com/Gvszp.png\r\n  [3]: https://i.stack.imgur.com/lyOzr.png",
            "link": "https://stackoverflow.com/questions/77284758/neo4j-export-from-aura-to-aws-ec2-community-instance-corrupts-database",
            "title": "Neo4j export from Aura to AWS EC2 community instance corrupts database"
        },
        {
            "tags": [
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 28792384,
                        "reputation": 51,
                        "user_id": 22051375,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/ebac96d9426add4ab84d30940c7cd511?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "florentin",
                        "link": "https://stackoverflow.com/users/22051375/florentin"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1697033855,
                    "answer_id": 77273909,
                    "question_id": 77273741,
                    "body_markdown": "Do you have the GDS plugin installed? \r\nWithout the jar in the plugins folder Neo4j would throw this exception",
                    "title": "NEO4J issues with gds.enterprise.license.file"
                }
            ],
            "owner": {
                "account_id": 23165013,
                "reputation": 11,
                "user_id": 17265089,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/E1qDn.jpg?s=256&g=1",
                "display_name": "William Hardison",
                "link": "https://stackoverflow.com/users/17265089/william-hardison"
            },
            "is_answered": false,
            "view_count": 62,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697032599,
            "question_id": 77273741,
            "body_markdown": "I&#39;m trying to start my neo4j server but I ran into this issue below; yes my gds license is good and  I made sure to &quot;chown&quot; the file so neo4j is the owner.\r\n\r\n    neo4j.service - Neo4j Graph Database\r\n         Loaded: loaded (/usr/lib/systemd/system/neo4j.service; disabled; preset: disabled)\r\n         Active: failed (Result: exit-code) since Wed 2023-10-11 13:41:14 UTC; 6s ago\r\n       Duration: 1.666s\r\n        Process: 29539 ExecStart=/usr/share/neo4j/bin/neo4j console (code=exited, status=1/FAILURE)\r\n       Main PID: 29539 (code=exited, status=1/FAILURE)\r\n            CPU: 3.944s\r\n    \r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal neo4j[29539]: Validating Neo4j configuration: /etc/neo4j/neo4j.conf\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal neo4j[29539]: 1 issue found.\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal neo4j[29539]: Error: Unrecognized setting. No declared setting with name: gds.enterprise.license_file. Cleanup the conf&gt;\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal neo4j[29539]: Skipping Log4j validation due to previous issues.\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal neo4j[29539]: Configuration file validation failed.\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal neo4j[29539]: Configuration contains errors. This validation can be performed again using &#39;neo4j-admin server validate-&gt;\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal neo4j[29539]: Run with &#39;--verbose&#39; for a more detailed error message.\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal systemd[1]: neo4j.service: Main process exited, code=exited, status=1/FAILURE\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal systemd[1]: neo4j.service: Failed with result &#39;exit-code&#39;.\r\n    Oct 11 13:41:14 ip-172-31-2-140.us-gov-east-1.compute.internal systemd[1]: neo4j.service: Consumed 3.944s CPU time.\r\n\r\nI double checked my file in the neo4j.conf and it looks good to me:\r\n\r\n![enter image description here](https://i.stack.imgur.com/ELppM.png)\r\n",
            "link": "https://stackoverflow.com/questions/77273741/neo4j-issues-with-gds-enterprise-license-file",
            "title": "NEO4J issues with gds.enterprise.license.file"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1697044524,
                    "answer_id": 77275116,
                    "question_id": 77272847,
                    "body_markdown": "If you already have the data in your DB, you can use a query like the following. It also removes the redundant `infId` property after creating the relationships.\r\n\r\n    MATCH (s1:Style)\r\n    WITH s1, SPLIT(s1.infId, &#39;;&#39;) AS infs\r\n    MATCH (s2:Style)\r\n    WHERE s2.styId IN infs\r\n    CREATE (s1)-[:INFLUENCED_BY]-&gt;(s2)\r\n    REMOVE s1.infId // Remove redundant infId property\r\n\r\nBeforehand, you should create an [index](https://neo4j.com/docs/cypher-manual/current/indexes-for-search-performance/) on the `styId` property of `Style`, to speed up the query:\r\n\r\n    CREATE INDEX Style_styId FOR (s:Style) ON (s.styId)\r\n\r\n#### Alternate suggestion\r\n\r\nBut, even better, you should have created the data model you wanted when ingesting the data into your DB, instead of fixing up the DB afterwards.\r\n\r\nThere are multiple [ways to import CSV](https://neo4j.com/docs/getting-started/data-import/csv-import/) into neo4j. The simplest is via [LOAD CSV](https://neo4j.com/docs/cypher-manual/current/clauses/load-csv/), so here is an example. Assuming your CSV file has a header row:\r\n\r\n    CALL {\r\n      LOAD CSV WITH HEADERS FROM &#39;file:///styles.csv&#39; AS r\r\n      CREATE (s:Style {id: r.styId, name: r.Style, dates: r.Dates, influences: SPLIT(r.Influences, &#39;;&#39;)})\r\n      MERGE (loc:Location {name: r.Location})\r\n      CREATE (s)-[:LOCATION]-&gt;(l)\r\n    }\r\n    LOAD CSV WITH HEADERS FROM &#39;file:///styles.csv&#39; AS row\r\n    MATCH (s1:Style)\r\n    WHERE s1.id = row.styId\r\n    WITH s1, SPLIT(s1.infId, &#39;;&#39;) AS infs\r\n    MATCH (s2:Style)\r\n    WHERE s2.id IN infs\r\n    CREATE (s1)-[:INFLUENCED_BY]-&gt;(s2)\r\n\r\nYou may also want to create an index on `Location.name` if you have more than a few locations.\r\n\r\nNote that this creates a slightly different data model than yours, in that:\r\n - each `Style` node points to a unique `Location` node\r\n - the `influences` property (which you may want to omit) is a list of strings\r\n - the `styId` is stored as the `id` property (since it is obvious that the id is for a style). This requires that your id index is created like this:\r\n\r\n       CREATE INDEX Style_id FOR (s:Style) ON (s.id)\r\n\r\nThe ingestion is done with 2 imports from the CSV file; the first is for creating all the `Style` nodes, and the second is for creating all the `INFLUENCED_BY` relationships. The [CALL subquery](https://neo4j.com/docs/cypher-manual/current/subqueries/call-subquery/) is used to cleanly separate the 2 `LOAD CSV` invocations (otherwise, you would need to perform an aggregation between them just to reduce the number of rows back down to 1).\r\n\r\nThe above solution assumes you do not have a lot of styles, and so it does everything in a single transaction. If you have a lot of styles, you will have to change (and perhaps split up) the query to avoid running out of memory and/or taking too long.",
                    "title": "Creating relationships between nodes of the same label?"
                },
                {
                    "owner": {
                        "account_id": 5567614,
                        "reputation": 773,
                        "user_id": 4414246,
                        "user_type": "registered",
                        "accept_rate": 60,
                        "profile_image": "https://i.stack.imgur.com/HDcLp.jpg?s=256&g=1",
                        "display_name": "David A Stumpf",
                        "link": "https://stackoverflow.com/users/4414246/david-a-stumpf"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1697162046,
                    "answer_id": 77284656,
                    "question_id": 77272847,
                    "body_markdown": "Remember, your relationships can have properties and they too can be indexed. A major advantage of graphs is the relationships, unlike a RBDS database, are not mere connections. They have knowledge. This can be used for provenance, filtered traversals, storing unique data that should not be in the connected nodes, etc. \r\n\r\nIf you want examples, look at how this was done with DNA segments that are used in matching persons in genealogy. With a well developed knowledge graph you create amazing vale ... such as re-creating your ancestor&#39;s DNA\r\n\r\n[https://www.wai.md/post/the-field-of-dreams-ancestor-avatars][1]\r\n\r\n\r\n  [1]: https://www.wai.md/post/the-field-of-dreams-ancestor-avatars",
                    "title": "Creating relationships between nodes of the same label?"
                }
            ],
            "owner": {
                "account_id": 29582250,
                "reputation": 25,
                "user_id": 22671757,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocJhDjoEsKNCaLI6rhKKAu0iGIdhEKiClG6pv311HWs2=k-s256",
                "display_name": "anji",
                "link": "https://stackoverflow.com/users/22671757/anji"
            },
            "is_answered": true,
            "view_count": 41,
            "favorite_count": 0,
            "accepted_answer_id": 77275116,
            "answer_count": 2,
            "score": 1,
            "creation_date": 1697025443,
            "question_id": 77272847,
            "body_markdown": "I have a database of architectural style periods, imported from a csv. Each `Style` has a `styId`, and an `infId` which shows the previous styles that have influenced it.\r\n\r\nI would like to create relationships between the styles if they are mentioned as an influence, like so:\r\n\r\n#### Anglo-saxon style influenced by Roman style\r\n\r\n![Anglo-saxon style influenced by Roman style](https://i.stack.imgur.com/f6WR5.png)\r\n\r\n#### styId and infId with matching values\r\n\r\n![styId and infId with matching values](https://i.stack.imgur.com/eUgyT.png)\r\n\r\nI know that this will be a case of matching the `styId` to the `infId` but I am not a data scientist and very new to NEO4j. I can do this by manually specifying relationships, but I&#39;m building this dataset myself and plan to add more entries later, so if there is a best practice to creating these relationships by going off of the `styId` and `infId` alone I&#39;d much prefer that option.\r\n\r\nThanks for any help, let me know if anything is unclear.",
            "link": "https://stackoverflow.com/questions/77272847/creating-relationships-between-nodes-of-the-same-label",
            "title": "Creating relationships between nodes of the same label?"
        },
        {
            "tags": [
                "neo4j",
                "liquibase",
                "liquibase-maven-plugin",
                "neo4j-aura"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 103469,
                        "reputation": 8520,
                        "user_id": 277128,
                        "user_type": "registered",
                        "accept_rate": 79,
                        "profile_image": "https://www.gravatar.com/avatar/f06979a03b9b522c80cb12def209c31a?s=256&d=identicon&r=PG",
                        "display_name": "fbiville",
                        "link": "https://stackoverflow.com/users/277128/fbiville"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1697025300,
                    "answer_id": 77272821,
                    "question_id": 77272286,
                    "body_markdown": "You are using the wrong driver.\r\nIt should be `liquibase.ext.neo4j.database.jdbc.Neo4jDriver`.\r\nI should probably rework [the documentation section on this][1].\r\n\r\n\r\n  [1]: https://www.neo4j.com/labs/liquibase/docs/reference-configuration/",
                    "title": "Why am I getting ClassCastException when running Liquibase?"
                }
            ],
            "owner": {
                "account_id": 29150732,
                "reputation": 5,
                "user_id": 22331646,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AAcHTtesEqX1eyr1hDYJLzMFiQ5RYz1R1gV_inXdFNK4pQXdv_pQ=k-s256",
                "display_name": "Sabi Franjo",
                "link": "https://stackoverflow.com/users/22331646/sabi-franjo"
            },
            "is_answered": true,
            "view_count": 40,
            "favorite_count": 0,
            "accepted_answer_id": 77272821,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1697020894,
            "question_id": 77272286,
            "body_markdown": "I&#39;m trying to configure Liquibase to work with our neo4j Aura instance. The first time I run it, it   works fine, but every subsequent time I am getting this error:\r\n\r\n\r\n```\r\n[ERROR] Failed to execute goal org.liquibase:liquibase-maven-plugin:4.24.0:update (default) on project liquibase: \r\n[ERROR] Error setting up or running Liquibase:\r\n[ERROR] java.lang.ClassCastException: class java.time.ZonedDateTime cannot be cast to class java.sql.Timestamp (java.time.ZonedDateTime is in module java.base of loader &#39;bootstrap&#39;; java.sql.Timestamp is in module java.sql of loader &#39;platform&#39;)\r\n\r\n```\r\n\r\nThe version of liquibase and the neo4j extension is 4.24.0, the plugin configuration in maven is like this:\r\n\r\n```\r\n            &lt;plugin&gt;\r\n                &lt;groupId&gt;org.liquibase&lt;/groupId&gt;\r\n                &lt;artifactId&gt;liquibase-maven-plugin&lt;/artifactId&gt;\r\n                &lt;version&gt;${liquibase.version}&lt;/version&gt;\r\n                &lt;configuration&gt;\r\n                    &lt;changeLogFile&gt;liquibase/changelog.xml&lt;/changeLogFile&gt;\r\n                    &lt;url&gt;jdbc:neo4j:neo4j+s://MYAURAURL:7687&lt;/url&gt;\r\n                    &lt;driver&gt;org.neo4j.jdbc.boltrouting.BoltRoutingNeo4jDriver&lt;/driver&gt;\r\n                    &lt;username&gt;neo4j&lt;/username&gt;\r\n                    &lt;password&gt;MYAURAPASS&lt;/password&gt;\r\n                &lt;/configuration&gt;\r\n                &lt;executions&gt;\r\n                    &lt;execution&gt;\r\n                        &lt;phase&gt;process-resources&lt;/phase&gt;\r\n                        &lt;goals&gt;\r\n                            &lt;goal&gt;update&lt;/goal&gt;\r\n                        &lt;/goals&gt;\r\n                    &lt;/execution&gt;\r\n                &lt;/executions&gt;\r\n            &lt;/plugin&gt;\r\n```\r\n\r\nI&#39;m guessing it&#39;s trying to cast these that show up in the database:\r\ndateCreated: 2023-10-11T10:32:17.024000000Z\r\ndateUpdated: 2023-10-11T10:33:24.253000000Z\r\nBut that isn&#39;t anything that I&#39;ve defined explicitly. \r\n\r\nI&#39;ve tried running with previous versions of the liquibase plugin. It either gives the same message or doesn&#39;t run at all.",
            "link": "https://stackoverflow.com/questions/77272286/why-am-i-getting-classcastexception-when-running-liquibase",
            "title": "Why am I getting ClassCastException when running Liquibase?"
        },
        {
            "tags": [
                "python",
                "neo4j",
                "graph-databases",
                "py2neo"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 2015086,
                        "reputation": 176,
                        "user_id": 1802600,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/f0Tx6.jpg?s=256&g=1",
                        "display_name": "chintan-p-bhatt",
                        "link": "https://stackoverflow.com/users/1802600/chintan-p-bhatt"
                    },
                    "is_accepted": true,
                    "score": 5,
                    "creation_date": 1697005379,
                    "answer_id": 77270610,
                    "question_id": 77270468,
                    "body_markdown": "You can see updates here https://community.neo4j.com/t/farewell-py2neo-what-happens-now/64419\r\n\r\nCopied from Above link, \r\n\r\n - https://github.com/overhangio/py2neo,\r\n - https://github.com/SarLecobee/py2neo,    \r\n - https://github.com/neo4j-field/py2neo,\r\n\r\nAnd One can see here as well, https://www.reddit.com/r/Neo4j/comments/174jl66/py2neo_no_longer_available/",
                    "title": "Looking for a Py2neo fork"
                },
                {
                    "owner": {
                        "account_id": 6291155,
                        "reputation": 560,
                        "user_id": 4888809,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/6IGf0.jpg?s=256&g=1",
                        "display_name": "buda",
                        "link": "https://stackoverflow.com/users/4888809/buda"
                    },
                    "is_accepted": false,
                    "score": 3,
                    "creation_date": 1697047023,
                    "answer_id": 77275372,
                    "question_id": 77270468,
                    "body_markdown": "https://github.com/memgraph/gqlalchemy is also an Object Graph Mapper (equivalent to the `py2neo`) maintained by memgraph.com. It&#39;s compatible with py2neo, but maybe an option is to migrate because the project will be maintained.\r\n\r\nDISCLAIMER: I&#39;m the co-founder and CTO of Memgraph",
                    "title": "Looking for a Py2neo fork"
                }
            ],
            "owner": {
                "account_id": 10682648,
                "reputation": 103,
                "user_id": 7864196,
                "user_type": "registered",
                "profile_image": "https://lh5.googleusercontent.com/-MRs4gF3pufo/AAAAAAAAAAI/AAAAAAAAAF8/d9LeeXorzuM/photo.jpg?sz=256",
                "display_name": "Tinashe Muchabaiwa",
                "link": "https://stackoverflow.com/users/7864196/tinashe-muchabaiwa"
            },
            "is_answered": true,
            "view_count": 239,
            "favorite_count": 0,
            "accepted_answer_id": 77270610,
            "answer_count": 2,
            "score": 2,
            "creation_date": 1697003456,
            "question_id": 77270468,
            "body_markdown": "Unfortunately due to some internal politics within neo4j, the py2neo project is now EOL and was deleted from pypi. See this [twitter thread](https://twitter.com/technige/status/1659452229659643906).\r\n\r\nIs there anyone who might have forked the GitHub repository? ",
            "link": "https://stackoverflow.com/questions/77270468/looking-for-a-py2neo-fork",
            "title": "Looking for a Py2neo fork"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1696873776,
                    "answer_id": 77260862,
                    "question_id": 77260454,
                    "body_markdown": "[Your graph](https://i.stack.imgur.com/J5RN1.png) is inconsistent with the Cypher code you have shown. It has have a `Style` node that has a `name` property and is missing `Style`, `Dates`, and `Location` properties. You need to fix what is creating these inconsistent `Style` nodes, since `MERGE (s:Style {Style: stylesheet.Style, Dates: stylesheet.`Dates`, Location: stylesheet.Location})` will never match such a `Style` node.\r\n\r\n### Some MERGE best practices\r\n\r\n 1.   Multiple [MERGE](https://neo4j.com/docs/cypher-manual/current/clauses/merge/) clauses for the same label should all specify the same set of properties, since a `MERGE` clause with more properties will not match a node created by a `MERGE` clause with fewer properties.\r\n\r\n 2. Ideally, a `MERGE` clause should only specify the minimum properties needed (if any) to uniquely identify a node (or relationship).\r\n\r\n    For example, instead of:\r\n\r\n        MERGE (a:Architect {Architect: architectsheet.Name, Born: architectsheet.Born, Died: architectsheet.Died, Description: architectsheet.Description})\r\n\r\n    it would be safer to use this (assuming architect names are unique -- which is a bad assumption, by the way):\r\n\r\n        MERGE (a:Architect {Architect: architectsheet.Name})\r\n        ON CREATE SET s += {Born: architectsheet.Born, Died: architectsheet.Died, Description: architectsheet.Description}\r\n\r\n    or, even better, since architects can have the same name (but this option requires your non-Architects csv files to reference an architect using an id instead of a name):\r\n\r\n        MERGE (s:Style {id: architectsheet.archId})\r\n        ON CREATE SET s += {Architect: architectsheet.Name, Style: Dates: stylesheet.`Dates`, Location: stylesheet.Location}\r\n3. Do not use `MERGE` when you do not have data for all the properties needed to populate the node.",
                    "title": "How do I merge duplicate nodes as I load them in from multiple csv files?"
                }
            ],
            "owner": {
                "account_id": 29582250,
                "reputation": 25,
                "user_id": 22671757,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocJhDjoEsKNCaLI6rhKKAu0iGIdhEKiClG6pv311HWs2=k-s256",
                "display_name": "anji",
                "link": "https://stackoverflow.com/users/22671757/anji"
            },
            "is_answered": true,
            "view_count": 34,
            "favorite_count": 0,
            "accepted_answer_id": 77260862,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1696869145,
            "question_id": 77260454,
            "body_markdown": "Sorry if this is difficult to parse, have only been using NEO4j for a few days.\r\nI&#39;m trying to build a database from multiple csv files. &#39;styles.csv&#39; includes notable architects and buildings. The architect and buildings csv files have additional info on their respective entries.\r\n\r\n### Examples of data structures\r\n\r\n#### Styles csv\r\n![Styles csv snapshot][1]\r\n\r\n#### Buildings csv\r\n![Buildings csv snapshot][2]\r\n\r\n#### Architects csv\r\n![Architects csv snapshot][3]\r\n\r\nHowever, when I import the csv files sequentially it creates duplicate nodes for each node with the same name value. For example, [here it is creating a node for the &#39;roman&#39; style.][4]\r\n\r\nI am loading each csv sequentially and unwinding where there are cells with multiple values.\r\n\r\n\r\n```\r\nLOAD CSV WITH HEADERS FROM &#39;file:///restructured_data_styles.csv&#39; AS stylesheet\r\nMERGE (s:Style {Style: stylesheet.Style, Dates: stylesheet.`Dates`, Location: stylesheet.Location})\r\nWITH s, stylesheet\r\nUNWIND split(stylesheet.`Examples`, &#39;;&#39;) AS stylebuildings\r\nMERGE (buildings:Building{name:stylebuildings})\r\nMERGE (s)-[rbs:BUILT_IN_STYLE]-&gt;(buildings)\r\n```\r\n\r\n```\r\nLOAD CSV WITH HEADERS FROM &#39;file:///restructured_data_architects.csv&#39; AS architectsheet\r\nMERGE (a:Architect {Architect: architectsheet.Name, Born: architectsheet.Born, Died: architectsheet.Died, Description: architectsheet.Description})\r\nWITH a, architectsheet\r\nUNWIND split(architectsheet.`Buildings`, &#39;;&#39;) AS architectbuildings\r\nMERGE (buildings:Building{name:architectbuildings})\r\nMERGE (a)-[rab:NOTABLE_PROJECTS]-&gt;(buildings)\r\n\r\n```\r\n\r\nWhat I want is to load each csv and have neo4j add the additional information provided by each csv file, but also merge the duplicate nodes created while maintaining the relationships already present.\r\nAs it stands, the relationships built within files are fine, but I&#39;m having trouble linking these nodes and relationships *between* the csvs. Does that make sense? Will clarify further if not! Thanks!\r\n\r\nNodes are being created, but they don&#39;t merge based on their name values. Have looked into APOC refactoring but I am very new to this (and also not a data scientist!) - a dumbed down explanation would be very helpful.\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/ea5oP.png\r\n  [2]: https://i.stack.imgur.com/g71dM.png\r\n  [3]: https://i.stack.imgur.com/a5Yms.png\r\n  [4]: https://i.stack.imgur.com/J5RN1.png",
            "link": "https://stackoverflow.com/questions/77260454/how-do-i-merge-duplicate-nodes-as-i-load-them-in-from-multiple-csv-files",
            "title": "How do I merge duplicate nodes as I load them in from multiple csv files?"
        },
        {
            "tags": [
                "python",
                "docker",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": -1,
                    "creation_date": 1696880378,
                    "answer_id": 77261382,
                    "question_id": 77259921,
                    "body_markdown": "If you have TLS enabled, then you need to use a different bolt [URI scheme](https://neo4j.com/docs/bolt/current/driver-api/#uri-schemes). For example, `bolt+s`.\r\n\r\nFrom the docs:\r\n\r\n&gt; ## URI schemes\r\n&gt; #### No TLS enabled:\r\n&gt; \r\n&gt; - `bolt`: connect to a single Neo4j instance.\r\n&gt; - `neo4j`: connect to a Neo4j instance and use the routing table\r\n&gt; information for further connections.\r\n&gt; \r\n&gt; #### Enable TLS and allow self-signed certificate authority:\r\n&gt; \r\n&gt; - `bolt+ssc`\r\n&gt; - `neo4j+ssc`\r\n&gt; \r\n&gt; #### Enable TLS and only allow system enabled certificate authority and verify hostname:\r\n&gt; \r\n&gt; - `bolt+s`\r\n&gt; - `neo4j+s`\r\n\r\n",
                    "title": "neo4j.exceptions.ServiceUnavailable Connection to 127.0.0.1:7687 closed without handshake response"
                }
            ],
            "owner": {
                "account_id": 1620438,
                "reputation": 15219,
                "user_id": 1497139,
                "user_type": "registered",
                "accept_rate": 68,
                "profile_image": "https://i.stack.imgur.com/3FVKA.png?s=256&g=1",
                "display_name": "Wolfgang Fahl",
                "link": "https://stackoverflow.com/users/1497139/wolfgang-fahl"
            },
            "is_answered": false,
            "view_count": 119,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696863811,
            "question_id": 77259921,
            "body_markdown": "I keep getting\r\n```\r\nneo4j.exceptions.ServiceUnavailable: Couldn&#39;t connect to localhost:7687 (resolved to ()):\r\nConnection to 127.0.0.1:7687 closed without handshake response\r\n```\r\nwithout a proper explanation why the service is considered to be unavailable. I am using the official neoj4:latest docker image as outlined below. The check for the port to be available is positive and the web environment works fine at port 7474 happily connecting to port 7687. Just the python driver complains.\r\n\r\nInterestingly the CI test works of github fine - just the test in my Jenkins environment on a local ubuntu server reports the problem. \r\n\r\n**What might be the cause of this misbehavior?**\r\n\r\n\r\n**My Environment**\r\nPython Version: Python 3.10.12 (main, Jun 11 2023, 05:26:28) [GCC 11.4.0]\r\nDriver Version: Name: neo4j Version: 5.10.0\r\nSummary: Neo4j Bolt driver for Python\r\nServer Version and Edition: neo4j:latest docker images\r\nOperating System:Distributor ID:\tUbuntu\r\nDescription:\tUbuntu 22.04.3 LTS\r\nRelease:\t22.04\r\nCodename:\tjammy\r\n\r\nIssue to be addressed: https://github.com/WolfgangFahl/pyCEURmake/issues/84.\r\nYou&#39;ll  also find the source code of the snippets below in the above project.\r\n\r\n**Script to start neo4j**\r\nsee https://github.com/WolfgangFahl/pyCEURmake/blob/main/scripts/neo4j\r\n```bash\r\n#!/bin/bash\r\n# WF 2023-07-15\r\n\r\n# Stop and remove any existing Neo4j container\r\ndocker stop neo4j-instance\r\ndocker rm neo4j-instance\r\n\r\n# Run the Neo4j container\r\n# https://neo4j.com/developer/docker-run-neo4j/\r\ndocker run -d --name neo4j-instance \\\r\n  --publish=7474:7474 --publish=7687:7687 \\\r\n  --env NEO4J_AUTH=neo4j/password \\\r\n  --volume=$HOME/neo4j/data:/data \\\r\n  neo4j:latest\r\n\r\n# Function to display a progress bar\r\ndisplay_progress() {\r\n  local progress=$1\r\n  local max_progress=$2\r\n  local bar_length=40\r\n  local filled_length=$((progress * bar_length / max_progress))\r\n  local empty_length=$((bar_length - filled_length))\r\n\r\n  # Build the progress bar string\r\n  local bar=&quot;[&quot;\r\n  bar+=&quot;$(printf &quot;%${filled_length}s&quot; | tr &#39; &#39; &#39;#&#39;)&quot;\r\n  bar+=&quot;$(printf &quot;%${empty_length}s&quot; | tr &#39; &#39; &#39;-&#39;)&quot;\r\n  bar+=&quot;]&quot;\r\n\r\n  # Print the progress bar\r\n  printf &quot;\\r%s %d%%&quot; &quot;$bar&quot; $((progress * 100 / max_progress))\r\n}\r\n\r\n# Wait for Neo4j to start\r\nprogress=0\r\nmax_progress=20\r\nsleep_duration=0.5\r\nwhile [ &quot;$(docker inspect -f &#39;{{.State.Running}}&#39; neo4j-instance 2&gt;/dev/null)&quot; != &quot;true&quot; ] &amp;&amp; [ $progress -lt $max_progress ]; do\r\n  display_progress $progress $max_progress\r\n  ((progress++))\r\n  sleep $sleep_duration\r\ndone\r\n\r\n# Clear the progress bar line\r\nprintf &quot;\\r%${COLUMNS}s\\r&quot;\r\n\r\nif [ &quot;$(docker inspect -f &#39;{{.State.Running}}&#39; neo4j-instance 2&gt;/dev/null)&quot; == &quot;true&quot; ]; then\r\n  echo &quot;Neo4j is running.&quot;\r\nelse\r\n  echo &quot;Failed to start Neo4j.&quot;\r\nfi\r\n\r\n# Display the logs to check the status\r\ndocker logs neo4j-instance\r\n```\r\n\r\n**neo4j wrapper class**\r\n```python\r\nimport argparse\r\nimport json\r\nimport os\r\nimport re\r\nimport requests\r\nimport socket\r\nimport sys\r\n\r\nfrom typing import List, Optional\r\nfrom dataclasses import dataclass, field\r\nfrom neo4j import GraphDatabase\r\nfrom neo4j.exceptions import ServiceUnavailable, AuthError, ConfigurationError\r\n\r\n\r\nclass Neo4j:\r\n    &quot;&quot;&quot;\r\n    Neo4j wrapper class\r\n    &quot;&quot;&quot;\r\n    def __init__(self,host:str=&quot;localhost&quot;,bolt_port:int=7687,auth=(&quot;neo4j&quot;, &quot;password&quot;),encrypted:bool=False):\r\n        &quot;&quot;&quot;\r\n        constructor\r\n        &quot;&quot;&quot;\r\n        self.driver = None\r\n        self.error = None\r\n        self.host=host\r\n        self.bolt_port=bolt_port\r\n        self.encrypted=encrypted\r\n        try:\r\n            uri=f&quot;bolt://{host}:{bolt_port}&quot;      \r\n            if not Neo4j.is_port_available(host,bolt_port):\r\n                raise ValueError(f&quot;port at {uri} not available&quot;)\r\n            self.driver = GraphDatabase.driver(uri, auth=auth,encrypted=encrypted)\r\n        except (ServiceUnavailable, AuthError, ConfigurationError) as e:\r\n            self.error = e\r\n         \r\n    @classmethod   \r\n    def is_port_available(cls,host, port:int)-&gt;bool:\r\n        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\r\n        sock.settimeout(1)  # 1 Second Timeout\r\n        try:\r\n            sock.connect((host, port))\r\n        except socket.error:\r\n            return False\r\n        return True\r\n\r\n    def close(self):\r\n        if self.driver is not None:\r\n            self.driver.close()\r\n\r\n@dataclass\r\nclass Volume:\r\n    &quot;&quot;&quot;\r\n    Represents a volume with its attributes.\r\n    &quot;&quot;&quot;\r\n\r\n    acronym: str\r\n    title: str\r\n    loctime: str\r\n    editors: List[&#39;Editor&#39;] = field(default_factory=list)\r\n\r\n    @classmethod\r\n    def from_json(cls, json_data):\r\n        &quot;&quot;&quot;\r\n        Create a Volume instance from JSON data.\r\n\r\n        Args:\r\n            json_data (dict): The JSON data representing the volume.\r\n\r\n        Returns:\r\n            Volume: The Volume instance created from the JSON data.\r\n        &quot;&quot;&quot;\r\n        editor_names = json_data.get(&#39;editors&#39;)\r\n        if editor_names:\r\n            editor_names = editor_names.split(&quot;,&quot;)\r\n        else:\r\n            editor_names = []\r\n        editors = [Editor(name=name.strip()) for name in editor_names]\r\n        return cls(\r\n            acronym=json_data.get(&#39;acronym&#39;),\r\n            title=json_data.get(&#39;title&#39;),\r\n            loctime=json_data.get(&#39;loctime&#39;),\r\n            editors=editors\r\n        )\r\n\r\n    def create_node(self, tx) -&gt; int:\r\n        &quot;&quot;&quot;\r\n        Create a Volume node in Neo4j.\r\n    \r\n        Args:\r\n            tx: The Neo4j transaction.\r\n    \r\n        Returns:\r\n            int: The ID of the created node.\r\n        &quot;&quot;&quot;\r\n        query = &quot;&quot;&quot;\r\n        CREATE (v:Volume {acronym: $acronym, title: $title, loctime: $loctime})\r\n        RETURN id(v) as node_id\r\n        &quot;&quot;&quot;\r\n        parameters = {\r\n            &quot;acronym&quot;: self.acronym,\r\n            &quot;title&quot;: self.title,\r\n            &quot;loctime&quot;: self.loctime\r\n        }\r\n        result = tx.run(query, parameters)\r\n        record = result.single()\r\n        if record is not None:\r\n            return record[&quot;node_id&quot;]\r\n        else:\r\n            return None\r\n\r\n\r\n    @staticmethod\r\n    def load_json_file(source: str) -&gt; List[&#39;Volume&#39;]:\r\n        &quot;&quot;&quot;\r\n        Load volumes from the source JSON file.\r\n\r\n        Args:\r\n            source (str): Path to the source JSON file.\r\n\r\n        Returns:\r\n            List[Volume]: The list of loaded volumes.\r\n        &quot;&quot;&quot;\r\n        with open(source, &#39;r&#39;) as file:\r\n            json_data = json.load(file)\r\n\r\n        volumes = [Volume.from_json(volume_data) for volume_data in json_data]\r\n        return volumes\r\n    \r\n    @classmethod\r\n    def default_source(cls)-&gt;str:\r\n        &quot;&quot;&quot;\r\n        get the default source\r\n        &quot;&quot;&quot;\r\n        default_source = os.path.expanduser(&#39;~/.ceurws/volumes.json&#39;)\r\n        return default_source\r\n    \r\n    @classmethod\r\n    def parse_args(cls,argv:list=None):\r\n        &quot;&quot;&quot;\r\n        Parse command line arguments.\r\n        \r\n        Args:\r\n            argv(list): command line arguments\r\n\r\n        Returns:\r\n            argparse.Namespace: The parsed command line arguments.\r\n        &quot;&quot;&quot;\r\n        \r\n        default_source = cls.default_source()\r\n        parser = argparse.ArgumentParser(description=&quot;Volume/Editor/Location Information&quot;)\r\n        parser.add_argument(&#39;--source&#39;, default=default_source, help=&quot;Source JSON file path&quot;)\r\n        # Add progress option\r\n        parser.add_argument(&#39;--progress&#39;, action=&#39;store_true&#39;, help=&quot;Display progress information&quot;)\r\n  \r\n        return parser.parse_args(argv)\r\n\r\n    @staticmethod\r\n    def main(argv=None):\r\n        if argv is None:\r\n            argv=sys.argv[1:]\r\n        args = Volume.parse_args(argv)\r\n        volumes = Volume.load_json_file(args.source)\r\n\r\n        # Connect to Neo4j\r\n        driver = GraphDatabase.driver(&quot;bolt://localhost:7687&quot;, auth=(&quot;neo4j&quot;, &quot;password&quot;))\r\n        with driver.session() as session:\r\n            for volume in volumes:\r\n                volume_node_id = volume.create_node(session)\r\n                for editor in volume.editors:\r\n                    editor.search_by_name()\r\n                    editor.create_node(session, volume_node_id)\r\n\r\n\r\n@dataclass\r\nclass Editor:\r\n    &quot;&quot;&quot;\r\n    Represents an editor with their name and ORCID.\r\n    &quot;&quot;&quot;\r\n\r\n    name: str\r\n    orcid: str = None\r\n    likelihood: float = None\r\n\r\n    @classmethod\r\n    def from_json(cls, json_data):\r\n        &quot;&quot;&quot;\r\n        Create an Editor instance from JSON data.\r\n\r\n        Args:\r\n            json_data (dict): The JSON data representing the editor.\r\n\r\n        Returns:\r\n            Editor: The Editor instance created from the JSON data.\r\n        &quot;&quot;&quot;\r\n        return cls(\r\n            name=json_data.get(&#39;name&#39;),\r\n            orcid=json_data.get(&#39;orcid&#39;)\r\n        )\r\n\r\n    def search_by_name(self):\r\n        &quot;&quot;&quot;\r\n        Search the editor by name using the ORCID API and calculate the likelihood.\r\n        &quot;&quot;&quot;\r\n        if self.name:\r\n            url = f&quot;https://pub.orcid.org/v3.0/search/?q={self.name}&quot;\r\n            headers = {\r\n                &quot;Accept&quot;: &quot;application/json&quot;\r\n            }\r\n            response = requests.get(url, headers=headers)\r\n            if response.status_code == 200:\r\n                data = response.json()\r\n                num_results = data.get(&quot;num-found&quot;, 0)\r\n                self.likelihood = num_results / 10  # Arbitrary calculation, adjust as needed\r\n\r\n    def create_node(self, tx, volume_node_id: int) -&gt; int:\r\n        &quot;&quot;&quot;\r\n        Create an Editor node in Neo4j and establish a relationship with a Volume node.\r\n    \r\n        Args:\r\n            tx: The Neo4j transaction.\r\n            volume_node_id (int): The ID of the volume node.\r\n    \r\n        Returns:\r\n            int: The ID of the created Editor node.\r\n        &quot;&quot;&quot;\r\n        query = &quot;&quot;&quot;\r\n        MATCH (v:Volume)\r\n        WHERE id(v) = $volume_node_id\r\n        CREATE (v)-[:HAS_EDITOR]-&gt;(e:Editor {name: $name, orcid: $orcid, likelihood: $likelihood})\r\n        RETURN id(e) as node_id\r\n        &quot;&quot;&quot;\r\n        parameters = {\r\n            &quot;volume_node_id&quot;: volume_node_id,\r\n            &quot;name&quot;: self.name,\r\n            &quot;orcid&quot;: self.orcid,\r\n            &quot;likelihood&quot;: self.likelihood\r\n        }\r\n        result = tx.run(query, parameters)\r\n        record = result.single()\r\n        if record is not None:\r\n            return record[&quot;node_id&quot;]\r\n        else:\r\n            return None\r\n\r\n\r\n\r\n@dataclass\r\nclass Location:\r\n    city: str\r\n    country: str\r\n    date: str\r\n\r\n    @staticmethod\r\n    def parse(location_str: str) -&gt; Optional[&#39;Location&#39;]:\r\n        &quot;&quot;&quot;\r\n        Parse a location string of the format &quot;City, Country, Date&quot;\r\n\r\n        Args:\r\n            location_str: The location string to parse.\r\n\r\n        Returns:\r\n            A Location object or None if the string could not be parsed.\r\n        &quot;&quot;&quot;\r\n        match = re.match(r&#39;^(.*), (.*), (.*)$&#39;, location_str)\r\n        if match:\r\n            city, country, date = match.groups()\r\n            return Location(city, country, date)\r\n        else:\r\n            return None\r\n\r\nif __name__ == &quot;__main__&quot;:\r\n    Volume.main()\r\n```\r\n\r\n**unittest**\r\n```python\r\nimport json\r\nfrom ceurws.volume_neo4j import Neo4j,Volume, Editor\r\nfrom ceurws.location import LocationLookup\r\nfrom tests.basetest import Basetest\r\n\r\nclass TestVolumeEditorLocation(Basetest):\r\n    &quot;&quot;&quot;\r\n    Unit tests for Volume, Editor, and Location classes.\r\n    &quot;&quot;&quot;\r\n    \r\n    def setUp(self, debug=False, profile=True):\r\n        Basetest.setUp(self, debug=debug, profile=profile)\r\n        self.neo4j=Neo4j()\r\n        \r\n    def tearDown(self):\r\n        Basetest.tearDown(self)\r\n        self.neo4j.close()\r\n        \r\n    def test_neo4j_available(self):\r\n        &quot;&quot;&quot;\r\n        test the port availability\r\n        &quot;&quot;&quot;\r\n        for service,port in [(&quot;bolt&quot;,self.neo4j.bolt_port),(&quot;http&quot;,7474)]:\r\n            available=Neo4j.is_port_available(self.neo4j.host, port)\r\n            self.assertTrue(available,f&quot;{service} service at {port}&quot;)\r\n            \r\n    def create_test_volume(self, year: int=2023) -&gt; int:\r\n        &quot;&quot;&quot;\r\n        Creates a test Volume node for the given year.\r\n    \r\n        Args:\r\n            year (int): The year for which to create the Volume.\r\n    \r\n        Returns:\r\n            int: The ID of the created Volume node.\r\n        &quot;&quot;&quot;\r\n        with self.neo4j.driver.session() as session:\r\n            with session.begin_transaction() as tx:\r\n                acronym = f&quot;CILC {year}&quot;\r\n                title = f&quot;Proceedings of the {year-1985}th Italian Conference on Computational Logic&quot;\r\n                loctime = f&quot;Some City, Italy, June 21-23, {year}&quot;\r\n                volume = Volume(acronym=acronym, title=title, loctime=loctime)\r\n                volume_id = volume.create_node(tx)\r\n            return volume_id\r\n\r\n    def test_volume_create_node(self):\r\n        &quot;&quot;&quot;\r\n        Test the create_node method of the Volume class.\r\n        &quot;&quot;&quot;\r\n        volume_id=self.create_test_volume()\r\n        self.assertIsNotNone(volume_id)\r\n        \r\n    def test_editor_create_editor_node(self):\r\n        &quot;&quot;&quot;\r\n        Test the create_editor_node method of the Editor class.\r\n        &quot;&quot;&quot;\r\n        volume_id_2023 = self.create_test_volume(2023)\r\n        volume_id_2024 = self.create_test_volume(2024)\r\n    \r\n        with self.neo4j.driver.session() as session:\r\n            with session.begin_transaction() as tx:\r\n                # Test creating one editor for multiple volumes\r\n                editor = Editor(name=&quot;John Doe&quot;, likelihood=0.8)\r\n                editor_id_2023 = editor.create_node(tx, volume_id_2023)\r\n                editor_id_2024 = editor.create_node(tx, volume_id_2024)\r\n        \r\n                self.assertIsNotNone(editor_id_2023)\r\n                self.assertIsNotNone(editor_id_2024)\r\n            \r\n    def test_location_lookup(self):\r\n        &quot;&quot;&quot;\r\n        Test the lookup method of the LocationLookup class.\r\n        &quot;&quot;&quot;\r\n        location_lookup = LocationLookup()\r\n        location = location_lookup.lookup(&quot;Amsterdam, Netherlands&quot;)\r\n        self.assertIsNotNone(location)\r\n        self.assertEqual(location.name, &quot;Amsterdam&quot;)\r\n        self.assertEqual(location.country.iso, &quot;NL&quot;)\r\n\r\n    def test_parse_args(self):\r\n        &quot;&quot;&quot;\r\n        Test the parse_args function.\r\n        &quot;&quot;&quot;\r\n        source=Volume.default_source()\r\n        args = Volume.parse_args([&quot;--source&quot;, source])\r\n        self.assertEqual(args.source, source)\r\n\r\n    def test_json_loading(self):\r\n        &quot;&quot;&quot;\r\n        Test the JSON loading from a file.\r\n        &quot;&quot;&quot;\r\n        with open(Volume.default_source()) as file:\r\n            json_data = json.load(file)\r\n        self.assertIsNotNone(json_data)\r\n        pass\r\n```\r\n",
            "link": "https://stackoverflow.com/questions/77259921/neo4j-exceptions-serviceunavailable-connection-to-127-0-0-17687-closed-without",
            "title": "neo4j.exceptions.ServiceUnavailable Connection to 127.0.0.1:7687 closed without handshake response"
        },
        {
            "tags": [
                "recursion",
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1696875559,
                    "answer_id": 77261015,
                    "question_id": 77256130,
                    "body_markdown": "This query uses the APOC procedure [apoc.convert.toTree](https://neo4j.com/docs/apoc/current/overview/apoc.convert/apoc.convert.toTree/) to generate a tree:\r\n\r\n    MATCH p = (post:POST)&lt;-[:COMMENTED_ON]-(:COMMENT)-[:REPLIED_TO|COMMENTED_ON *0..]-(:COMMENT)\r\n    WHERE ID(post) = 5\r\n    WITH COLLECT(p) AS paths\r\n    CALL apoc.convert.toTree(paths) YIELD value\r\n    RETURN value\r\n\r\nRead [the docs](https://neo4j.com/docs/apoc/current/overview/apoc.convert/apoc.convert.toTree/) to see how to configure the properties that are included or excluded from the generated tree.",
                    "title": "Cypher Query to get a nested array of nodes at each level of a tree of nodes"
                }
            ],
            "owner": {
                "account_id": 18767496,
                "reputation": 53,
                "user_id": 13685040,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/50d1ff235a58e2d5c5ac7b2c2db90eab?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "snakebite-382",
                "link": "https://stackoverflow.com/users/13685040/snakebite-382"
            },
            "is_answered": true,
            "view_count": 20,
            "favorite_count": 0,
            "accepted_answer_id": 77261015,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696822048,
            "question_id": 77256130,
            "body_markdown": "I have a series of comments and replies, each comment can have multiple replies and each reply can in turn have any number of nested or immediate replies.\r\n\r\nHere is some sample data graphed:\r\n[![][1]][1]\r\n\r\nHere I have one post with 4 comments, each replied to the previous comment\r\nI would like to write a query so I can get them returned as nested lists like so\r\n```JSON\r\nPost = {\r\n   ...\r\n   comments: [\r\n      comment: {\r\n          ...\r\n          replies: [\r\n              comment: {\r\n                  ...\r\n                  replies: [\r\n                      comment : {\r\n                         etc\r\n                  ]\r\n              }\r\n          ]\r\n      }\r\n   ]\r\n}\r\n```\r\nWhere each comment has a list of replies and each of those replies has replies you get the point\r\n\r\nI&#39;m very new to using cypher I&#39;m more familiar with mongoDB so this is the query I have so far\r\n```\r\nMATCH tree1 = (post:POST)&lt;-[:COMMENTED_ON]-(comment:COMMENT)\r\nOPTIONAL MATCH tree2 = (comment)&lt;-[replied_to:REPLIED_TO *]-(reply:COMMENT)\r\nWHERE ID(post) = 5\r\nRETURN nodes(tree1), nodes(tree2)\r\n```\r\nWhich gets all the nodes, but it&#39;s just the list of nodes, with a lot of repeats\r\nI&#39;ve done a lot of googling, and I looked at the FOREACH functionality but I&#39;m not sure how I would properly apply it here. I can almost definitely write a query that I can then use code to turn into the structure I need it to be in but it would be nice if I could write a query to do that for me or at least one that returns the nodes in a format where it&#39;s easier to do that \r\n\r\n  [1]: https://i.stack.imgur.com/1yWhz.png",
            "link": "https://stackoverflow.com/questions/77256130/cypher-query-to-get-a-nested-array-of-nodes-at-each-level-of-a-tree-of-nodes",
            "title": "Cypher Query to get a nested array of nodes at each level of a tree of nodes"
        },
        {
            "tags": [
                "express",
                "neo4j",
                "neo4j-ogm",
                "ecmascript-next",
                "ecmascript-2021"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 2888263,
                        "reputation": 453,
                        "user_id": 2477612,
                        "user_type": "registered",
                        "accept_rate": 50,
                        "profile_image": "https://www.gravatar.com/avatar/16825c06a5ff913465d214b92a8ed22a?s=256&d=identicon&r=PG",
                        "display_name": "Naveen Karnam",
                        "link": "https://stackoverflow.com/users/2477612/naveen-karnam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696913513,
                    "answer_id": 77263019,
                    "question_id": 77254191,
                    "body_markdown": "I figured out the issue after retracing all the steps I made. \r\nUnfortunately, it is not related to any of the details I had posted. Partly the reason it took me so long to debug. \r\n\r\nHowever, it is not really the solution for it. \r\nI had added a field on schema (which is used to instantiate the driver - variable ```typeDefs```). So, ```ObjectGraphMap.init()``` fails.\r\nAlas, Neo4j does not (yet) have the flexible schema integration with graphql. It may be not that bad as it can get pretty dynamic and error-prone without hard-fixing the schema. \r\n\r\n**PS:** Stacktrace needs to improve though. Not actually accepting this as an answer because there seems to be something to address on ES. Check this [out][1] and this [too][2]. \r\n\r\n\r\n  [1]: https://stackoverflow.com/questions/71500702/the-promise-rejected-with-the-reason-object-array-code-err-unhandled-r\r\n  [2]: https://github.com/nodejs/node/issues/43326",
                    "title": "UnhandledPromiseRejection while OGM initialize on Neo4j GraphQL Express Server"
                }
            ],
            "owner": {
                "account_id": 2888263,
                "reputation": 453,
                "user_id": 2477612,
                "user_type": "registered",
                "accept_rate": 50,
                "profile_image": "https://www.gravatar.com/avatar/16825c06a5ff913465d214b92a8ed22a?s=256&d=identicon&r=PG",
                "display_name": "Naveen Karnam",
                "link": "https://stackoverflow.com/users/2477612/naveen-karnam"
            },
            "is_answered": false,
            "view_count": 45,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696778777,
            "question_id": 77254191,
            "body_markdown": "I am using express with Neo4j graphql. \r\n\r\nSeeing this exception without specific line indications in my code. \r\n\r\n    node:internal/process/promises:289\r\n                triggerUncaughtException(err, true /* fromPromise */);\r\n                ^\r\n    \r\n    [UnhandledPromiseRejection: This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason &quot;[object Array]&quot;.] {   code: &#39;ERR_UNHANDLED_REJECTION&#39; }\r\n    \r\n    Node.js v20.3.0\r\n\r\n\r\n1. I have graph data models defined in **&quot;graph-data-models.js&quot;**\r\n\r\n        ...        \r\n        const driver = neo4j.driver(\r\n        ...\r\n        );\r\n    \r\n        const ObjectGraphMap = new OGM({ typeDefs, driver });\r\n        const Challenge = ObjectGraphMap.model(&quot;Challenge&quot;);\r\n        ...\r\n2. Express Server on **&quot;app.js&quot;**. Server should start from here. I run ```node app.js```.\r\n\r\n    ```\r\n    ...\r\n    try {\r\n        await ObjectGraphMap.init();\r\n        app.listen(port, () =&gt; {\r\n            logger.info(`Data API App listening at http://localhost:${port}`);\r\n        });\r\n    } catch(e) {\r\n        logger.error(&quot;OGM init failed&quot;,e);\r\n    }\r\n    ```\r\n 3. API Definitions in **&quot;api.js&quot;**\r\n```\r\n...\r\napp = express()\r\n...\r\napp.get(&quot;/challenges&quot;, getChallenges);\r\n...\r\n```\r\n4. Data Models used in **&quot;api-impl.js&quot;**\r\n```\r\n...\r\nconst getChallenges = async (req, res) =&gt; {\r\n    try {\r\n      ...  \r\n      Challenge.find({\r\n            ... }\r\n        })\r\n        .then((challenge) =&gt; {\r\n           ...\r\n        })\r\n        .catch((err) =&gt; {\r\n        ...\r\n        });\r\n    } catch (error) {\r\n        ...\r\n    } \r\n}\r\n...\r\n```\r\n\r\nIt looks to me like something more than just wrapping around a try-catch at all places. How can I debug and find out the issue? OGM init needs some change but then-catch model on **&quot;app.js&quot;** like.\r\n```\r\n...\r\nObjectGraphMap.init()\r\n    .then(() =&gt; {\r\n    ...\r\n    }) \r\n    .catch(() =&gt; {\r\n    ...\r\n    })\r\n...\r\n```\r\ndoes not cut it.  ",
            "link": "https://stackoverflow.com/questions/77254191/unhandledpromiserejection-while-ogm-initialize-on-neo4j-graphql-express-server",
            "title": "UnhandledPromiseRejection while OGM initialize on Neo4j GraphQL Express Server"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1696617728,
                    "answer_id": 77246728,
                    "question_id": 77246324,
                    "body_markdown": "This query will return a list of the highest level (&quot;visible&quot;) spaces of which a `User` is a member:\r\n\r\n    MATCH (user:User {auth_token: $auth_token})-[:MEMBER_OF]-&gt;(space)\r\n    WITH user, COLLECT(space) AS spaces\r\n    RETURN user, REDUCE(vs = [], s IN spaces |\r\n      CASE WHEN NONE(a IN [(s)&lt;-[:PARENT_OF*]-(ancestor)|ancestor] WHERE a IN spaces)\r\n      THEN vs + s\r\n      ELSE vs END\r\n    ) AS visibleSpaces\r\n\r\nIt ignores the `pod_state` property, as you did not specify how that should be used.",
                    "title": "NEO4J query clause in a tree like membership graph"
                },
                {
                    "owner": {
                        "account_id": 3908099,
                        "reputation": 187,
                        "user_id": 3234217,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/fdf0b82ca9731a859d7705aff9123621?s=256&d=identicon&r=PG",
                        "display_name": "Makarov",
                        "link": "https://stackoverflow.com/users/3234217/makarov"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696629493,
                    "answer_id": 77247558,
                    "question_id": 77246324,
                    "body_markdown": "This is the final query:\r\n\r\nI added some extra logic to fit my needs, but also `UNWIND` the original result to be able to `ORDER BY` and paginate with `SKIP` and `LIMIT`.\r\n\r\n        MATCH (user:User {auth_token: $auth_token})-[:MEMBER_OF]-&gt;(space)\r\n         WHERE space.pod_state IN [&#39;active&#39;, &#39;pending&#39;] AND space.pod_type IN [&#39;standard&#39;, &#39;readonly&#39;]\r\n         WITH user, COLLECT(space) AS spaces\r\n         WITH REDUCE(vs = [], s IN spaces |\r\n          CASE WHEN NONE(a IN [(s)&lt;-[:PARENT_OF*]-(ancestor)|ancestor] WHERE a IN spaces)\r\n          THEN vs + s\r\n          ELSE vs END\r\n        ) AS visibleSpaces\r\n        UNWIND visibleSpaces AS space\r\n        WITH space\r\n        RETURN space\r\n        ORDER BY datetime(space.last_active) DESC\r\n        SKIP toInteger($page) \r\n        LIMIT 50",
                    "title": "NEO4J query clause in a tree like membership graph"
                }
            ],
            "owner": {
                "account_id": 3908099,
                "reputation": 187,
                "user_id": 3234217,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/fdf0b82ca9731a859d7705aff9123621?s=256&d=identicon&r=PG",
                "display_name": "Makarov",
                "link": "https://stackoverflow.com/users/3234217/makarov"
            },
            "is_answered": true,
            "view_count": 31,
            "favorite_count": 0,
            "accepted_answer_id": 77246728,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1696612280,
            "question_id": 77246324,
            "body_markdown": "So I have this graph structure where many &quot;Top level&quot; and subspaces spaces can exist like this:\r\n[![enter image description here][1]][1]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/kOPCH.png\r\n\r\nI have the next cypher query:\r\n\r\n    MATCH (user:User {auth_token: $auth_token}) \r\n          MATCH (space:Space)\r\n          WHERE (\r\n            (NOT (space)&lt;-[:PARENT_OF]-(:Space) AND (user)-[:MEMBER_OF]-&gt;(space) AND space.pod_state IN [&#39;active&#39;, &#39;pending&#39;] AND space.pod_type IN [&#39;standard&#39;, &#39;readonly&#39;])\r\n            OR\r\n            (EXISTS {MATCH (parent:Space)-[:PARENT_OF*]-&gt;(space)&lt;-[:MEMBER_OF]-(user) WHERE NOT (user)-[:MEMBER_OF]-&gt;(parent) AND space.pod_state IN [&#39;active&#39;, &#39;pending&#39;] AND space.pod_type IN [&#39;standard&#39;, &#39;readonly&#39;]})\r\n          )\r\n          RETURN space\r\n    \r\nWhat I need in this case is the list of spaces (blue) that a user can see (yellow) \r\nSo:\r\n - Simon DDD should only see &quot;TOP LEVEL SPACE&quot; even when he is also a member of &quot;LEVEL 2 SPACE&quot; he should see the space with the highest level in every hierarchy.\r\n - Simon LALALA on the other hand should see &quot;LEVEL 2 SPACE&quot; since he is only a member of that space.\r\n\r\nIn the query provided SIMON DDD is getting both &quot;TOP LEVEL SPACE&quot; and &quot;LEVEL 2 SPACE&quot;\r\nSIMON LALALA is okay since he is only a member of one space in the path\r\n\r\nAlso, the query works fine if, for example, SIMON DDD is a member of the &quot;LEVEL 1 SPACE A&quot; because the &quot;NOT&quot; clause on the query will work, which means if the user is a MEMBER OF every space in the path only shows the top level space",
            "link": "https://stackoverflow.com/questions/77246324/neo4j-query-clause-in-a-tree-like-membership-graph",
            "title": "NEO4J query clause in a tree like membership graph"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696608768,
                    "answer_id": 77245988,
                    "question_id": 77245127,
                    "body_markdown": "`MERGE` is not suitable for your use case. Here is one way to ensure a `Position` node with the exact set of properties you want exists. The query assumes that the desired properties are passed to the query in a `props` [parameter](https://neo4j.com/docs/cypher-manual/current/syntax/parameters/) (e.g., `{symbol: &quot;xxx&quot;, name: &quot;yyy&quot;, location:&quot;zzz&quot;, effective: false}`)\r\n\r\n    OPTIONAL MATCH (p:Position)\r\n    WHERE PROPERTIES(p) = $props\r\n    CALL {\r\n      WITH p\r\n      WITH p WHERE p IS NULL\r\n      CREATE (q:Position)\r\n      SET q = $props\r\n      RETURN result\r\n      UNION\r\n      WITH p\r\n      WITH p WHERE p IS NOT NULL\r\n      RETURN p AS result\r\n    }\r\n    RETURN ID(result)",
                    "title": "Inserting General Entities in Neo4j Using MERGE: Matching Issue with Similar Nodes"
                }
            ],
            "owner": {
                "account_id": 29613014,
                "reputation": 1,
                "user_id": 22695803,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/d5361fa477fa6781e54d650af857f050?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Gabriel Nogueira",
                "link": "https://stackoverflow.com/users/22695803/gabriel-nogueira"
            },
            "is_answered": false,
            "view_count": 26,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696601281,
            "question_id": 77245127,
            "body_markdown": "I&#39;m using Neo4j to relate data extracted from official government documents, and I&#39;m developing a Python program to automate this process. However, there are cases where a more general entity is extracted, like `(:Position {symbol: &quot;xxx&quot;, name: &quot;yyy&quot;, effective: false})`. When I attempt to insert it into the database using a query like:\r\n\r\n```cypher\r\nMERGE (c:Position {symbol: &quot;xxx&quot;, name: &quot;yyy&quot;, effective: false})\r\nRETURN ID(c)\r\n```\r\n\r\nThe `MERGE` clause ends up matching a node of the type `(:Position {symbol: &quot;xxx&quot;, name: &quot;yyy&quot;, location:&quot;zzz&quot;, effective: false})`.\r\n\r\nHow can I modify my Cypher query to ensure that the node `(c:Position {symbol: &quot;xxx&quot;, name: &quot;yyy&quot;, effective: false})` is inserted into the database? In this case, using `CREATE` alone is not sufficient, as similar nodes might be extracted again.\r\n\r\nI encountered a similar issue in [this post](https://stackoverflow.com/questions/38190061/merge-node-with-null-property-neo4j). However, the provided solution doesn&#39;t work in my case because the `WHERE` clause returns nothing.",
            "link": "https://stackoverflow.com/questions/77245127/inserting-general-entities-in-neo4j-using-merge-matching-issue-with-similar-nod",
            "title": "Inserting General Entities in Neo4j Using MERGE: Matching Issue with Similar Nodes"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 4905960,
                        "reputation": 843,
                        "user_id": 3952697,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/6f711663b08cbcc7ea756a11d7857b16?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "Dave Fauth",
                        "link": "https://stackoverflow.com/users/3952697/dave-fauth"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1696594522,
                    "answer_id": 77244356,
                    "question_id": 77244145,
                    "body_markdown": "I think this will work for you:\r\n\r\n```\r\nMATCH (mt:MoneyTransfer)&lt;-[s:SEND]-(:BankAccount)&lt;-[hba:HAS_BANKACCOUNT]-(ah:AccountHolder) \r\nWHERE (mt.TransactionDate &lt;= date(&quot;2023-09-30&quot;) \r\nAND mt.TransactionDate &gt;= date(&quot;2023-09-01&quot;)) \r\nwith ah.Name as AccountHolder, AVG(mt.MoneyTransferAmount) as avgTransfer \r\nwhere avgTransfer &gt; 1000\r\nRETURN AccountHolder, avgTransfer;\r\n```\r\n",
                    "title": "How to apply conditions on return values in Neo4j cypher"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696619827,
                    "answer_id": 77246900,
                    "question_id": 77244145,
                    "body_markdown": "This query will return a list of the names of the account holders that met a threshold transfer amount, and another list of the ones who did not.\r\n\r\n    MATCH (mt:MoneyTransfer)&lt;-[:SEND]-(:BankAccount)&lt;-[:HAS_BANKACCOUNT]-(ah:AccountHolder)\r\n    WHERE date($start) &lt;= mt.TransactionDate &lt;= date($end)\r\n    WITH ah.Name as accountHolder, AVG(mt.MoneyTransferAmount) AS avgTransfer\r\n    RETURN avgTransfer &gt;= $amount AS metThresholdAmount, COLLECT(accountHolder) AS accountHolders\r\n\r\nThe query assumes that the string `start` and `end` dates, and the threshold `amount` are passed as [parameters](https://neo4j.com/docs/cypher-manual/current/syntax/parameters/).\r\n\r\nFor example, if there are 2 account holders, the result would look something like this:\r\n\r\n    ╒══════════════════╤══════════════╕\r\n    │metThresholdAmount│accountHolders│\r\n    ╞══════════════════╪══════════════╡\r\n    │true              │[&quot;Fred&quot;]      │\r\n    ├──────────────────┼──────────────┤\r\n    │false             │[&quot;Wilma&quot;]     │\r\n    └──────────────────┴──────────────┘",
                    "title": "How to apply conditions on return values in Neo4j cypher"
                }
            ],
            "owner": {
                "account_id": 29612089,
                "reputation": 3,
                "user_id": 22695083,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocIbz5v9WUcVtiZjc3jj_yGeXR4j-EYL2oP06CUAJCaq0a4=k-s256",
                "display_name": "Santosh Jamale",
                "link": "https://stackoverflow.com/users/22695083/santosh-jamale"
            },
            "is_answered": true,
            "view_count": 33,
            "favorite_count": 0,
            "accepted_answer_id": 77244356,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1696592412,
            "question_id": 77244145,
            "body_markdown": "I have a query as follows which returns account holder with their monthly average transaction amount.\r\n\r\n```\r\nMATCH (mt:MoneyTransfer)&lt;-[s:SEND]-(:BankAccount)&lt;-[hba:HAS_BANKACCOUNT]-(ah:AccountHolder)\r\nWHERE (mt.TransactionDate &lt;= date(&quot;2023-09-30&quot;) AND mt.TransactionDate &gt;= date(&quot;2023-09-01&quot;))\r\nRETURN ah.Name as AccountHolder, AVG(mt.MoneyTransferAmount);\r\n```\r\n\r\nHow to apply condition on above output so that I will get account holders whose average monthly money transfer amount (`AVG(mt.MoneyTransferAmount)`) is greater or less than any certain amount?\r\n\r\nI tried multiple things but nothing worked for me.",
            "link": "https://stackoverflow.com/questions/77244145/how-to-apply-conditions-on-return-values-in-neo4j-cypher",
            "title": "How to apply conditions on return values in Neo4j cypher"
        },
        {
            "tags": [
                "java",
                "testing",
                "neo4j",
                "neo4j-apoc",
                "apoc"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1696625424,
                    "answer_id": 77247307,
                    "question_id": 77242976,
                    "body_markdown": "First of all, you should ensure that your neo4j dependencies have compatible versions. You are currently using wildly different versions:\r\n  - Version 5.12.0 of `neo4j`\r\n  - Version 5.3.0 of `neo4j-java-driver`\r\n  - Version 4.4.0.1 of `apoc`.\r\n\r\nTo keep all 3 dependencies consistent, the correct dependencies for the latter 2 artifacts are as follows (notice that the `artifactId` for core apoc is `apoc-core` in 5.x):\r\n\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.neo4j.driver&lt;/groupId&gt;\r\n        &lt;artifactId&gt;neo4j-java-driver&lt;/artifactId&gt;\r\n        &lt;version&gt;${neo4j.version}&lt;/version&gt;\r\n        &lt;scope&gt;test&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n        &lt;groupId&gt;org.neo4j.procedure&lt;/groupId&gt;\r\n        &lt;artifactId&gt;apoc-core&lt;/artifactId&gt;\r\n        &lt;version&gt;${neo4j.version}&lt;/version&gt;\r\n        &lt;scope&gt;test&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n\r\nIn general, to use an APOC core function (or procedure) in your embedded server, you need to find the APOC core class that implements the function (or procedure). To do that, you can:\r\n\r\n 1. Select the [Tag](https://github.com/neo4j/apoc/tags) of the version\r\n    you are using in the APOC core github repo.\r\n 2. Search for the name of the function (or procedure). For example, for `apoc.text.code`, look for a match that looks like\r\n    `@UserFunction(&quot;apoc.text.code&quot;)`.\r\n 3. Get the name of the APOC class (including the package) that implements what you are looking for. For example,\r\n    `apoc.text.Strings`.\r\n 4. In your class that calls `newInProcessBuilder`, add an `import` of that APOC class.\r\n 5. Call the builder&#39;s `withFunction` (or `withProcedure`) method and pass it the APOC class. For example, `withFunction(Strings.class)`.",
                    "title": "neo4j procedure testing with apoc does not compile"
                }
            ],
            "owner": {
                "account_id": 119005,
                "reputation": 497,
                "user_id": 310423,
                "user_type": "registered",
                "accept_rate": 82,
                "profile_image": "https://www.gravatar.com/avatar/c068c66820d62f5e3e2b23e4327c6ebb?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "pilsdumps",
                "link": "https://stackoverflow.com/users/310423/pilsdumps"
            },
            "is_answered": true,
            "view_count": 52,
            "favorite_count": 0,
            "accepted_answer_id": 77247307,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696581087,
            "question_id": 77242976,
            "body_markdown": "I&#39;ve a project where I can successfully test my user procedure written using the neo4j traversal framework based on example testing projects.\r\n\r\nThe relevant part of the pom file is\r\n\r\n\r\n```\r\n...\r\n  &lt;neo4j.version&gt;5.12.0&lt;/neo4j.version&gt;\r\n  &lt;neo4j-java-driver.version&gt;5.3.0&lt;/neo4j-java-driver.version&gt;\r\n&lt;/properties&gt;\r\n  &lt;dependencies&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.neo4j&lt;/groupId&gt;\r\n      &lt;artifactId&gt;neo4j&lt;/artifactId&gt;\r\n      &lt;version&gt;${neo4j.version}&lt;/version&gt;\r\n      &lt;scope&gt;provided&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.neo4j.test&lt;/groupId&gt;\r\n      &lt;artifactId&gt;neo4j-harness&lt;/artifactId&gt;\r\n      &lt;version&gt;${neo4j.version}&lt;/version&gt;\r\n      &lt;scope&gt;test&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.neo4j.driver&lt;/groupId&gt;\r\n      &lt;artifactId&gt;neo4j-java-driver&lt;/artifactId&gt;\r\n      &lt;version&gt;${neo4j-java-driver.version}&lt;/version&gt;\r\n      &lt;scope&gt;test&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n    &lt;!-- https://mvnrepository.com/artifact/org.neo4j.procedure/apoc --&gt;\r\n    &lt;dependency&gt;\r\n      &lt;groupId&gt;org.neo4j.procedure&lt;/groupId&gt;\r\n      &lt;artifactId&gt;apoc&lt;/artifactId&gt;\r\n      &lt;version&gt;4.4.0.1&lt;/version&gt;\r\n      &lt;scope&gt;test&lt;/scope&gt;\r\n    &lt;/dependency&gt;\r\n...\r\n```\r\n\r\nI&#39;ve set up the embeddedDatabaseServer like this\r\n\r\n```\r\n@BeforeEach\r\nvoid initializeNeo4j() throws IOException {\r\n    \r\n    var sw = new StringWriter();\r\n    try (var in = new BufferedReader(new InputStreamReader(getClass().getResourceAsStream(&quot;/getNode/tvlike_test_data.cypher&quot;)))) {\r\n        in.transferTo(sw);\r\n        sw.close();\r\n    }\r\n    //split into each statement so can be run one by one\r\n    List&lt;String&gt; statements = Arrays.asList(sw.toString().split(&quot;;\\r\\n&quot;));\r\n\r\n    var builder = Neo4jBuilders.newInProcessBuilder()\r\n            .withDisabledServer()\r\n            .withProcedure(GetNode.class);\r\n\r\n    for (String statement : statements) {\r\n        builder.withFixture(statement);\r\n    }\r\n    \r\n    this.embeddedDatabaseServer = builder.build();\r\n}\r\n```\r\nand the tests run successfully e.g.\r\n\r\n```\r\n@Test\r\nvoid TryIt() {\r\n            try (\r\n                    var driver = GraphDatabase.driver(embeddedDatabaseServer.boltURI());\r\n                    var session = driver.session()\r\n    \r\n            ) {\r\n    \r\n                var results = session.run(&quot;&quot;&quot;\r\n                                match(u:User{userId:&#39;u1&#39;})\r\n                                where u.isEnabled = true\r\n                                match(n:Trial{id: &#39;tr1&#39;})\r\n                                call cctc.getNode(n, u, { includeFoundPermissions : true }) \r\n                                    yield allNodePerms, allPropPerms\r\n                                return allNodePerms, allPropPerms&quot;&quot;&quot;)\r\n                        .single();\r\n                var resMap = results.asMap();\r\n    \r\n                //\r\n                var allNodePerms = (List&lt;Map&lt;String, Object&gt;&gt;) resMap.get(&quot;allNodePerms&quot;);\r\n                assertThat(allNodePerms.size()).isEqualTo(1);\r\n            }\r\n        }\r\n```\r\n\r\nI&#39;d like to include apoc procs and functions in my testing, but I can&#39;t add the necessary infrastructure successfully. For example, running this\r\n\r\n```\r\n@Test\r\nvoid TryIt2() {\r\n    try (\r\n            var driver = GraphDatabase.driver(embeddedDatabaseServer.boltURI());\r\n            var session = driver.session()\r\n\r\n    ) {\r\n\r\n        var results = session.run(&quot;&quot;&quot;\r\n                        return apoc.text.code(103) AS output&quot;&quot;&quot;)\r\n                .single();\r\n\r\n        assertThat(results.get(&quot;output&quot;)).isEqualTo(&quot;g&quot;);\r\n    }}\r\n```\r\n\r\ngives the error \r\n\r\n&gt; org.neo4j.driver.exceptions.ClientException: Unknown function\r\n&gt; &#39;apoc.text.code&#39; (line 1, column 8 (offset: 7)) &quot;return\r\n&gt; apoc.text.code(102) AS output&quot;\r\n\r\nas you&#39;d expect.\r\n\r\nThe question is how do I add the apoc library into the embedded server in the set up step? I&#39;ve tried many examples found in various samples but without success.\r\n\r\nThe pom file already includes the dependency for the apoc procedures. I&#39;ve tried amending the @BeforeEach method in various ways, \r\ne.g.\r\n\r\n - https://github.com/Lukasmp3/neo4j-apoc-testing/commit/6ff0b3e92c4ca1b04f190638a6dcf280270a5f50\r\n - https://github.com/michael-simons/neo4j-examples-and-tips/blob/master/examples/testing-ogm-against-embedded-with-apoc/src/test/java/org/neo4j/tips/testing/testing_ogm_against_embedded_with_apoc/ApplicationTests.java\r\n - https://github.com/neo4j-contrib/rabbithole/blob/3.0/src/main/java/org/neo4j/community/console/Neo4jService.java#L55\r\n\r\nbut without success.\r\n\r\nHow can I amend this\r\n```\r\n        var builder = Neo4jBuilders.newInProcessBuilder()\r\n                .withDisabledServer()\r\n                .withProcedure(GetNode.class);\r\n``` \r\nin my initializeNeo4j method to include apoc?\r\n",
            "link": "https://stackoverflow.com/questions/77242976/neo4j-procedure-testing-with-apoc-does-not-compile",
            "title": "neo4j procedure testing with apoc does not compile"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696640908,
                    "answer_id": 77247988,
                    "question_id": 77242556,
                    "body_markdown": "If you [install](https://neo4j.com/docs/graph-data-science/current/installation/) the Neo4j Graph Data Science (GDS) plugin, you can use community detection algorithms. In particular, the [Weakly Connected Components](https://neo4j.com/docs/graph-data-science/current/algorithms/wcc/) (WCC) algorithm will be useful for you use case. Here is a snippet from its documentation:\r\n\r\n&gt; The Weakly Connected Components (WCC) algorithm finds sets of\r\n&gt; connected nodes in directed and undirected graphs. Two nodes are\r\n&gt; connected, if there exists a path between them. The set of all nodes\r\n&gt; that are connected with each other form a component. In contrast to\r\n&gt; Strongly Connected Components (SCC), the direction of relationships on\r\n&gt; the path between two nodes is not considered.\r\n\r\nFor example, if you only care about `Img` nodes (with `name` properties) and `DISTANCE` relationships, you can do something like this:\r\n\r\n    // Create an in-memory GDS projection for the Img nodes and DISTANCE relationships\r\n    CALL gds.graph.project(&#39;imgs&#39;, &#39;Img&#39;, &#39;DISTANCE&#39;) YIELD graphName\r\n    // Run WCC algorithm to find each &quot;component&quot;, in which every pair of nodes is connected by some path (ignoring directionality)\r\n    CALL gds.wcc.stream(&#39;imgs&#39;, {}) YIELD nodeId, componentId\r\n    // For each component, collect a list of the names of all nodes in that component\r\n    WITH componentId, COLLECT(gds.util.asNode(nodeId).name) AS names\r\n    // Collect all those lists into an outer list (this is the result you asked for)\r\n    RETURN COLLECT(names) AS result\r\n\r\nThe GDS projection will keep taking up memory on the server until your drop the projection or restart neo4j. To drop the projection named &quot;imgs&quot;, do this:\r\n\r\n    CALL gds.graph.drop(&#39;imgs&#39;)\r\n\r\nThe above is barely scratching the surface of GDS, but should give you a leg up on implementing your use case.",
                    "title": "How do you return clusters in Neo4j?"
                }
            ],
            "owner": {
                "account_id": 15660867,
                "reputation": 23,
                "user_id": 11299860,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/cf548f99e2b8bb58af4786719c14a69f?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "svk003",
                "link": "https://stackoverflow.com/users/11299860/svk003"
            },
            "is_answered": false,
            "view_count": 73,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1696577166,
            "question_id": 77242556,
            "body_markdown": "I&#39;m very new for neo4j.\r\n\r\nNeed to get output as array for already grouped nodes.[![enter image description here](https://i.stack.imgur.com/O8Y1j.png)](https://i.stack.imgur.com/O8Y1j.png)\r\n\r\nIn attached image having 13 node groups.\r\n\r\nFor example,\r\n\r\n\\[&#39;img8&#39;,&#39;img9&#39;,&#39;img47&#39;,&#39;img50&#39;,&#39;img51&#39;\\] is one set\r\n\r\n\\[&#39;img20&#39;, &#39;img21&#39;\\] is another set.\r\n\r\nLike this we are having 13 node sets in attached image.\r\n\r\nI need output like.\r\n\r\n\\[\\[set1\\],\\[set2\\],.....,\\[set13\\]\\]",
            "link": "https://stackoverflow.com/questions/77242556/how-do-you-return-clusters-in-neo4j",
            "title": "How do you return clusters in Neo4j?"
        },
        {
            "tags": [
                "docker",
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 2,
                    "creation_date": 1696463867,
                    "answer_id": 77233591,
                    "question_id": 77233349,
                    "body_markdown": "In the container, your command line needs to use the absolute address for the `import` directory. In your case, just insert &#39;/&#39; before the 3 `import`s:\r\n\r\n    bin/neo4j-admin database import full --id-type=INTEGER --nodes=NodeA=/import/nodes.csv --nodes=NodeB=/import/nodesB.csv --relationships=RELA=/import/rels.csv --multiline-fields=true",
                    "title": "neo4j-admin import command not working in docker (java.lang.IllegalArgumentException: File &#39;import/nodes.csv&#39; doesn&#39;t exist)"
                }
            ],
            "owner": {
                "account_id": 29565636,
                "reputation": 57,
                "user_id": 22659125,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocKGtvM572iuBUgp9O5TqFRwleGI6NZhLxXDQrLIVI9f=k-s256",
                "display_name": "iuhztr tzhjzuk",
                "link": "https://stackoverflow.com/users/22659125/iuhztr-tzhjzuk"
            },
            "is_answered": true,
            "view_count": 65,
            "favorite_count": 0,
            "accepted_answer_id": 77233591,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696458810,
            "question_id": 77233349,
            "body_markdown": "I am trying to load some csv data with the help of the `neo4j-admin import` command into neo4j running in docker.\r\nFirst I ran the following docker run command:\r\n```\r\ndocker run \\\r\n    --publish=7474:7474 --publish=7687:7687 \\\r\n    --volume=C:/my_dir:/import \\\r\n    --env NEO4J_AUTH=neo4j/password \\\r\n    neo4j:5.11.0-community \\\r\n```\r\n\r\nAfter the container was created and started I executed the import command in the docker desktop&#39;s neo4j container terminal.\r\n```\r\nbin/neo4j-admin database import full --id-type=INTEGER --nodes=NodeA=import/nodes.csv --nodes=NodeB=import/nodesB.csv --relationships=RELA=import/rels.csv --multiline-fields=true\r\n```\r\nBut I get the following error:\r\n\r\n```\r\nInvalid value for option &#39;--nodes&#39; at index 0 ([&lt;label&gt;[:&lt;label&gt;]...=]&lt;files&gt;): Invalid nodes file: NodeA=import/nodes.csv (java.lang.IllegalArgumentException: File &#39;import/nodes.csv&#39; doesn&#39;t exist)\r\n```\r\n\r\n\r\n\r\nI checked the import folder of the docker container and the folder is mounted and all the csv files are in it. So I do not know why the import is not working.\r\n\r\nI have also installed the same neo4j version locally (windows), where I could successfully import the database with the same `neo4j-admin import` command mentioned above and the same csv files. But I could not make it work using docker.\r\n\r\n\r\n",
            "link": "https://stackoverflow.com/questions/77233349/neo4j-admin-import-command-not-working-in-docker-java-lang-illegalargumentexcep",
            "title": "neo4j-admin import command not working in docker (java.lang.IllegalArgumentException: File &#39;import/nodes.csv&#39; doesn&#39;t exist)"
        },
        {
            "tags": [
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 29599919,
                        "reputation": 1,
                        "user_id": 22685620,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/847a204b39682532474ae71f8a3916d2?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "Ajit Singh Yadav",
                        "link": "https://stackoverflow.com/users/22685620/ajit-singh-yadav"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696510657,
                    "answer_id": 77237327,
                    "question_id": 77233161,
                    "body_markdown": "problem resolved \r\nThanks \r\n\r\nProblem was PowerShell. It was not correctly installing \r\n",
                    "title": "installation issue with Neo4j Desktop Setup 1.5.9 in windows 11"
                }
            ],
            "owner": {
                "account_id": 29599919,
                "reputation": 1,
                "user_id": 22685620,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/847a204b39682532474ae71f8a3916d2?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Ajit Singh Yadav",
                "link": "https://stackoverflow.com/users/22685620/ajit-singh-yadav"
            },
            "is_answered": false,
            "view_count": 40,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696455946,
            "question_id": 77233161,
            "body_markdown": "![screen capture](https://i.stack.imgur.com/alI7e.png)\r\n\r\nWhile installing Neo4j Desktop Setup 1.5.9 in windows 11 i have facing this issue. Not able to go thru this step.\r\n\r\n\r\n![enter image description here](https://i.stack.imgur.com/fNV7P.png)\r\n![enter image description here](https://i.stack.imgur.com/QiBlm.png)\r\n\r\nI have added Path to environ variable. I have added PowerShell path. but still not able to resolve the issue. please guide me to resolve it .\r\nThank you \r\n\r\n[This is log.log file](https://drive.google.com/file/d/1hYT_Ar8xfAzPkTbY86s5TXm84QwbiklK/view?usp=drive_link) \r\n",
            "link": "https://stackoverflow.com/questions/77233161/installation-issue-with-neo4j-desktop-setup-1-5-9-in-windows-11",
            "title": "installation issue with Neo4j Desktop Setup 1.5.9 in windows 11"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1696358484,
                    "answer_id": 77224777,
                    "question_id": 77221688,
                    "body_markdown": "1. The first 3 `MATCH` clauses did not use a colon in front of the relationship type. For example, `[provid_by]` should be `[:provid_by]`. This may or may not have caused a difference in the results, but it would have slowed down the query.\r\n\r\n2. Another issue, and it is a big one, is that `UNION` can only add rows to the ultimate result. It cannot filter out any rows provided by other `UNION` terms.\r\n\r\n3. Also, it is not clear why you have the last 3 `UNION`s. They would only add a lot of nodes that do not pass your stated criteria.\r\n\r\nThis simpler query may be sufficient:\r\n\r\n    MATCH (node:service)\r\n    WHERE\r\n     (\r\n       NONE(n IN [(node)-[:provid_by]-&gt;(dst:provider)|dst.name] WHERE n =~ &quot;(?i)Adani Transmission Limited&quot;) OR\r\n       NONE(n IN [(node)-[:address_in]-&gt;(dst:Address)|dst.name] WHERE n =~ &quot;(?i)Formosa&quot;)\r\n     ) AND\r\n     NONE(n IN [(node)-[:depen_on]-&gt;(dst:res)|dst.name] WHERE n =~ &quot;(?i)Video interview data&quot;)\r\n    RETURN node\r\n    ORDER BY node.createdAt DESC",
                    "title": "How to write or with not query in neo4j"
                }
            ],
            "owner": {
                "account_id": 27081716,
                "reputation": 13,
                "user_id": 20630792,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ALm5wu2deeksK5xw2EENJ36MpdAEVct6_iZ2dudXnhFl=k-s256",
                "display_name": "Mittal Vaghela",
                "link": "https://stackoverflow.com/users/20630792/mittal-vaghela"
            },
            "is_answered": true,
            "view_count": 47,
            "favorite_count": 0,
            "accepted_answer_id": 77224777,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696330947,
            "question_id": 77221688,
            "body_markdown": "I want to perform this query in neo4j but i&#39;m not getting proper.\r\n\r\nNOT((service provid_by Adani Transmission Limited AND service address_in Formosa) OR service depen_on Video interview data)\r\n\r\n#### Cypher query  \r\n\r\n```\r\nMATCH (node:service )-[provid_by]-&gt;(dst:provider)\r\nWITH DISTINCT node, COLLECT(DISTINCT TOLOWER(dst.name)) AS names\r\nWHERE NONE(name IN names WHERE name IN [&quot;adani transmission limited&quot;]) OR size(names) = 0\r\nWITH DISTINCT node\r\nRETURN DISTINCT node\r\nUNION\r\nMATCH (node:service )-[address_in]-&gt;(dst:Address)\r\nWITH DISTINCT node, COLLECT(DISTINCT TOLOWER(dst.name)) AS names\r\nWHERE NONE(name IN names WHERE name IN [&quot;formosa&quot;]) OR size(names) = 0\r\nWITH DISTINCT node\r\nMATCH (node:service)-[depen_on]-&gt;(dst:res)\r\nWITH DISTINCT node, COLLECT(DISTINCT TOLOWER(dst.name)) AS names\r\nWHERE NONE(name IN names WHERE name IN [&quot;video interview data&quot;]) OR size(names) = 0\r\nWITH DISTINCT node\r\nWITH DISTINCT node\r\nORDER BY node.createdAt DESC\r\nRETURN DISTINCT node\r\nUNION\r\nMATCH (node:service) WHERE NOT (node)-[:provid_by]-&gt;(:Participant)\r\nWITH DISTINCT node\r\nRETURN DISTINCT node\r\nUNION\r\nMATCH (node:service)\r\nWHERE NOT (node)-[:address_in]-&gt;(:Address)\r\nWITH DISTINCT node\r\nRETURN DISTINCT node\r\nUNION\r\nMATCH (node:service)\r\nWHERE NOT (node)-[:depen_on]-&gt;(:res)\r\nWITH DISTINCT node\r\nRETURN DISTINCT node\r\n```",
            "link": "https://stackoverflow.com/questions/77221688/how-to-write-or-with-not-query-in-neo4j",
            "title": "How to write or with not query in neo4j"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "constraints"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696246303,
                    "answer_id": 77215248,
                    "question_id": 77215052,
                    "body_markdown": "You can&#39;t create a `CONSTRAINT` on node-relationship-node combinations. \r\n\r\nIt could be enforced in a DML statement for creating the relationship. For example:\r\n```\r\nMATCH (p:Person { name: &quot;Claudia&quot; })\r\nWHERE NOT EXISTS { (p)-[:LIKES]-&gt;(:Hobby {name: &quot;football&quot;}) }\r\nCREATE (p)-[:LIKES]-&gt;(:Hobby {name: &quot;football&quot;, experience: &quot;2 years&quot;})\r\n```\r\nThis assumes the hobby might not already exist. ",
                    "title": "How can I create a constraint on pairs of nodes based on their labels and attributes?"
                },
                {
                    "owner": {
                        "account_id": 28282947,
                        "reputation": 86,
                        "user_id": 21624328,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/a/AGNmyxZzl1uvGNT2Zj90oWIgnDozeOoiJzA7-rJgem4f=k-s256",
                        "display_name": "Christoffer Bergman",
                        "link": "https://stackoverflow.com/users/21624328/christoffer-bergman"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696247173,
                    "answer_id": 77215322,
                    "question_id": 77215052,
                    "body_markdown": "One option would be to change the data model slightly (don&#39;t know if that is a feasible option for you) so that you make Hobby unique by name for all. So there would only be one Hobby node with name &quot;football&quot; and all who likes football would point to the same node. That way you could have a uniqueness constraint on the name of Hobby.\r\n\r\nWith this model you would move the experience property to the relationship instead (so that the LIKES relationship would have the experience property).\r\n\r\nHowever, this would not prevent the same person node to have multiple LIKES relationships to the same Hobby, but at least the same Hobby would only exist once.",
                    "title": "How can I create a constraint on pairs of nodes based on their labels and attributes?"
                }
            ],
            "owner": {
                "account_id": 26494167,
                "reputation": 1,
                "user_id": 20132179,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/657b5652117a06fabae223f88d311408?s=256&d=identicon&r=PG",
                "display_name": "Boris Buklov",
                "link": "https://stackoverflow.com/users/20132179/boris-buklov"
            },
            "is_answered": false,
            "view_count": 52,
            "favorite_count": 0,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1696244277,
            "question_id": 77215052,
            "body_markdown": "Let&#39;s say i have two different nodes in my DB:\r\n\r\n```none\r\n(p:person {name: &quot;Claudia&quot;})-[:likes]-&gt;(h:hobby {name: &quot;football&quot;, experience: &quot;2 years&quot;})\r\n```\r\n\r\nMy goal is to make each person&#39;s hobby unique by its `name` attribute, but at the same time I want to be able to create another `(h:hobby {name: &quot;football&quot;})` node, related to some other `person` and it would be 2 different nodes (it&#39;s important!).\r\n\r\nHow can I do that?\r\n\r\nI tried:\r\n```\r\nCREATE CONSTRAINT FOR (h:hobby),(p:person) REQUIRE (p:person)-[:likes]-&gt;(h.name) IS UNIQUE\r\n```\r\nbut it doesn&#39;t even work, giving me:\r\n\r\n```none\r\nInvalid input &#39;(&#39;: expected &quot;)&quot; or an identifier (line 2, column 6 (offset: 24))\r\n&quot;FOR ((h:hobby),(p:person))&quot;\r\n```\r\n\r\n**SOLUTION:**\r\n\r\nIn [Finbar&#39;s Good answer](https://stackoverflow.com/a/77215248/20132179) I found useful statement: `WHERE NOT EXISTS`.\r\n\r\nI can guarantee each `person` has only one related `(h:hobby {name: &quot;football&quot;})` node using this statement and I can add `uuid` property for each `hobby` node I create to make sure it&#39;s unique  within the database:\r\n```cypher\r\nMATCH (p:Person { name: &quot;Claudia&quot; })\r\nWHERE NOT EXISTS { (p)-[:LIKES]-&gt;(:Hobby {name: &quot;football&quot;}) }\r\nCREATE (p)-[:LIKES]-&gt;(:Hobby {name: &quot;football&quot;, experience: &quot;2 years&quot;, id: apoc.create.uuid()})\r\n```",
            "link": "https://stackoverflow.com/questions/77215052/how-can-i-create-a-constraint-on-pairs-of-nodes-based-on-their-labels-and-attrib",
            "title": "How can I create a constraint on pairs of nodes based on their labels and attributes?"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "query-optimization"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 33099,
                        "reputation": 29846,
                        "user_id": 92359,
                        "user_type": "registered",
                        "accept_rate": 94,
                        "profile_image": "https://www.gravatar.com/avatar/664d3d4c50c731d90a32db5f9e01b4b9?s=256&d=identicon&r=PG",
                        "display_name": "InverseFalcon",
                        "link": "https://stackoverflow.com/users/92359/inversefalcon"
                    },
                    "is_accepted": false,
                    "score": 2,
                    "creation_date": 1696198683,
                    "answer_id": 77212510,
                    "question_id": 77212102,
                    "body_markdown": "Your query creates a cartesian product between all :Profile nodes and the :Vacency:Decision node, then expands from each one of them checking that they&#39;re not connected.\r\n\r\nIt would likely be more efficient to match to the possible profiles from v, then match to all :Profile nodes that are NOT those. Something like this:\r\n\r\n    PROFILE\r\n    MATCH (v:Vacancy:Decision {id: 17210})&lt;-[:POSSIBLE_PROFILE]-(possible)\r\n    WITH v, collect(possible) as toExclude\r\n    MATCH (p:Profile)\r\n    WHERE NOT p IN toExclude\r\n    RETURN p, v;",
                    "title": "Neo4j Cypher query DB hits optimization"
                }
            ],
            "owner": {
                "account_id": 1261634,
                "reputation": 24551,
                "user_id": 1219755,
                "user_type": "registered",
                "accept_rate": 84,
                "profile_image": "https://i.stack.imgur.com/UmjNt.jpg?s=256&g=1",
                "display_name": "alexanoid",
                "link": "https://stackoverflow.com/users/1219755/alexanoid"
            },
            "is_answered": true,
            "view_count": 33,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1696190251,
            "question_id": 77212102,
            "body_markdown": "I have the following Cypher query:\r\n\r\n    PROFILE MATCH (p:Profile)  MATCH (v:Vacancy:Decision {id: 17210})\r\n    WHERE NOT exists((v)&lt;-[:POSSIBLE_PROFILE]-(p))\r\n    RETURN p, v;\r\n\r\nand only 5000 Profiles in my test DB.\r\n\r\nThe plan:\r\n\r\n[![enter image description here][1]][1]\r\n\r\nI&#39;m concerned about the number of DB hits highlighted in the green rectangle. Could you please show me how to optimize this query?\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/dz2FS.png",
            "link": "https://stackoverflow.com/questions/77212102/neo4j-cypher-query-db-hits-optimization",
            "title": "Neo4j Cypher query DB hits optimization"
        },
        {
            "tags": [
                "python",
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 9963444,
                        "reputation": 12317,
                        "user_id": 7371893,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=256&g=1",
                        "display_name": "jose_bacoy",
                        "link": "https://stackoverflow.com/users/7371893/jose-bacoy"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696132685,
                    "answer_id": 77209175,
                    "question_id": 77206137,
                    "body_markdown": "The code return_name(n) should be n.return_name",
                    "title": "How to update the existing nodes in neo4j using python"
                },
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696185226,
                    "answer_id": 77211803,
                    "question_id": 77206137,
                    "body_markdown": "There are a few errors (and areas for improvement) in your `query`:\r\n\r\n    query = (\r\n        &quot;MATCH (n) WHERE return_name(n) = $return_name&quot;\r\n        &quot;SET n.profile_id = $new_profile_id, &quot;\r\n        &quot;    n.message = $new_message, &quot;\r\n        &quot;    n.processing_flag = $new_processing_flag &quot;\r\n    )\r\n\r\n1. As $jose_bacoy stated, `return_name(n)` should be `n.return_name`, since `return_name` is a property of `Message` nodes, and Cypher has no `return_name` function.\r\n\r\n2. `query` must have whitespace before the `SET` clause. Your query string contains the snippet `... $return_nameSET ...`, which has no whitespace before `SET`, so the query will fail to parse properly. You can actually see this issue in the query shown by the error message.\r\n\r\n3. For efficiency and to avoid unintentional matches, you should use the node label `Message` to qualify `n`. That is, `MATCH (n:Message)` instead of `MATCH (n)`.\r\n\r\nHere is a corrected version of your query:\r\n\r\n    query = (\r\n        &quot;MATCH (n:Message) WHERE n.return_name = $return_name &quot;\r\n        &quot;SET n.profile_id = $new_profile_id, &quot;\r\n        &quot;    n.message = $new_message, &quot;\r\n        &quot;    n.processing_flag = $new_processing_flag &quot;\r\n    )",
                    "title": "How to update the existing nodes in neo4j using python"
                },
                {
                    "owner": {
                        "account_id": 29000777,
                        "reputation": 1,
                        "user_id": 22214354,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/96faa0d16e180bc41836018844e66c62?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "Jonathan Giffard",
                        "link": "https://stackoverflow.com/users/22214354/jonathan-giffard"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1696192079,
                    "answer_id": 77212219,
                    "question_id": 77206137,
                    "body_markdown": "As well as the other guidance already given, you might want to try using .execute_query with the Python driver. See https://neo4j.com/docs/python-manual/current/query-simple/ for more details",
                    "title": "How to update the existing nodes in neo4j using python"
                }
            ],
            "owner": {
                "account_id": 25680619,
                "reputation": 13,
                "user_id": 19443460,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AATXAJww51pxUl9Y4zOSRkBlvASDGz9bXc4RF8ZJ-5VnCA=k-s256",
                "display_name": "Kevin Paul Babu",
                "link": "https://stackoverflow.com/users/19443460/kevin-paul-babu"
            },
            "is_answered": false,
            "view_count": 59,
            "favorite_count": 0,
            "answer_count": 3,
            "score": 0,
            "creation_date": 1696060493,
            "question_id": 77206137,
            "body_markdown": "I&#39;ve successfully managed to display and create nodes in Neo4j using Python, but I&#39;m struggling to update nodes in Neo4j using Python. I&#39;ve attempted to seek assistance from ChatGPT, but I&#39;m still unable to figure out how to update nodes in Neo4j\r\nThis is the python code\r\n```\r\nfrom neo4j import GraphDatabase\r\n\r\n\r\nclass Neo4jConnector:\r\n    def __init__(self, uri, user, password):\r\n        self._driver = GraphDatabase.driver(uri, auth=(user, password))\r\n\r\n    def close(self):\r\n        self._driver.close()\r\n\r\n    @property\r\n    def driver(self):\r\n        return self._driver\r\n\r\n\r\ndef create_node(neo4j_conn, sender, receiver, message, profile_id, rule_type, processing_flag, return_name):\r\n    query = (\r\n        &quot;CREATE (n:Message {sender: $sender, receiver: $receiver, &quot;\r\n        &quot;message: $message, profile_id: $profile_id, rule_type: $rule_type, &quot;\r\n        &quot;processing_flag: $processing_flag,return_name:$return_name})&quot;\r\n    )\r\n\r\n    with neo4j_conn._driver.session() as session:\r\n        session.write_transaction(lambda tx: tx.run(query, sender=sender, receiver=receiver,\r\n                                                    message=message, profile_id=profile_id,\r\n                                                    rule_type=rule_type, processing_flag=processing_flag,\r\n                                                    return_name=return_name))\r\n\r\n\r\ndef display_nodes(neo4j_conn):\r\n    query = &quot;MATCH (n:Message) RETURN n&quot;\r\n\r\n    with neo4j_conn._driver.session() as session:\r\n        result = session.run(query)\r\n        for record in result:\r\n            node = record[&quot;n&quot;]\r\n            print(node)\r\n\r\n\r\ndef get_nodes_by_processing_flag(tx, processing_flag):\r\n    query = (\r\n        &quot;MATCH (node:Message) &quot;\r\n        &quot;WHERE node.processing_flag = $processing_flag &quot;\r\n        &quot;RETURN node&quot;\r\n    )\r\n    result = []\r\n    for record in tx.run(query, processing_flag=processing_flag):\r\n        result.append(record[&quot;node&quot;])\r\n    return result\r\n\r\n\r\ndef update_node(tx, new_profile_id, new_message, new_processing_flag, return_name):\r\n    query = (\r\n        &quot;MATCH (n) WHERE return_name(n) = $return_name&quot;\r\n        &quot;SET n.profile_id = $new_profile_id, &quot;\r\n        &quot;    n.message = $new_message, &quot;\r\n        &quot;    n.processing_flag = $new_processing_flag &quot;\r\n    )\r\n    tx.run(query,  new_profile_id=new_profile_id, new_message=new_message,\r\n           new_processing_flag=new_processing_flag, return_name=return_name)\r\n\r\n\r\ndef main():\r\n    uri = &quot;bolt://localhost:7687&quot;  # Update with your Neo4j server URI\r\n    user = &quot;admin&quot;  # Update with your Neo4j username\r\n    password = &quot;password&quot;  # Update with your Neo4j password\r\n\r\n    connector = Neo4jConnector(uri, user, password)\r\n\r\n    while True:\r\n        print(&quot;1. Create Node&quot;)\r\n        print(&quot;2. Display Nodes&quot;)\r\n        print(&quot;3. Get Nodes by Processing Flag&quot;)\r\n        print(&quot;4. Update Node&quot;)\r\n        print(&quot;5. Quit&quot;)\r\n\r\n        choice = input(&quot;Enter your choice: &quot;)\r\n\r\n        if choice == &quot;1&quot;:\r\n            sender = input(&quot;Enter sender: &quot;)\r\n            receiver = input(&quot;Enter receiver: &quot;)\r\n            message = input(&quot;Enter message: &quot;)\r\n            profile_id = input(&quot;Enter profile_id: &quot;)\r\n            rule_type = input(&quot;Enter rule_type: &quot;)\r\n            processing_flag = input(&quot;Enter processing_flag: &quot;)\r\n            return_name = sender + rule_type + receiver\r\n            create_node(connector, sender, receiver, message, profile_id, rule_type, processing_flag, return_name)\r\n\r\n        elif choice == &quot;2&quot;:\r\n            display_nodes(connector)\r\n\r\n        elif choice == &quot;3&quot;:\r\n            user_input = input(&quot;Enter the processing flag: &quot;)\r\n            with connector._driver.session() as session:\r\n                nodes = session.read_transaction(get_nodes_by_processing_flag, user_input)\r\n\r\n            if nodes:\r\n                print(f&quot;Nodes with processing flag &#39;{user_input}&#39;:&quot;)\r\n                for node in nodes:\r\n                    print(node)\r\n            else:\r\n                print(f&quot;No nodes found with processing flag &#39;{user_input}&#39;.&quot;)\r\n\r\n        elif choice == &quot;4&quot;:\r\n            return_name = input(&quot;Enter return name: &quot;)\r\n            new_profile_id = input(&quot;Enter new profile_id: &quot;)\r\n            new_message = input(&quot;Enter new message: &quot;)\r\n            new_processing_flag = input(&quot;Enter new processing_flag: &quot;)\r\n            with connector.driver.session() as session:\r\n                session.write_transaction(update_node,  new_profile_id, new_message,\r\n                                          new_processing_flag, return_name)\r\n            print(&quot;Node updated successfully.&quot;)\r\n\r\n        elif choice == &quot;5&quot;:\r\n            connector.close()\r\n            break\r\n\r\n\r\nif __name__ == &quot;__main__&quot;:\r\n    main()\r\n\r\n```\r\n\r\n\r\nThis was the error from the code\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\main.py&quot;, line 120, in &lt;module&gt;\r\n    main()\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\main.py&quot;, line 110, in main\r\n    session.write_transaction(update_node,  new_profile_id, new_message,\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_meta.py&quot;, line 209, in inner\r\n    return f(*args, **kwargs)\r\n           ^^^^^^^^^^^^^^^^^^\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\work\\session.py&quot;, line 791, in write_transaction\r\n    return self._run_transaction(\r\n           ^^^^^^^^^^^^^^^^^^^^^^\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\work\\session.py&quot;, line 550, in _run_transaction\r\n    result = transaction_function(tx, *args, **kwargs)\r\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\main.py&quot;, line 59, in update_node\r\n    tx.run(query,  new_profile_id=new_profile_id, new_message=new_message,\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\work\\transaction.py&quot;, line 164, in run\r\n    result._tx_ready_run(query, parameters)\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\work\\result.py&quot;, line 116, in _tx_ready_run\r\n    self._run(query, parameters, None, None, None, None, None, None)\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\work\\result.py&quot;, line 166, in _run\r\n    self._attach()\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\work\\result.py&quot;, line 274, in _attach\r\n    self._connection.fetch_message()\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\io\\_common.py&quot;, line 180, in inner\r\n    func(*args, **kwargs)\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\io\\_bolt.py&quot;, line 851, in fetch_message\r\n    res = self._process_message(tag, fields)\r\n          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\io\\_bolt5.py&quot;, line 376, in _process_message\r\n    response.on_failure(summary_metadata or {})\r\n  File &quot;C:\\Users\\kevin\\PycharmProjects\\pyneo4j\\venv\\Lib\\site-packages\\neo4j\\_sync\\io\\_common.py&quot;, line 247, in on_failure\r\n    raise Neo4jError.hydrate(**metadata)\r\nneo4j.exceptions.CypherSyntaxError: {code: Neo.ClientError.Statement.SyntaxError} {message: Invalid input &#39;n&#39;: expected\r\n  &quot;!=&quot;\r\n  &quot;%&quot;\r\n  &quot;*&quot;\r\n  &quot;+&quot;\r\n  &quot;-&quot;\r\n  &quot;.&quot;\r\n  &quot;/&quot;\r\n  &quot;:&quot;\r\n  &quot;&lt;&quot;\r\n  &quot;&lt;=&quot;\r\n  &quot;&lt;&gt;&quot;\r\n  &quot;=&quot;\r\n  &quot;=~&quot;\r\n  &quot;&gt;&quot;\r\n  &quot;&gt;=&quot;\r\n  &quot;AND&quot;\r\n  &quot;CALL&quot;\r\n  &quot;CONTAINS&quot;\r\n  &quot;CREATE&quot;\r\n  &quot;DELETE&quot;\r\n  &quot;DETACH&quot;\r\n  &quot;ENDS&quot;\r\n  &quot;FOREACH&quot;\r\n  &quot;IN&quot;\r\n  &quot;IS&quot;\r\n  &quot;LOAD&quot;\r\n  &quot;MATCH&quot;\r\n  &quot;MERGE&quot;\r\n  &quot;OPTIONAL&quot;\r\n  &quot;OR&quot;\r\n  &quot;REMOVE&quot;\r\n  &quot;RETURN&quot;\r\n  &quot;SET&quot;\r\n  &quot;STARTS&quot;\r\n  &quot;UNION&quot;\r\n  &quot;UNWIND&quot;\r\n  &quot;USE&quot;\r\n  &quot;WITH&quot;\r\n  &quot;XOR&quot;\r\n  &quot;[&quot;\r\n  &quot;^&quot;\r\n  &lt;EOF&gt; (line 1, column 50 (offset: 49))\r\n&quot;MATCH (n) WHERE return_name(n) = $return_nameSET n.profile_id = $new_profile_id,     n.message = $new_message,     n.processing_flag = $new_processing_flag&quot;\r\n                                                  ^}\r\n```\r\n ",
            "link": "https://stackoverflow.com/questions/77206137/how-to-update-the-existing-nodes-in-neo4j-using-python",
            "title": "How to update the existing nodes in neo4j using python"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "neo4j-apoc",
                "apoc"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 11620311,
                        "reputation": 214,
                        "user_id": 8511812,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/66ycQ.jpg?s=256&g=1",
                        "display_name": "v2belleville",
                        "link": "https://stackoverflow.com/users/8511812/v2belleville"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1695926475,
                    "answer_id": 77197477,
                    "question_id": 77196825,
                    "body_markdown": "in the split, the single quotes around the coma are messing up with opening and closing the 3 strings for periodic iterate\r\n\r\nuse double quotes and you should be good...",
                    "title": "Splitting string with apoc.periodic.iterate"
                },
                {
                    "owner": {
                        "account_id": 2490083,
                        "reputation": 299,
                        "user_id": 2167741,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/edb162a96cd10ea3e2185fa6976a322c?s=256&d=identicon&r=PG",
                        "display_name": "user2167741",
                        "link": "https://stackoverflow.com/users/2167741/user2167741"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695926482,
                    "answer_id": 77197478,
                    "question_id": 77196825,
                    "body_markdown": "This needs a double quote for the split function. Namely,\r\nsplit(csv.patients,&quot;,&quot;) as pts\r\n\r\n",
                    "title": "Splitting string with apoc.periodic.iterate"
                }
            ],
            "owner": {
                "account_id": 2490083,
                "reputation": 299,
                "user_id": 2167741,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/edb162a96cd10ea3e2185fa6976a322c?s=256&d=identicon&r=PG",
                "display_name": "user2167741",
                "link": "https://stackoverflow.com/users/2167741/user2167741"
            },
            "is_answered": true,
            "view_count": 38,
            "favorite_count": 0,
            "accepted_answer_id": 77197477,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1695919180,
            "question_id": 77196825,
            "body_markdown": "I am encountering errors when including a function to split a string inside apoc.periodic.iterate in Neo4j. Namely, here is my query which runs fine:\r\n\r\n```\r\nWITH collect(file.URL) AS fileURLs\r\nUNWIND fileURLs AS fileURL\r\nCALL apoc.periodic.iterate(\r\n&#39;\r\nCALL apoc.load.csv($url) YIELD map AS csv\r\nRETURN csv\r\n&#39;,\r\n&#39;\r\nWITH round(toFloat(csv.dendrogram_height),3,&quot;HALF_UP&quot;) as height, csv.gene_name as gene, csv.event_no as event, csv.samples as sp, round(toFloat(csv.median_ge),3,&quot;HALF_UP&quot;) as me, csv.no_of_samples as no_s, csv.leaf_status as leaf, csv.patients as pts, csv.no_of_uniq_patients as no_pt, round((toFloat(csv.log2fc)),3,&quot;HALF_UP&quot;) as log2, round(toFloat(csv.padj_deseq2),3,&quot;HALF_UP&quot;) as padj, csv.up_or_down as up\r\nCREATE (:Expression:Primary {name: gene, event_no: event, dendrogram_height: height, samples: sp, median_exp: me, no_of_samples: no_s, leaf_status: leaf, patients: pts, no_of_unique_patients: no_pt, log2fc: log2, padj_deseq2: padj, up_or_down: up});\r\n&#39;,\r\n{batchSize:10000,parallel:true,params:{url:fileURL}}) YIELD batches, total\r\nRETURN batches, total;\r\n```\r\n\r\nBut when I include the function ```split``` (or ```apoc.text.split``` for that matter) in the ```WITH``` statement, namely,\r\n\r\n```\r\nMATCH (file:File) WITH file\r\nWITH collect(file.URL) AS fileURLs\r\nUNWIND fileURLs AS fileURL\r\nCALL apoc.periodic.iterate(\r\n&#39;\r\nCALL apoc.load.csv($url) YIELD map AS csv\r\nRETURN csv\r\n&#39;,\r\n&#39;\r\nWITH round(toFloat(csv.dendrogram_height),3,&quot;HALF_UP&quot;) as height, csv.gene_name as gene, csv.event_no as event, csv.samples as sp, round(toFloat(csv.median_ge),3,&quot;HALF_UP&quot;) as me, csv.no_of_samples as no_s, csv.leaf_status as leaf, split(csv.patients,&#39;,&#39;) as pts, csv.no_of_uniq_patients as no_pt, round((toFloat(csv.log2fc)),3,&quot;HALF_UP&quot;) as log2, round(toFloat(csv.padj_deseq2),3,&quot;HALF_UP&quot;) as padj, csv.up_or_down as up\r\nCREATE (:Expression:Primary {name: gene, event_no: event, dendrogram_height: height, samples: sp, median_exp: me, no_of_samples: no_s, leaf_status: leaf, patients: pts, no_of_unique_patients: no_pt, log2fc: log2, padj_deseq2: padj, up_or_down: up});\r\n&#39;,\r\n{batchSize:10000,parallel:true,params:{url:fileURL}}) YIELD batches, total\r\nRETURN batches, total;\r\n\r\n```\r\nI get an error saying:\r\n\r\n```\r\n\r\nProcedure call provides too many arguments: got 4 expected no more than 3.\r\n\r\nProcedure apoc.periodic.iterate has signature: apoc.periodic.iterate(cypherIterate :: STRING?, cypherAction :: STRING?, config :: MAP?) :: batches :: INTEGER?, total :: INTEGER?, timeTaken :: INTEGER?, committedOperations :: INTEGER?, failedOperations :: INTEGER?, failedBatches :: INTEGER?, retries :: INTEGER?, errorMessages :: MAP?, batch :: MAP?, operations :: MAP?, wasTerminated :: BOOLEAN?, failedParams :: MAP?, updateStatistics :: MAP?\r\nmeaning that it expects at least 3 arguments of types STRING?, STRING?, MAP?\r\nDescription: Runs the second statement for each item returned by the first statement.\r\nThis procedure returns the number of batches and the total number of processed rows. (line 4, column 1 (offset: 90))\r\n&quot;CALL apoc.periodic.iterate(&quot;\r\n ^\r\n```\r\n\r\nThe only difference is the ```split``` function in ```split(csv.patients,&#39;,&#39;)``` than ```csv.patients``` in the second query chunk.\r\n\r\nHow to resolve this? Thanks.",
            "link": "https://stackoverflow.com/questions/77196825/splitting-string-with-apoc-periodic-iterate",
            "title": "Splitting string with apoc.periodic.iterate"
        },
        {
            "tags": [
                "neo4j",
                "importerror"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695930451,
                    "answer_id": 77197860,
                    "question_id": 77192333,
                    "body_markdown": "If you are using the [neo4j-admin import](https://neo4j.com/docs/operations-manual/current/tutorial/neo4j-admin-import/) command, you are using it incorrectly.\r\n\r\nThe `:ID` field in a column header is supposed to indicate that the values in the column are unique, but your .csv file uses nonunique values.\r\n\r\nYou should be able to remove the `:ID` part of the header, and that may allow all the nodes to be created. *But* if you do that, you would not be able to import relationships, since that expects unique identifiers for the nodes that are to be linked (see [the docs](https://neo4j.com/docs/operations-manual/current/tools/neo4j-admin/neo4j-admin-import/#import-tool-header-format-nodes)).\r\n\r\nThe fix for this issue depends on your specific use case.",
                    "title": "While Importing UMLS data into Neo4J there is a error in uploading CODEs file"
                }
            ],
            "owner": {
                "account_id": 29552720,
                "reputation": 1,
                "user_id": 22648965,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocLUTMXJTn0YeJEg1OoQIeGYDi8Trh1nuGkFkvUiVtK8=k-s256",
                "display_name": "pavan Kumar",
                "link": "https://stackoverflow.com/users/22648965/pavan-kumar"
            },
            "is_answered": false,
            "view_count": 33,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1695878811,
            "question_id": 77192333,
            "body_markdown": "I tried to upload the data below (which is in .csv format) into Neo4J local and also into AuraDb:\r\n\r\n![Snippet of .csv file](https://i.stack.imgur.com/xEpmq.png)\r\n\r\nBut only the first 2 nodes with a given CodeID are imported:\r\n\r\n    0, COSTAR, NOCODE\r\n    1, NCBI, 137507\r\n\r\nI tried to add the index column, then all the nodes were uploading. But when linking relationships using other files there is mismatching.",
            "link": "https://stackoverflow.com/questions/77192333/while-importing-umls-data-into-neo4j-there-is-a-error-in-uploading-codes-file",
            "title": "While Importing UMLS data into Neo4J there is a error in uploading CODEs file"
        },
        {
            "tags": [
                "graph",
                "neo4j",
                "apoc",
                "gds"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1695870671,
                    "answer_id": 77191971,
                    "question_id": 77191497,
                    "body_markdown": "No, virtual nodes and relationships cannot be projected in GDS.\r\n\r\nFor example, if you try this query:\r\n\r\n    CALL apoc.create.vNode([&#39;Foo&#39;], {name: &#39;xyz&#39;}) YIELD node\r\n    RETURN gds.graph.project(&#39;t&#39;, node) AS g\r\n\r\nYou get an error like this (virtual entities have negative native IDs):\r\n\r\n&gt; Failed to invoke function `gds.graph.project`: Caused by: java.lang.IllegalArgumentException: GDS expects node ids to be positive. But got a negative id of `-2`.",
                    "title": "APOC Virtual Relationships and GDS"
                }
            ],
            "owner": {
                "account_id": 2490083,
                "reputation": 299,
                "user_id": 2167741,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/edb162a96cd10ea3e2185fa6976a322c?s=256&d=identicon&r=PG",
                "display_name": "user2167741",
                "link": "https://stackoverflow.com/users/2167741/user2167741"
            },
            "is_answered": true,
            "view_count": 24,
            "favorite_count": 0,
            "accepted_answer_id": 77191971,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1695859480,
            "question_id": 77191497,
            "body_markdown": "I want to create virtual relationships in Neo4j using APOC and run GDS algorithms like degree distributions. Is it even possible?",
            "link": "https://stackoverflow.com/questions/77191497/apoc-virtual-relationships-and-gds",
            "title": "APOC Virtual Relationships and GDS"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 11620311,
                        "reputation": 214,
                        "user_id": 8511812,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/66ycQ.jpg?s=256&g=1",
                        "display_name": "v2belleville",
                        "link": "https://stackoverflow.com/users/8511812/v2belleville"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695851923,
                    "answer_id": 77191126,
                    "question_id": 77190279,
                    "body_markdown": "your description and your example are not exactly the same : you say &quot;previous and next node(s) of a given node&quot; and your example has two sets : next and after next\r\n\r\ngiven the following nodes\r\n\r\n    create (:Person {name:&quot;H&quot;})-[:FOLLOWS]-&gt;(:Person {name:&quot;G&quot;})-[:FOLLOWS]-&gt;(:Person {name:&quot;E&quot;})-[:FOLLOWS]-&gt;(:Person {name:&quot;D&quot;});\r\n    match (g:Person {name:&quot;G&quot;}) merge (g)-[:FOLLOWS]-&gt;(:Person {name:&quot;F&quot;})\r\n\r\n[![screenprint of nodes created][1]][1]\r\n\r\nhere is a possible query\r\n\r\n    match (prev:Person)-[:FOLLOWS]-&gt;(p:Person {name:&quot;G&quot;})-[:FOLLOWS]-&gt;(next:Person)\r\n    optional match (next)-[:FOLLOWS]-&gt;(next2:Person)\r\n    return collect(distinct prev.name),p.name,collect(distinct next.name),collect(distinct next2.name)\r\n\r\n[![query result][2]][2]\r\n\r\nhere is the other query\r\n\r\n[![other query and result][3]][3]\r\n\r\n\r\n  [1]: https://i.stack.imgur.com/IDjCk.png\r\n  [2]: https://i.stack.imgur.com/4LmZT.png\r\n  [3]: https://i.stack.imgur.com/AltLe.png",
                    "title": "Grouping Cypher query results by direct relationships"
                },
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1695855543,
                    "answer_id": 77191320,
                    "question_id": 77190279,
                    "body_markdown": "From your question, there looks to be two types of solution. \r\n\r\nTo show what I mean I&#39;ll use this slightly more complicated graph that includes a merging of `FOLLOWS` downstream from `H`:\r\n```\r\n                                ┌───┐\r\n                          ┌────▶│ J │\r\n                          │     └───┘\r\n┌───┐   ┌───┐   ┌───┐   ┌───┐   ┌───┐\r\n│ H │──▶│ G │──▶│ E │──▶│ D │──▶│ I │\r\n└───┘   └───┘   └───┘   └───┘   └───┘\r\n          │               ▲\r\n          │               │\r\n          │     ┌───┐   ┌───┐   ┌───┐\r\n          └────▶│ F │──▶│ L │──▶│ K │\r\n                └───┘   └───┘   └───┘\r\n```\r\nTo group every path from `Person` with `name = &#39;H&#39;` by length, showing the same `Person` more than once (because there is more than one path from, for example, `H` to `D`), use this:\r\n```\r\nMATCH p = (:Person {name: &#39;H&#39;})-[:FOLLOWS*0..]-&gt;(e:Person)\r\nWITH length(p) AS l, collect(e.name) AS people\r\nRETURN collect(people) AS result\r\n```\r\nResult:\r\n```\r\n[[&quot;H&quot;], [&quot;G&quot;], [&quot;E&quot;, &quot;F&quot;], [&quot;D&quot;, &quot;L&quot;], [&quot;I&quot;, &quot;J&quot;, &quot;D&quot;, &quot;K&quot;], [&quot;I&quot;, &quot;J&quot;]]\r\n```\r\nIf instead you want each person to appear once, you can use the `shortestPath` function like so:\r\n```\r\nMATCH p = shortestPath((:Person {name: &#39;H&#39;})-[:FOLLOWS*0..]-&gt;(e:Person))\r\nWITH length(p) AS len, collect(e.name) AS people\r\nRETURN collect(people) AS result\r\n```\r\nResult:\r\n```\r\n[[&quot;H&quot;], [&quot;G&quot;], [&quot;E&quot;, &quot;F&quot;], [&quot;D&quot;, &quot;L&quot;], [&quot;K&quot;, &quot;I&quot;, &quot;J&quot;]]\r\n```",
                    "title": "Grouping Cypher query results by direct relationships"
                }
            ],
            "owner": {
                "account_id": 29549859,
                "reputation": 13,
                "user_id": 22646786,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/ef3d5eaec4d8deb1d085700c8b7e1407?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Lisvar27",
                "link": "https://stackoverflow.com/users/22646786/lisvar27"
            },
            "is_answered": true,
            "view_count": 54,
            "favorite_count": 0,
            "accepted_answer_id": 77191320,
            "answer_count": 2,
            "score": 1,
            "creation_date": 1695841952,
            "question_id": 77190279,
            "body_markdown": "Given the following graph (where all relationships have the `FOLLOWS` type), how can we get the results such that they are grouped according to previous and next node(s) of a given node?\r\n\r\n```\r\n H-&gt;G-&gt;E-&gt;D\r\n     -&gt;F\r\n```\r\n\r\n- Where H follows G \r\n- Where G follows both E &amp; F. \r\n- E follows D\r\n\r\nSo given some property of G, expecting results in the form:\r\n`[{H}, {G}, {E, F}, {D}]`\r\n\r\nTried:\r\n```\r\nMATCH (prev:Person)&lt;-[:FOLLOWS *0..]-(p:Person)&lt;-[:FOLLOWS *0..]-(next:Person) WHERE p.name =&#39;G&#39; RETURN collect(prev), p, collect(next) as result\r\n```\r\n\r\n",
            "link": "https://stackoverflow.com/questions/77190279/grouping-cypher-query-results-by-direct-relationships",
            "title": "Grouping Cypher query results by direct relationships"
        },
        {
            "tags": [
                "spring",
                "spring-boot",
                "neo4j",
                "pom.xml",
                "spring-data-neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 25176773,
                        "reputation": 1,
                        "user_id": 19018851,
                        "user_type": "registered",
                        "profile_image": "https://lh3.googleusercontent.com/a/AATXAJzwFMTXh5HDVxpKsBe2oZQnVmJ8_X16KcDaMed-=k-s256",
                        "display_name": "D G",
                        "link": "https://stackoverflow.com/users/19018851/d-g"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1695907073,
                    "answer_id": 77195318,
                    "question_id": 77187099,
                    "body_markdown": "I changed Neo4j version to 3.4.5, and then start working.\r\nBecause java 1.8 compatible only Neo4j 3x versions.\r\n\r\nhttps://neo4j.com/download/neo4j-desktop/?edition=desktop&amp;flavour=winstall64&amp;release=1.3.7&amp;offline=true  - Neo4j old version with 3x support",
                    "title": "Spring Boot Neo4j Could not open Neo4j Session for transaction"
                }
            ],
            "owner": {
                "account_id": 25176773,
                "reputation": 1,
                "user_id": 19018851,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/AATXAJzwFMTXh5HDVxpKsBe2oZQnVmJ8_X16KcDaMed-=k-s256",
                "display_name": "D G",
                "link": "https://stackoverflow.com/users/19018851/d-g"
            },
            "is_answered": true,
            "view_count": 41,
            "favorite_count": 0,
            "accepted_answer_id": 77195318,
            "answer_count": 1,
            "score": -1,
            "creation_date": 1695814193,
            "question_id": 77187099,
            "body_markdown": "I have an application that communicates with neo4j\r\nThis my pom.xml\r\n\r\n`&lt;dependencies&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-neo4j&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-data-rest&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\r\n\t\t\t&lt;scope&gt;test&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t\t&lt;dependency&gt;\r\n\t\t\t&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\r\n\t\t\t&lt;artifactId&gt;lombok&lt;/artifactId&gt;\r\n\t\t\t&lt;version&gt;1.18.6&lt;/version&gt;\r\n\t\t\t&lt;scope&gt;provided&lt;/scope&gt;\r\n\t\t&lt;/dependency&gt;\r\n\r\n\t&lt;/dependencies&gt;`\r\n\r\nWhen I start my app, I get this error: \r\n\r\n\r\n`Error creating bean with name &#39;botMessageController&#39; defined in file [C:\\Users\\Davit.gevorgyan\\IdeaProjects\\cc-root\\cc-admin-backend\\target\\classes\\vga\\j\\cc\\admin\\backend\\rest\\BotMessageController.class]: Unsatisfied dependency expressed through constructor parameter 0; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name &#39;botMessageService&#39;: Invocation of init method failed; nested exception is org.springframework.transaction.CannotCreateTransactionException: Could not open Neo4j Session for transaction; nested exception is org.neo4j.ogm.exception.ConnectionException: Could not create driver instance\r\n`\r\n\r\n\r\n\r\nPlease help solve this problem.\r\n\r\n\r\n\r\nI try add dependecies like this, but problem is already exist\r\n\r\nDirect driver instance 70543368 created for server address localhost:7687\r\nClosing connection pool towards localhost:7687 - \r\n\r\n\r\n        `&lt;dependency&gt;\r\n            &lt;groupId&gt;org.neo4j&lt;/groupId&gt;\r\n            &lt;artifactId&gt;neo4j&lt;/artifactId&gt;\r\n            &lt;version&gt;3.4.9&lt;/version&gt;\r\n            &lt;scope&gt;runtime&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.neo4j&lt;/groupId&gt;\r\n            &lt;artifactId&gt;neo4j-ogm-embedded-driver&lt;/artifactId&gt;\r\n            &lt;version&gt;3.1.8&lt;/version&gt;\r\n            &lt;scope&gt;test&lt;/scope&gt;\r\n        &lt;/dependency&gt;\r\n        &lt;dependency&gt;\r\n            &lt;groupId&gt;org.neo4j&lt;/groupId&gt;\r\n            &lt;artifactId&gt;neo4j-ogm-bolt-driver&lt;/artifactId&gt;\r\n            &lt;version&gt;3.1.8&lt;/version&gt;\r\n        &lt;/dependency&gt;`\r\n\r\n\r\nHow can I solve this problem...?",
            "link": "https://stackoverflow.com/questions/77187099/spring-boot-neo4j-could-not-open-neo4j-session-for-transaction",
            "title": "Spring Boot Neo4j Could not open Neo4j Session for transaction"
        },
        {
            "tags": [
                "neo4j",
                "nlp",
                "spacy",
                "graph-databases"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 11620311,
                        "reputation": 214,
                        "user_id": 8511812,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/66ycQ.jpg?s=256&g=1",
                        "display_name": "v2belleville",
                        "link": "https://stackoverflow.com/users/8511812/v2belleville"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695929018,
                    "answer_id": 77197730,
                    "question_id": 77179801,
                    "body_markdown": "this is the kind of thing Tomaz Bratanic does\r\n\r\nyou can check this out, for example: https://towardsdatascience.com/extract-knowledge-from-text-end-to-end-information-extraction-pipeline-with-spacy-and-neo4j-502b2b1e0754\r\n\r\n",
                    "title": "Dependency parsing as graph"
                }
            ],
            "owner": {
                "account_id": 10253118,
                "reputation": 1131,
                "user_id": 7566673,
                "user_type": "registered",
                "accept_rate": 88,
                "profile_image": "https://www.gravatar.com/avatar/9b958cd886a48c92ae90b8c460f10ab7?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Bharat Sharma",
                "link": "https://stackoverflow.com/users/7566673/bharat-sharma"
            },
            "is_answered": false,
            "view_count": 43,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1695729492,
            "question_id": 77179801,
            "body_markdown": "I am using `spacy` for dependency parsing which I can visualize also .\r\nCode snippet \r\n\r\n    import spacy\r\n    from spacy import displacy\r\n    \r\n    nlp = spacy.load(&quot;en_core_web_sm&quot;)\r\n    doc = nlp(&quot;This is a sentence.&quot;)\r\n    displacy.serve(doc, style=&quot;dep&quot;) \r\n\r\nIs it possible somehow I store this in any graph DB - say `neo4j`. If yes, then how? Also can this be done on paragraph level (multiple sentences). \r\n\r\nMy idea is to store multiple texts/paragraph into graph DB and apply graph algorithm for example `graph similarity`.\r\n\r\nDoes it make also sense to apply standard graph algorithm on dependency parsing ?\r\n\r\nThanks in advance \r\n",
            "link": "https://stackoverflow.com/questions/77179801/dependency-parsing-as-graph",
            "title": "Dependency parsing as graph"
        },
        {
            "tags": [
                "php",
                "neo4j",
                "cypher",
                "neo4jphp"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 10173720,
                        "reputation": 194,
                        "user_id": 7513161,
                        "user_type": "registered",
                        "profile_image": "https://lh5.googleusercontent.com/-dDYMwbT4jFQ/AAAAAAAAAAI/AAAAAAAAAB8/IeytunG-HWY/photo.jpg?sz=256",
                        "display_name": "Xxmarijnw",
                        "link": "https://stackoverflow.com/users/7513161/xxmarijnw"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1696109794,
                    "answer_id": 77208534,
                    "question_id": 77166834,
                    "body_markdown": "The first thing you need to do is create all the nodes that you want to match on, as well as the parameters you want to use, like so:\r\n\r\n```php\r\n$a = node(&quot;Resource&quot;); // (a:Resource)\r\n$b = node(&quot;Resource&quot;); // (b:Resource)\r\n\r\n$uri = parameter(&quot;uri&quot;); // $uri\r\n$object = parameter(&quot;object&quot;); // $object\r\n```\r\n\r\nThe `node` function takes as its only argument the label of the node and the `parameter` function the name of the parameter. Next, you can start to compose your query. You can start a new query using the `query` function, like so:\r\n\r\n```php\r\n$query = query();\r\n```\r\n\r\nThis returns a `Query` object, which has a number of methods to add new clauses to your query, such as `match`, `set`, `where` and `create`. These correspond to the clauses that Cypher offers.\r\n\r\nWe start by matching on the nodes `$a` and `$b`:\r\n\r\n```php\r\n$query = query() // Start a new query\r\n    -&gt;match([$a, $b]) // Match on both &quot;a&quot; and &quot;b&quot;\r\n    ...\r\n```\r\n\r\nNext, we want to create the condition to match on. php-cypher-dsl comes with a builder pattern for creating such expressions:\r\n\r\n```php\r\n    ...\r\n    -&gt;where($a-&gt;property(&quot;uri&quot;)-&gt;equals($uri)-&gt;and($b-&gt;property(&quot;uri&quot;)-&gt;equals($object))\r\n    ...\r\n```\r\n\r\nNext, before we create our `CREATE` clause, we need to create a new variable `$r` that gets shared between our `CREATE` and `RETURN` clause:\r\n\r\n```php\r\n$r = variable(); // Create a new variable\r\n```\r\n\r\nTo create the `CREATE` clause, we need to perform some trickery to remove the `:Resource` label from our nodes again. This part of the API still needs some improvement. We can get a new node with the same variable by using `node()-&gt;withVariable($a-&gt;getVariable())`. All together, that looks like:\r\n\r\n```php\r\n    ...\r\n    -&gt;create(node()-&gt;withVariable($a-&gt;getVariable())-&gt;relationshipTo(node()-&gt;withVariable($b-&gt;getVariable()), type: $propertyUri, name: $r))\r\n    ...\r\n```\r\n\r\nFinally, we can return the value we want:\r\n\r\n```php\r\n    ...\r\n    -&gt;returning(Procedure::raw(&#39;type&#39;, $r)) // The &quot;type&quot; function is not implemented natively, so we use raw\r\n    -&gt;toQuery(); // Convert the query to a string\r\n```\r\n\r\nAll put together, the code looks like this:\r\n\r\n```php\r\nuse WikibaseSolutions\\CypherDSL\\Expressions\\Procedures\\Procedure;\r\nuse function WikibaseSolutions\\CypherDSL\\node;\r\nuse function WikibaseSolutions\\CypherDSL\\parameter;\r\nuse function WikibaseSolutions\\CypherDSL\\query;\r\nuse function WikibaseSolutions\\CypherDSL\\variable;\r\n\r\n$propertyUri = &quot;http://example.com&quot;;\r\n\r\n$a = node(&quot;Resource&quot;);\r\n$b = node(&quot;Resource&quot;);\r\n$uri = parameter(&quot;uri&quot;);\r\n$object = parameter(&quot;object&quot;);\r\n$r = variable();\r\n\r\n$query = query()\r\n    -&gt;match([$a, $b])\r\n    -&gt;where($a-&gt;property(&quot;uri&quot;)-&gt;equals($uri)-&gt;and($b-&gt;property(&quot;uri&quot;)-&gt;equals($object)))\r\n    -&gt;create(node()-&gt;withVariable($a-&gt;getVariable())-&gt;relationshipTo(node()-&gt;withVariable($b-&gt;getVariable()), type: $propertyUri, name: $r))\r\n    -&gt;returning(Procedure::raw(&#39;type&#39;, $r))\r\n    -&gt;toQuery();\r\n```\r\n\r\nWhich I think is much *less* readable than using a normal query with variables. If you don&#39;t require complex logic to build queries (and only use pre-created queries, such as the one in your question), I&#39;d recommend you to not use this library.",
                    "title": "How can I translate this Neo4j cypher query to a PHP cypher DSL?"
                }
            ],
            "owner": {
                "account_id": 2355107,
                "reputation": 67,
                "user_id": 2063104,
                "user_type": "registered",
                "accept_rate": 80,
                "profile_image": "https://i.stack.imgur.com/VqwTT.jpg?s=256&g=1",
                "display_name": "Victor Donet",
                "link": "https://stackoverflow.com/users/2063104/victor-donet"
            },
            "is_answered": true,
            "view_count": 46,
            "favorite_count": 0,
            "accepted_answer_id": 77208534,
            "answer_count": 1,
            "score": 1,
            "creation_date": 1695553893,
            "question_id": 77166834,
            "body_markdown": "We are translating a Neo4j cypher query to PHP cypher DSL (Domain-Specific Language) using [the php-cypher-dsl library](https://github.com/neo4j-php/php-cypher-dsl/) to have more flexibility. \r\n\r\nWe struggle with this because the library&#39;s documentation is not really explaining how to use it in much detail. Given that we have a plain query in cypher Neo4j:\r\n\r\n    MATCH (a:Resource), (b:Resource) \r\n    WHERE a.uri = $uri AND b.uri = $object\r\n    CREATE (a)-[r:{$propertyUri}]-&gt;(b)\r\n    RETURN type(r)\r\n\r\n**How can we translate this Neo4j cypher query to PHP cypher DSL?**\r\n",
            "link": "https://stackoverflow.com/questions/77166834/how-can-i-translate-this-neo4j-cypher-query-to-a-php-cypher-dsl",
            "title": "How can I translate this Neo4j cypher query to a PHP cypher DSL?"
        },
        {
            "tags": [
                "neo4j"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 24576560,
                        "reputation": 14741,
                        "user_id": 18482310,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/df7394b688d32bf80c57541db64ab530?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "nimrod serok",
                        "link": "https://stackoverflow.com/users/18482310/nimrod-serok"
                    },
                    "is_accepted": true,
                    "score": 0,
                    "creation_date": 1695551428,
                    "answer_id": 77166676,
                    "question_id": 77166528,
                    "body_markdown": "One option is to use apoc.coll.sort:\r\n```\r\nMATCH (n:Node)\r\nWITH n\r\nOPTIONAL MATCH (n)--(m:Node)\r\nWITH COLLECT(m.key) as arr, n.key AS key\r\nWITH arr + key AS arr\r\nWITH apoc.coll.sort(arr) AS arr\r\nRETURN DISTINCT arr\r\n```\r\nWhich for:\r\n```\r\nMERGE (a1:Node {key:&#39;A&#39;}) \r\nMERGE (a2:Node {key:&#39;B&#39;}) \r\nMERGE (a3:Node {key:&#39;C&#39;}) \r\nMERGE (b1:Node {key:&#39;D&#39;}) \r\nMERGE (b2:Node {key:&#39;E&#39;}) \r\nMERGE (b3:Node {key:&#39;F&#39;}) \r\nMERGE (c1:Node {key:&#39;G&#39;})\r\n\r\nMERGE (a1)-[:DISTANCE]-&gt;(a2)\r\nMERGE (a2)-[:DISTANCE]-&gt;(a3)\r\nMERGE (a3)-[:DISTANCE]-&gt;(a1)\r\nMERGE (b1)-[:DISTANCE]-&gt;(b2)\r\nMERGE (b2)-[:DISTANCE]-&gt;(b3)\r\nMERGE (b3)-[:DISTANCE]-&gt;(b1)\r\n```\r\nreturns:\r\n```\r\n╒═══════════════╕\r\n│arr            │\r\n╞═══════════════╡\r\n│[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;]│\r\n├───────────────┤\r\n│[&quot;D&quot;, &quot;E&quot;, &quot;F&quot;]│\r\n├───────────────┤\r\n│[&quot;G&quot;]          │\r\n└───────────────┘\r\n```\r\nYou can also add one more `COLLECT` if needed:\r\n```\r\nMATCH (n:Node)\r\nWITH n\r\nOPTIONAL MATCH (n)--(m:Node)\r\nWITH COLLECT(m.key) as arr, n.key AS key\r\nWITH arr + key as arr\r\nWITH apoc.coll.sort(arr) AS arr\r\nWITH DISTINCT arr AS arr\r\nRETURN COLLECT(arr) AS arr\r\n```\r\nto get: \r\n```\r\n╒═════════════════════════════════════════╕\r\n│arr                                      │\r\n╞═════════════════════════════════════════╡\r\n│[[&quot;A&quot;, &quot;B&quot;, &quot;C&quot;], [&quot;D&quot;, &quot;E&quot;, &quot;F&quot;], [&quot;G&quot;]]│\r\n└─────────────────────────────────────────┘\r\n```",
                    "title": "How to get output in list in neo4j based on subgroup?"
                }
            ],
            "owner": {
                "account_id": 15660867,
                "reputation": 23,
                "user_id": 11299860,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/cf548f99e2b8bb58af4786719c14a69f?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "svk003",
                "link": "https://stackoverflow.com/users/11299860/svk003"
            },
            "is_answered": true,
            "view_count": 25,
            "favorite_count": 0,
            "accepted_answer_id": 77166676,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1695549094,
            "question_id": 77166528,
            "body_markdown": "I&#39;m very new for neo4j. how we can group and get output in array of array.\r\n\r\n![enter image description here](https://i.stack.imgur.com/8tbAL.png)\r\nI need output like \r\n[[ST001,ST0011,ST00111],[ST002,ST0022,ST00222],.....,[ST006,ST0066,ST00666]]\r\n\r\nAdvance thanks for help.\r\n\r\n",
            "link": "https://stackoverflow.com/questions/77166528/how-to-get-output-in-list-in-neo4j-based-on-subgroup",
            "title": "How to get output in list in neo4j based on subgroup?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 1,
                    "creation_date": 1695429903,
                    "answer_id": 77161264,
                    "question_id": 77161091,
                    "body_markdown": "I see that the [commit](https://github.com/neo4j/neo4j/commit/6ffe6e48e7f3bc49ace6c1855a05ccc8a9123600) that added support for normalizing types has this comment:\r\n\r\n&gt; **Importer normalizes property types to match Cypher**\r\n&gt;\r\n&gt; Effectively meaning that a type, specified in some .csv header that says that a\r\n&gt; certain property should be of type e.g. &quot;short&quot; will be imported as\r\n&gt; type &quot;long&quot;. Basically all integer types will be imported and stored\r\n&gt; as long and floating point types will be imported and stored as\r\n&gt; double.\r\n&gt; \r\n&gt; This will be the default behaviour, but can be overridden for specific\r\n&gt; scenarios by providing &quot;--normalize-types=false&quot;\r\n\r\nI presume this means that if you do not normalize types, then any un-normalized data types will have to be converted to/from normalized types whenever you use Cypher. So, even though you may save on storage space, your Cypher queries will be slowed down.\r\n\r\nYou may want to test it both ways to see if this is true (and let us know).",
                    "title": "neo4j: What are the tradeoffs of --normalize-types=false?"
                }
            ],
            "owner": {
                "account_id": 54182,
                "reputation": 17296,
                "user_id": 162094,
                "user_type": "registered",
                "accept_rate": 42,
                "profile_image": "https://www.gravatar.com/avatar/f9d63598e5173aef56d778b6208e45fb?s=256&d=identicon&r=PG",
                "display_name": "Stuart Berg",
                "link": "https://stackoverflow.com/users/162094/stuart-berg"
            },
            "is_answered": true,
            "view_count": 26,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1695424907,
            "question_id": 77161091,
            "body_markdown": "The `neo4j-admin` tool can import data from CSV.  [One of the options][1] it takes is:\r\n\r\n[1]: https://neo4j.com/docs/operations-manual/4.4/tools/neo4j-admin/neo4j-admin-import/#import-tool-option-normalize-types\r\n\r\n&gt;\r\n&gt;\r\n&gt;`--normalize-types[=&lt;true/false&gt;]`\r\n&gt;\r\n&gt;    Determines whether or not to normalize property types to Cypher types, e.g. `int` becomes `long` and `float` becomes `double`.\r\n&gt;\r\n&gt;    Default: `true`\r\n\r\n\r\nIf I don&#39;t explicitly set `--normalize-types=false`, then the `neo4j-admin` tool produces messages like this:\r\n\r\n```\r\nProperty type of &#39;foo&#39; normalized from &#39;int&#39; --&gt; &#39;long&#39; in /path/to/my-nodes.csv\r\n```\r\n\r\n\r\nMy database has billions of properties, so I&#39;d like to save space (and RAM) if possible. I know that the integer properties fit within 32 bits, and I don&#39;t need 64-bit precision for floating-point properties.  (See [this reference][2] for the bit-width of each property type.)\r\n\r\n[2]: https://neo4j.com/docs/java-reference/4.4/java-embedded/property-values/\r\n\r\n### What are the tradeoffs of normalizing the types vs. not normalizing?\r\n\r\nFor example, do narrower types actually save space/RAM?  Are they somehow incompatible with Cypher queries?",
            "link": "https://stackoverflow.com/questions/77161091/neo4j-what-are-the-tradeoffs-of-normalize-types-false",
            "title": "neo4j: What are the tradeoffs of --normalize-types=false?"
        },
        {
            "tags": [
                "neo4j",
                "cypher"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695426466,
                    "answer_id": 77161144,
                    "question_id": 77160928,
                    "body_markdown": "You can create [APOC triggers](https://neo4j.com/docs/apoc/current/background-operations/triggers/) to perform additional processing whenever a node or relationship is created or updated.",
                    "title": "Modifying cypher query with additional properties and labels"
                },
                {
                    "owner": {
                        "account_id": 520031,
                        "reputation": 482,
                        "user_id": 2258090,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/g8J8h.jpg?s=256&g=1",
                        "display_name": "Finbar Good",
                        "link": "https://stackoverflow.com/users/2258090/finbar-good"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1696364103,
                    "answer_id": 77225280,
                    "question_id": 77160928,
                    "body_markdown": "If you are allowing a string to be appended to the original query string before submitting, and there is a variable declared in the node, you can use the `SET` clause:\r\n```\r\nCREATE (newnode:testnode {tag_str: \\&quot;mytag\\&quot;})\r\nSET newnode.property1 = value1,\r\n    newnode.property2 = value2 ...\r\n```",
                    "title": "Modifying cypher query with additional properties and labels"
                }
            ],
            "owner": {
                "account_id": 3400034,
                "reputation": 119,
                "user_id": 2852481,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/87f30bbc18cc76aa21517857467ce676?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "I.F. Adams",
                "link": "https://stackoverflow.com/users/2852481/i-f-adams"
            },
            "is_answered": true,
            "view_count": 42,
            "favorite_count": 0,
            "accepted_answer_id": 77225280,
            "answer_count": 2,
            "score": 0,
            "creation_date": 1695421153,
            "question_id": 77160928,
            "body_markdown": "So I have a system whereby I will be handed in cypher queries to do specific operations (e.g. create a new node) as part of a pipeline. \r\n\r\nThe question I have, is that I would like to add additional properties and labels to this query that has been handed in to a process before it sends it off to the database (Neo4j) , but I would like to avoid a complex string parsing/update exercise.\r\n\r\nFor example, I may be given something like this:\r\n\r\n```CREATE (:testnode {tag_str: \\&quot;CgESpOVg\\&quot;})```\r\n\r\nBut I want to add additional system (i.e. source process outside of the databse) provided properties and labels to this node creation _before_ we hand it off to Neo4J.\r\n\r\nIs there a way to do this without having to modify the original query, but instead just &quot;bolting&quot; on to it at the end?\r\n\r\nAs an obviously nonworking example, something like as follows?\r\n\r\n```CREATE (newnode:testnode {tag_str: \\&quot;mytag\\&quot;}) + &lt;additional property foobar: usefuldata on variable new node&gt;```\r\n\r\nThe WITH clause sounds promising, but thus far I have not been able to make it work.\r\n\r\n\r\n\r\n ",
            "link": "https://stackoverflow.com/questions/77160928/modifying-cypher-query-with-additional-properties-and-labels",
            "title": "Modifying cypher query with additional properties and labels"
        },
        {
            "tags": [
                "python",
                "neo4j",
                "neomodel"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 3796056,
                        "reputation": 282,
                        "user_id": 4429265,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/3118369a5cbbca7b04e73f0c3930c2d0?s=256&d=identicon&r=PG",
                        "display_name": "Vahid",
                        "link": "https://stackoverflow.com/users/4429265/vahid"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695109335,
                    "answer_id": 77132562,
                    "question_id": 77132307,
                    "body_markdown": "The error you&#39;re encountering is because create_or_update method in `Neomodel` expects dictionaries (e.g., keyword arguments) for creating or updating nodes, but you&#39;re passing a list of Person objects instead.\r\n\r\nTo batch create or update StructuredNode objects using `create_or_update`, you should pass dictionaries containing the property values for each node you want to create or update.\r\n\r\nHere&#39;s how you can modify your code to achieve this:\r\n\r\n\r\n```\r\npeople = [\r\n    {&#39;name&#39;: &#39;Tim&#39;, &#39;age&#39;: 83},\r\n    {&#39;name&#39;: &#39;Bob&#39;, &#39;age&#39;: 23},\r\n    {&#39;name&#39;: &#39;Jill&#39;, &#39;age&#39;: 34},\r\n]\r\n\r\nPerson.create_or_update(*people)\r\n```\r\nIn the code above, we create a list of dictionaries (one for each person) and then pass that list as arguments to `Person.create_or_update`. The `*people` syntax is used to unpack the list into separate arguments.\r\n\r\nAdditionally, if you want to create or update individual Person objects and not use batch processing, you can do it like this:\r\n\r\n```\r\n\r\nlistPersons = [\r\n    {&#39;name&#39;: &#39;Susan&#39;},\r\n    {&#39;name&#39;: &#39;Bob&#39;},\r\n]\r\n\r\nfor person_data in listPersons:\r\n    Person.create_or_update(**person_data)\r\n```\r\nIn this case, we iterate through the list of dictionaries and use `**person_data` to pass each dictionary as keyword arguments to `Person.create_or_update`.",
                    "title": "Use of batch create_or_update raises Exception"
                }
            ],
            "owner": {
                "account_id": 6451714,
                "reputation": 11,
                "user_id": 4998440,
                "user_type": "registered",
                "profile_image": "https://www.gravatar.com/avatar/c82bcc14c1f7dc3b1aadf06b7a2f0cdf?s=256&d=identicon&r=PG&f=y&so-version=2",
                "display_name": "Marc",
                "link": "https://stackoverflow.com/users/4998440/marc"
            },
            "is_answered": false,
            "view_count": 36,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1695106866,
            "question_id": 77132307,
            "body_markdown": "Use of batch create_or_update for a bunch of StructuredNode Objects, raises exception.\r\nI created a datamodel in a separate py file for this\r\n\r\n**Exception occurs:**\r\n\r\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\r\nFile &quot;/opt/homebrew/lib/python3.11/site-packages/neomodel/properties.py&quot;, line 92, in deflate\r\nif properties.get(name) is not None:\r\n^^^^^^^^^^^^^^\r\nAttributeError: &#39;list&#39; object has no attribute &#39;get&#39;\r\n\r\n**Datamodel :**    \r\n\r\n    \r\n```\r\n    from neomodel import StructuredNode, StringProperty, RelationshipTo, RelationshipFrom,               StructuredRel, DateProperty\r\n\r\n    class Dog(StructuredNode):\r\n    name = StringProperty(required=True)\r\n    owner = RelationshipTo(&#39;Person&#39;, &#39;owner&#39;)\r\n\r\n    class Person(StructuredNode):\r\n    name = StringProperty(unique_index=True)\r\n    pets = RelationshipFrom(&#39;Dog&#39;, &#39;owner&#39;)\r\n\r\n````\r\n\r\n**Code**\r\n   \r\n```\r\n    people = Person.create_or_update(\r\n        {&#39;name&#39;: &#39;Tim&#39;, &#39;age&#39;: 83},\r\n        {&#39;name&#39;: &#39;Bob&#39;, &#39;age&#39;: 23},\r\n        {&#39;name&#39;: &#39;Jill&#39;, &#39;age&#39;: 34},\r\n    )\r\n\r\n    listPersons = []\r\n    listPersons.append(Person(name= &#39;Susan&#39;))\r\n    listPersons.append(Person(name=&#39;Bob&#39;))\r\n    Person.create_or_update(listPersons)\r\n\r\n```\r\nDoes anyone knows what I&#39;m doing wrong?",
            "link": "https://stackoverflow.com/questions/77132307/use-of-batch-create-or-update-raises-exception",
            "title": "Use of batch create_or_update raises Exception"
        },
        {
            "tags": [
                "neo4j",
                "cypher",
                "neo4j-apoc",
                "apoc"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 24576560,
                        "reputation": 14741,
                        "user_id": 18482310,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/df7394b688d32bf80c57541db64ab530?s=256&d=identicon&r=PG&f=y&so-version=2",
                        "display_name": "nimrod serok",
                        "link": "https://stackoverflow.com/users/18482310/nimrod-serok"
                    },
                    "is_accepted": true,
                    "score": 1,
                    "creation_date": 1695108468,
                    "answer_id": 77132469,
                    "question_id": 77132269,
                    "body_markdown": "Try:\r\n```\r\nRETURN apoc.number.format(125.4, &#39;0000.000&#39;) as value;\r\n```\r\nIt returns: `&quot;0125.400&quot;`\r\n\r\nOr to match your example:\r\n```\r\nRETURN apoc.number.format(3, &#39;00&#39;) as value;\r\n```\r\nreturns `&quot;03&quot;`",
                    "title": "Converting an integer to a fixed-length string with leading zeros"
                },
                {
                    "owner": {
                        "account_id": 9963444,
                        "reputation": 12317,
                        "user_id": 7371893,
                        "user_type": "registered",
                        "profile_image": "https://i.stack.imgur.com/Ris3Z.png?s=256&g=1",
                        "display_name": "jose_bacoy",
                        "link": "https://stackoverflow.com/users/7371893/jose-bacoy"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695123110,
                    "answer_id": 77134173,
                    "question_id": 77132269,
                    "body_markdown": "The APOC function apoc.text.lpad will add &#39;0&#39; to the left of a string at a given width.\r\n\r\n    Ref:\r\n    https://neo4j.com/labs/apoc/4.3/overview/apoc.text/apoc.text.lpad/\r\n    \r\n    \r\n\r\n&gt; apoc.text.lpad(text,count,delim) YIELD value - left pad the string to\r\n&gt; the given width\r\n\r\n\r\nExample:\r\nRETURN apoc.text.lpad(&quot;3&quot;, 2, &quot;0&quot;) AS output;\r\n\r\n    ╒════════╕\r\n    │&quot;output&quot;│\r\n    ╞════════╡\r\n    │&quot;03&quot;    │\r\n    └────────┘",
                    "title": "Converting an integer to a fixed-length string with leading zeros"
                }
            ],
            "owner": {
                "account_id": 3875331,
                "reputation": 3564,
                "user_id": 3209523,
                "user_type": "registered",
                "profile_image": "https://i.stack.imgur.com/yeaZC.jpg?s=256&g=1",
                "display_name": "canbax",
                "link": "https://stackoverflow.com/users/3209523/canbax"
            },
            "is_answered": true,
            "view_count": 43,
            "favorite_count": 0,
            "accepted_answer_id": 77132469,
            "answer_count": 2,
            "score": 2,
            "creation_date": 1695106416,
            "question_id": 77132269,
            "body_markdown": "Ideally I want `toFixed` function in JavaScript https://www.w3schools.com/jsref/jsref_tofixed.asp I know I can do this with Cypher like below.\r\n\r\n    WITH 3 AS inputNumber\r\n    RETURN\r\n      CASE\r\n        WHEN inputNumber &lt; 10 THEN &#39;0&#39; + toString(inputNumber)\r\n        ELSE toString(inputNumber)\r\n      END AS formattedString;\r\n\r\nbut a simple APOC function would be better",
            "link": "https://stackoverflow.com/questions/77132269/converting-an-integer-to-a-fixed-length-string-with-leading-zeros",
            "title": "Converting an integer to a fixed-length string with leading zeros"
        },
        {
            "tags": [
                "java",
                "memory",
                "neo4j",
                "size"
            ],
            "answers": [
                {
                    "owner": {
                        "account_id": 947871,
                        "reputation": 64252,
                        "user_id": 974731,
                        "user_type": "registered",
                        "profile_image": "https://www.gravatar.com/avatar/8f54ba41697411b238379022f9a6df56?s=256&d=identicon&r=PG",
                        "display_name": "cybersam",
                        "link": "https://stackoverflow.com/users/974731/cybersam"
                    },
                    "is_accepted": false,
                    "score": 0,
                    "creation_date": 1695079707,
                    "answer_id": 77130892,
                    "question_id": 77130551,
                    "body_markdown": "You can use batching to reduce the memory requirements of individual transaction(s).\r\n\r\nYou can do batching with a [CALL subquery](https://neo4j.com/docs/cypher-manual/current/clauses/call-subquery/#_batching) or APOC [procedures for batch transactions](https://neo4j.com/docs/apoc/current/graph-updates/periodic-execution/#periodic-execution-proc-overview).",
                    "title": "How to fix org.neo4j.internal.unsafe.NativeMemoryAllocationRefusedError?"
                }
            ],
            "owner": {
                "account_id": 29477101,
                "reputation": 1,
                "user_id": 22588637,
                "user_type": "registered",
                "profile_image": "https://lh3.googleusercontent.com/a/ACg8ocK97UywS3xJ7Zf0LNs5kl_q0y196DgaXRBZbOuksGUR=k-s256",
                "display_name": "imtoodumbforthisworld",
                "link": "https://stackoverflow.com/users/22588637/imtoodumbforthisworld"
            },
            "is_answered": false,
            "view_count": 18,
            "favorite_count": 0,
            "answer_count": 1,
            "score": 0,
            "creation_date": 1695073372,
            "question_id": 77130551,
            "body_markdown": "would be happy for any help regarding the following Problem. \r\nI need to create a neo4j Graph out of words of documents. It always worked fine for 1000 Documents, but for 3000 Documents i get this memory error. I already uincreased the heap size with -Xmx4096m, but that didnt solve the problem. I would be thankfull for any answers to this problem.\r\n```\r\nException in thread &quot;main&quot; org.neo4j.internal.unsafe.NativeMemoryAllocationRefusedError: Failed to allocate 524288 bytes. So far 36235008 bytes have already been successfully allocated. The system currently has 16930299904 bytes total physical memory, 57805078528 bytes committed virtual memory, and 570298368 bytes free physical memory. Relevant system properties: &quot;java.vm.name&quot; = &quot;OpenJDK 64-Bit Server VM&quot;, &quot;java.vm.vendor&quot; = &quot;OpenLogic&quot;, &quot;os.arch&quot; = &quot;amd64&quot;.\r\n\tat org.neo4j.internal.unsafe.UnsafeUtil.allocateMemory(UnsafeUtil.java:444)\r\n\tat org.neo4j.io.mem.GrabAllocator$Grab.&lt;init&gt;(GrabAllocator.java:90)\r\n\tat org.neo4j.io.mem.GrabAllocator$Grabs.allocateAligned(GrabAllocator.java:244)\r\n\tat org.neo4j.io.mem.GrabAllocator.allocateAligned(GrabAllocator.java:70)\r\n\tat org.neo4j.io.pagecache.impl.muninn.PageList.initBuffer(PageList.java:299)\r\n\tat org.neo4j.io.pagecache.impl.muninn.MuninnPageCursor.pageFault(MuninnPageCursor.java:419)\r\n\tat org.neo4j.io.pagecache.impl.muninn.MuninnPageCursor.uncommonPin(MuninnPageCursor.java:369)\r\n\tat org.neo4j.io.pagecache.impl.muninn.MuninnPageCursor.pin(MuninnPageCursor.java:337)\r\n\tat org.neo4j.io.pagecache.impl.muninn.MuninnReadPageCursor.next(MuninnReadPageCursor.java:63)\r\n\tat org.neo4j.io.pagecache.impl.muninn.MuninnPageCursor.next(MuninnPageCursor.java:160)\r\n\tat org.neo4j.kernel.impl.store.CommonAbstractStore.readIntoRecord(CommonAbstractStore.java:885)\r\n\tat org.neo4j.kernel.impl.store.CommonAbstractStore.getRecordByCursor(CommonAbstractStore.java:869)\r\n\tat org.neo4j.internal.recordstorage.RecordPropertyCursor.property(RecordPropertyCursor.java:439)\r\n\tat org.neo4j.internal.recordstorage.RecordPropertyCursor.next(RecordPropertyCursor.java:160)\r\n\tat org.neo4j.kernel.impl.newapi.DefaultPropertyCursor.next(DefaultPropertyCursor.java:163)\r\n\tat org.neo4j.kernel.impl.newapi.DefaultPropertyCursor.seekProperty(DefaultPropertyCursor.java:235)\r\n\tat org.neo4j.kernel.impl.core.NodeEntity.getProperty(NodeEntity.java:439)\r\n\tat core.Cooccs.addSentenceToCooccsDB(Cooccs.java:661)\r\n\tat core.Cooccs.&lt;init&gt;(Cooccs.java:577)\r\n\tat core.TextProcessing.createDB(TextProcessing.java:386)\r\n\tat core.TextProcessing.main(TextProcessing.java:1085)\r\n\r\n```\r\n",
            "link": "https://stackoverflow.com/questions/77130551/how-to-fix-org-neo4j-internal-unsafe-nativememoryallocationrefusederror",
            "title": "How to fix org.neo4j.internal.unsafe.NativeMemoryAllocationRefusedError?"
        }
    ],
    "has_more": true,
    "quota_max": 300,
    "quota_remaining": 225
}